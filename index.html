<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üîê ANTSO Tracking Pro - 970+ Cellules Madagasikara</title>
    
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet.markercluster/1.5.3/MarkerCluster.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet.markercluster/1.5.3/MarkerCluster.Default.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    
    <!-- Leaflet Heatmap -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet.heat/0.2.0/leaflet-heat.js"></script>
    
    <!-- QR Code Generator -->
    <script src="https://cdn.jsdelivr.net/npm/qrcode-generator@1.4.4/qrcode.min.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #0a1929;
            color: #e6f1ff;
            overflow: hidden;
            height: 100vh;
        }
        
        /* MODAL AUTHENTIFICATION */
        .auth-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.98);
            z-index: 10000;
            display: flex;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(10px);
        }
        
        .auth-content {
            background: #0a1929;
            border-radius: 16px;
            padding: 40px;
            width: 400px;
            max-width: 90%;
            border: 2px solid #0066cc;
            box-shadow: 0 20px 60px rgba(0,102,204,0.3);
            animation: authPulse 2s infinite;
        }
        
        @keyframes authPulse {
            0% { box-shadow: 0 20px 60px rgba(0,102,204,0.3); }
            50% { box-shadow: 0 20px 80px rgba(0,102,204,0.5); }
            100% { box-shadow: 0 20px 60px rgba(0,102,204,0.3); }
        }
        
        .auth-header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .auth-header h2 {
            color: #0066cc;
            font-size: 28px;
            margin-bottom: 10px;
        }
        
        .auth-header p {
            color: #8bb4ff;
            font-size: 14px;
        }
        
        .auth-input {
            width: 100%;
            padding: 15px;
            margin-bottom: 20px;
            background: rgba(13,27,42,0.9);
            border: 2px solid #0066cc;
            border-radius: 8px;
            color: white;
            font-size: 16px;
        }
        
        .auth-input:focus {
            outline: none;
            border-color: #ff9800;
        }
        
        .auth-button {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #0066cc, #0099ff);
            border: none;
            border-radius: 8px;
            color: white;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .auth-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(0,102,204,0.4);
        }
        
        .auth-error {
            color: #ff5722;
            text-align: center;
            margin-top: 15px;
            font-size: 13px;
            display: none;
        }
        
        .header {
            background: linear-gradient(135deg, #0066cc, #0099ff);
            color: white;
            padding: 15px 20px;
            box-shadow: 0 2px 15px rgba(0,0,0,0.3);
            z-index: 1000;
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 100%;
            margin: 0 auto;
        }
        
        .header-left h1 {
            margin-bottom: 5px;
            font-size: 24px;
            display: flex;
            align-items: center;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .operator-badge {
            display: inline-block;
            background: rgba(255,255,255,0.2);
            padding: 4px 15px;
            border-radius: 20px;
            font-weight: bold;
            margin-left: 10px;
            font-size: 14px;
            backdrop-filter: blur(5px);
        }
        
        .security-badge {
            display: inline-block;
            background: linear-gradient(135deg, #00b09b, #96c93d);
            color: white;
            padding: 4px 15px;
            border-radius: 20px;
            font-weight: bold;
            margin-left: 10px;
            font-size: 12px;
            animation: securePulse 2s infinite;
        }
        
        .cell-count-badge {
            display: inline-block;
            background: linear-gradient(135deg, #ff9800, #ff5722);
            color: white;
            padding: 4px 15px;
            border-radius: 20px;
            font-weight: bold;
            margin-left: 10px;
            font-size: 14px;
        }
        
        .main-container {
            display: flex;
            height: calc(100vh - 80px);
            position: relative;
        }
        
        #map {
            flex: 1;
            height: 100%;
            z-index: 1;
            background: #1a2b3c;
        }
        
        .sidebar {
            width: 480px;
            background: rgba(13, 27, 42, 0.95);
            padding: 15px;
            overflow-y: auto;
            box-shadow: -2px 0 15px rgba(0,0,0,0.4);
            z-index: 1000;
            border-left: 1px solid rgba(0, 102, 204, 0.3);
            backdrop-filter: blur(10px);
            transition: transform 0.3s ease;
        }
        
        .sidebar.collapsed {
            transform: translateX(100%);
        }
        
        .toggle-sidebar {
            position: absolute;
            top: 50%;
            right: 100%;
            transform: translateY(-50%);
            background: rgba(13, 27, 42, 0.9);
            color: white;
            border: none;
            border-radius: 5px 0 0 5px;
            padding: 10px 5px;
            cursor: pointer;
            z-index: 1001;
            box-shadow: -2px 0 5px rgba(0,0,0,0.3);
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .stat-card {
            background: rgba(0, 102, 204, 0.15);
            padding: 12px;
            border-radius: 8px;
            border: 1px solid rgba(0, 102, 204, 0.3);
            text-align: center;
            transition: transform 0.3s;
        }
        
        .stat-card:hover {
            transform: translateY(-2px);
        }
        
        .stat-value {
            font-size: 18px;
            font-weight: bold;
            color: #66b3ff;
            margin: 5px 0;
        }
        
        .stat-label {
            font-size: 11px;
            color: #8bb4ff;
            text-transform: uppercase;
        }
        
        .feature-list {
            margin-bottom: 15px;
            background: rgba(13, 27, 42, 0.7);
            padding: 15px;
            border-radius: 8px;
            border: 1px solid rgba(0, 102, 204, 0.2);
        }
        
        .feature-list h3 {
            margin-bottom: 15px;
            color: #ff9800;
            font-size: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
        }
        
        .feature-item {
            background: rgba(255, 152, 0, 0.1);
            border: 1px solid rgba(255, 152, 0, 0.3);
            border-radius: 6px;
            padding: 8px;
            text-align: center;
            font-size: 12px;
            color: #ff9800;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .feature-item:hover {
            background: rgba(255, 152, 0, 0.2);
            transform: translateY(-2px);
        }
        
        .feature-item i {
            display: block;
            font-size: 16px;
            margin-bottom: 5px;
        }
        
        .filters {
            margin-bottom: 15px;
            background: rgba(13, 27, 42, 0.7);
            padding: 15px;
            border-radius: 8px;
            border: 1px solid rgba(0, 102, 204, 0.2);
        }
        
        .filters h3 {
            margin-bottom: 15px;
            color: #66b3ff;
            font-size: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .filter-group {
            margin-bottom: 12px;
        }
        
        .filter-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 600;
            color: #66b3ff;
            font-size: 13px;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .filter-select, .search-input, .date-input {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid rgba(102, 179, 255, 0.3);
            border-radius: 6px;
            font-size: 13px;
            background: rgba(13, 27, 42, 0.9);
            color: #e6f1ff;
            transition: all 0.3s;
        }
        
        .date-input {
            background: rgba(13,27,42,0.9);
            color-scheme: dark;
        }
        
        .filter-select:focus, .search-input:focus, .date-input:focus {
            outline: none;
            border-color: #0066cc;
        }
        
        .search-box {
            display: flex;
            gap: 8px;
            margin-bottom: 10px;
        }
        
        .search-input {
            flex: 1;
            font-family: 'Courier New', monospace;
        }
        
        .btn-group {
            display: flex;
            gap: 8px;
            margin-top: 10px;
            flex-wrap: wrap;
        }
        
        .btn {
            background: linear-gradient(135deg, #0066cc, #0099ff);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 13px;
            flex: 1;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            font-weight: 600;
            min-width: 100px;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 102, 204, 0.3);
        }
        
        .btn-export {
            background: linear-gradient(135deg, #28a745, #20c997);
        }
        
        .btn-import {
            background: linear-gradient(135deg, #9c27b0, #673ab7);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #dc3545, #e83e8c);
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, #6c757d, #868e96);
        }
        
        .btn-warning {
            background: linear-gradient(135deg, #ff9800, #ff5722);
        }
        
        .history-panel {
            margin-bottom: 15px;
            background: rgba(13, 27, 42, 0.7);
            padding: 15px;
            border-radius: 8px;
            border: 1px solid rgba(0, 102, 204, 0.2);
        }
        
        .history-panel h4 {
            margin-bottom: 15px;
            color: #9c27b0;
            font-size: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .tracking-controls {
            background: rgba(13, 27, 42, 0.7);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            border: 1px solid rgba(0, 102, 204, 0.2);
        }
        
        .tracking-controls h4 {
            color: #66b3ff;
            margin-bottom: 10px;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .tracking-buttons {
            display: flex;
            gap: 8px;
            margin-bottom: 10px;
        }
        
        .call-count {
            background: rgba(255, 152, 0, 0.2);
            padding: 10px;
            border-radius: 6px;
            text-align: center;
            margin-bottom: 15px;
            border: 1px solid rgba(255, 152, 0, 0.3);
        }
        
        .call-count .number {
            font-size: 24px;
            font-weight: bold;
            color: #ff9800;
        }
        
        .call-count .label {
            font-size: 12px;
            color: #8bb4ff;
        }
        
        .history-results {
            margin-top: 15px;
            max-height: 200px;
            overflow-y: auto;
        }
        
        .history-results h4 {
            color: #9c27b0;
            margin-bottom: 12px;
            font-size: 14px;
        }
        
        .history-item {
            background: rgba(156, 39, 176, 0.1);
            padding: 10px;
            margin-bottom: 8px;
            border-radius: 6px;
            border-left: 3px solid #9c27b0;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 12px;
        }
        
        .history-item:hover {
            background: rgba(156, 39, 176, 0.2);
            transform: translateX(3px);
        }
        
        .history-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
        }
        
        .history-id {
            font-weight: bold;
            color: #9c27b0;
            font-family: 'Courier New', monospace;
        }
        
        .history-location {
            color: #8bb4ff;
            margin-bottom: 5px;
        }
        
        .history-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
        }
        
        .history-tag {
            background: rgba(156,39,176,0.2);
            color: #9c27b0;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 10px;
        }
        
        .legend {
            background: rgba(13, 27, 42, 0.7);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            border: 1px solid rgba(0, 102, 204, 0.2);
        }
        
        .legend h4 {
            margin-bottom: 10px;
            color: #66b3ff;
            font-size: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .legend-items {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 12px;
        }
        
        .legend-color {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            border: 2px solid rgba(13, 27, 42, 0.9);
        }
        
        /* LISTE DES CELLULES */
        .cell-list {
            margin-top: 15px;
            max-height: 200px;
            overflow-y: auto;
            background: rgba(13, 27, 42, 0.7);
            padding: 15px;
            border-radius: 8px;
            border: 1px solid rgba(0, 102, 204, 0.2);
        }
        
        .cell-list h4 {
            color: #66b3ff;
            margin-bottom: 12px;
            font-size: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
            position: sticky;
            top: 0;
            background: rgba(13, 27, 42, 0.95);
            padding: 8px 0;
        }
        
        .cell-item {
            background: rgba(0, 102, 204, 0.1);
            padding: 10px;
            margin-bottom: 8px;
            border-radius: 6px;
            border-left: 3px solid #0066cc;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 12px;
        }
        
        .cell-item:hover {
            background: rgba(0, 102, 204, 0.2);
            transform: translateX(3px);
        }
        
        .cell-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
        }
        
        .cell-id {
            font-weight: bold;
            color: #66b3ff;
            font-family: 'Courier New', monospace;
        }
        
        .cell-location {
            color: #8bb4ff;
            margin-bottom: 5px;
        }
        
        .cell-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
        }
        
        .cell-tag {
            background: rgba(102, 179, 255, 0.2);
            color: #66b3ff;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 10px;
        }
        
        .site-footer {
            text-align: center;
            padding: 10px;
            font-size: 12px;
            color: #8bb4ff;
            border-top: 1px solid rgba(0,102,204,0.2);
            margin-top: 15px;
        }
        
        .floating-search {
            position: absolute;
            top: 15px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 1000;
            width: 500px;
            background: rgba(13, 27, 42, 0.95);
            padding: 12px 15px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.5);
            display: flex;
            gap: 10px;
            border: 1px solid rgba(0, 102, 204, 0.3);
            backdrop-filter: blur(10px);
        }
        
        .floating-search input {
            flex: 1;
            padding: 10px 15px;
            border: 1px solid rgba(102, 179, 255, 0.3);
            border-radius: 8px;
            background: rgba(13, 27, 42, 0.9);
            color: #e6f1ff;
            font-size: 14px;
        }
        
        .floating-search button {
            background: #0066cc;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .floating-search button:hover {
            background: #0052a3;
            transform: translateY(-2px);
        }
        
        .view-controls {
            display: flex;
            gap: 8px;
            background: rgba(255, 255, 255, 0.1);
            padding: 8px;
            border-radius: 8px;
        }
        
        .view-btn {
            padding: 8px 15px;
            background: rgba(255,255,255,0.1);
            color: white;
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 13px;
        }
        
        .view-btn:hover {
            background: rgba(255,255,255,0.2);
        }
        
        .view-btn.active {
            background: white;
            color: #0066cc;
        }
        
        .view-selector {
            position: absolute;
            top: 15px;
            right: 15px;
            z-index: 1000;
            background: rgba(13, 27, 42, 0.95);
            padding: 10px;
            border-radius: 10px;
            border: 1px solid rgba(0, 102, 204, 0.3);
        }
        
        .view-selector-btn {
            background: rgba(13, 27, 42, 0.9);
            color: #e6f1ff;
            border: 1px solid rgba(0, 102, 204, 0.3);
            padding: 10px 15px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 13px;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
            min-width: 140px;
        }
        
        .view-selector-btn:hover {
            background: rgba(0, 102, 204, 0.8);
        }
        
        .view-selector-btn.active {
            background: #0066cc;
            color: white;
        }
        
        .view-selector-title {
            color: #66b3ff;
            font-size: 13px;
            font-weight: 600;
            margin-bottom: 5px;
            padding: 0 10px;
            text-align: center;
            border-bottom: 1px solid rgba(0, 102, 204, 0.2);
            padding-bottom: 8px;
        }
        
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(10, 25, 41, 0.95);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            display: none;
        }
        
        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 4px solid rgba(102, 179, 255, 0.2);
            border-top: 4px solid #0066cc;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .progress-bar {
            width: 300px;
            height: 6px;
            background: rgba(102, 179, 255, 0.2);
            border-radius: 3px;
            margin-top: 15px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #0066cc, #0099ff);
            width: 0%;
            transition: width 0.3s;
        }
        
        /* MODAL D'IMPORTATION */
        .import-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.95);
            z-index: 9999;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(5px);
        }
        
        .import-modal-content {
            background: #0a1929;
            border-radius: 12px;
            padding: 30px;
            width: 650px;
            max-width: 95%;
            border: 2px solid #9c27b0;
            box-shadow: 0 15px 40px rgba(0,0,0,0.6);
            animation: modalFadeIn 0.3s ease;
        }
        
        @keyframes modalFadeIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .import-modal h3 {
            color: #9c27b0;
            margin-bottom: 20px;
            font-size: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .import-modal-buttons {
            display: flex;
            gap: 15px;
            margin-bottom: 25px;
        }
        
        .import-modal-btn {
            flex: 1;
            padding: 14px;
            border: none;
            border-radius: 8px;
            font-weight: bold;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .import-modal-btn.cancel {
            background: #6c757d;
            color: white;
        }
        
        .import-modal-btn.import {
            background: linear-gradient(135deg, #9c27b0, #673ab7);
            color: white;
        }
        
        .import-modal-btn.import:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .import-modal-btn:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(156,39,176,0.4);
        }
        
        .file-drop-area {
            border: 2px dashed #9c27b0;
            border-radius: 10px;
            padding: 30px;
            text-align: center;
            margin-bottom: 20px;
            background: rgba(156,39,176,0.05);
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .file-drop-area.drag-over {
            border-color: #ff9800;
            background: rgba(255,152,0,0.1);
        }
        
        .file-drop-icon {
            font-size: 48px;
            color: #9c27b0;
            margin-bottom: 15px;
        }
        
        .file-info {
            margin-top: 15px;
            color: #9c27b0;
            display: none;
        }
        
        .import-options {
            margin-bottom: 20px;
            padding: 15px;
            background: rgba(156,39,176,0.1);
            border-radius: 8px;
            display: none;
        }
        
        .import-options h4 {
            color: #9c27b0;
            margin-bottom: 10px;
        }
        
        .import-options label {
            display: block;
            color: #8bb4ff;
            margin-bottom: 8px;
        }
        
        .preview-section {
            margin-bottom: 20px;
            background: rgba(13,27,42,0.7);
            border-radius: 8px;
            padding: 15px;
            display: none;
            max-height: 200px;
            overflow-y: auto;
        }
        
        .preview-section h4 {
            color: #9c27b0;
            margin-bottom: 10px;
        }
        
        .preview-table {
            width: 100%;
            border-collapse: collapse;
            font-family: 'Courier New', monospace;
            font-size: 11px;
        }
        
        .preview-table th {
            border: 1px solid #9c27b0;
            padding: 4px;
            background: #9c27b0;
            color: white;
        }
        
        .preview-table td {
            border: 1px solid #9c27b0;
            padding: 4px;
            color: #8bb4ff;
        }
        
        .import-progress {
            margin-bottom: 20px;
            display: none;
        }
        
        .progress-bar-container {
            width: 100%;
            height: 8px;
            background: rgba(156,39,176,0.2);
            border-radius: 4px;
            overflow: hidden;
            margin: 10px 0;
        }
        
        .progress-bar-fill {
            height: 100%;
            background: linear-gradient(90deg, #9c27b0, #673ab7);
            width: 0%;
            transition: width 0.3s;
        }
        
        .modal-footer {
            margin-top: 10px;
            color: #8bb4ff;
            font-size: 12px;
            text-align: center;
        }
        
        /* MODAL IMPORT LOGS */
        .logs-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.95);
            z-index: 9999;
            justify-content: center;
            align-items: center;
        }
        
        .logs-content {
            background: #0a1929;
            border-radius: 12px;
            padding: 30px;
            width: 600px;
            max-width: 95%;
            border: 2px solid #28a745;
        }
        
        .logs-content h3 {
            color: #28a745;
            margin-bottom: 20px;
        }
        
        .logs-drop-area {
            border: 2px dashed #28a745;
            border-radius: 10px;
            padding: 30px;
            text-align: center;
            margin-bottom: 20px;
            background: rgba(40,167,69,0.05);
            cursor: pointer;
        }
        
        .logs-drop-area p {
            color: #8bb4ff;
            margin-bottom: 15px;
        }
        
        .logs-drop-area .format-hint {
            font-size: 12px;
            color: #28a745;
            margin-top: 10px;
            font-family: 'Courier New', monospace;
        }
        
        .logs-btn {
            flex: 1;
            padding: 14px;
            border: none;
            border-radius: 8px;
            font-weight: bold;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .logs-btn.cancel {
            background: #6c757d;
            color: white;
        }
        
        .logs-btn.import {
            background: #28a745;
            color: white;
        }
        
        .logs-btn.import:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .logs-preview {
            margin-top: 15px;
            max-height: 150px;
            overflow-y: auto;
            background: rgba(13,27,42,0.7);
            border-radius: 6px;
            padding: 10px;
            font-family: 'Courier New', monospace;
            font-size: 11px;
            display: none;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 8px;
            color: white;
            z-index: 10001;
            animation: slideIn 0.3s ease;
            max-width: 300px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .notification.success {
            background: linear-gradient(135deg, #28a745, #20c997);
        }
        
        .notification.error {
            background: linear-gradient(135deg, #dc3545, #e83e8c);
        }
        
        .notification.warning {
            background: linear-gradient(135deg, #ff9800, #ff5722);
        }
        
        .notification.info {
            background: linear-gradient(135deg, #0066cc, #0099ff);
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        @keyframes slideOut {
            from { transform: translateX(100%); opacity: 1; }
            to { transform: translateX(0); opacity: 0; }
        }
        
        @media (max-width: 768px) {
            .sidebar {
                width: 100%;
                height: 40vh;
                position: absolute;
                bottom: 0;
                transform: translateY(100%);
            }
            
            .sidebar.open {
                transform: translateY(0);
            }
            
            #map {
                height: 60vh;
            }
            
            .floating-search {
                width: 90%;
                top: 80px;
            }
            
            .feature-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        /* ===== STYLES POUR LES MARQUEURS ET CERCLES ===== */
        .cell-marker {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background-color: #3388ff;
            border: 3px solid white;
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
            cursor: pointer;
            transition: transform 0.2s;
        }

        .cell-marker:hover {
            transform: scale(1.5);
            z-index: 1000;
        }

        .cell-radius {
            stroke: #3388ff;
            stroke-width: 2;
            stroke-dasharray: 5,5;
            fill: rgba(51, 136, 255, 0.1);
        }

        .track-message {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            z-index: 2000;
            text-align: center;
            animation: fadeIn 0.3s ease;
            border-left: 5px solid #ff9800;
            min-width: 350px;
        }

        .track-message i {
            font-size: 50px;
            color: #ff9800;
            margin-bottom: 15px;
        }

        .track-message h3 {
            color: #333;
            margin-bottom: 10px;
            font-size: 20px;
        }

        .track-message p {
            color: #666;
            margin-bottom: 20px;
        }

        .track-message button {
            background: #0066cc;
            color: white;
            border: none;
            padding: 10px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s;
        }

        .track-message button:hover {
            background: #0052a3;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,102,204,0.4);
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translate(-50%, -60%); }
            to { opacity: 1; transform: translate(-50%, -50%); }
        }

        .replay-button {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            margin: 5px;
            font-size: 14px;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
        }

        .replay-button:hover {
            background: #45a049;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(76,175,80,0.4);
        }

        .clear-button {
            background: #f44336;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            margin: 5px;
            font-size: 14px;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
        }

        .clear-button:hover {
            background: #da190b;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(244,67,54,0.4);
        }

        /* Style pour les cercles de couverture */
        .coverage-circle {
            stroke: #ff9800 !important;
            stroke-width: 3 !important;
            stroke-dasharray: 5,5 !important;
            fill: rgba(255, 152, 0, 0.15) !important;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { opacity: 0.6; }
            50% { opacity: 0.3; }
            100% { opacity: 0.6; }
        }

        /* Style pour les popups */
        .leaflet-popup-content {
            color: #0a1929;
            font-family: 'Segoe UI', sans-serif;
            min-width: 250px;
        }

        .leaflet-popup-content h4 {
            color: #0066cc;
            margin: 0 0 10px 0;
            border-bottom: 1px solid #0066cc;
            padding-bottom: 5px;
        }

        .circle-btn {
            background: #ff9800;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            margin-top: 10px;
            width: 100%;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
        }

        .circle-btn:hover {
            background: #ff5722;
            transform: translateY(-2px);
        }

        /* QR Code et Partage */
        .share-section {
            position: fixed;
            bottom: 10px;
            left: 10px;
            z-index: 10000;
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .share-info {
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 12px;
            backdrop-filter: blur(5px);
            border: 1px solid #ff9800;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .share-info:hover {
            background: rgba(255,152,0,0.3);
            transform: translateY(-2px);
        }

        .qr-modal {
            position: fixed;
            bottom: 70px;
            left: 10px;
            background: white;
            padding: 15px;
            border-radius: 10px;
            display: none;
            z-index: 10001;
            box-shadow: 0 5px 20px rgba(0,0,0,0.5);
        }

        .qr-modal.show {
            display: block;
        }

        .qr-modal canvas {
            display: block;
            margin: 0 auto;
        }

        .qr-modal p {
            color: #333;
            text-align: center;
            margin-top: 10px;
            font-size: 12px;
        }

        .qr-modal button {
            background: #0066cc;
            color: white;
            border: none;
            padding: 5px 15px;
            border-radius: 5px;
            margin-top: 10px;
            width: 100%;
            cursor: pointer;
        }

        .version-badge {
            position: fixed;
            bottom: 10px;
            right: 10px;
            background: rgba(0,102,204,0.7);
            color: white;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 10px;
            z-index: 10000;
            backdrop-filter: blur(5px);
        }
    </style>
</head>
<body>
    <!-- MODAL AUTHENTIFICATION -->
    <div id="auth-modal" class="auth-modal">
        <div class="auth-content">
            <div class="auth-header">
                <i class="fas fa-shield-alt" style="font-size: 48px; color: #0066cc; margin-bottom: 15px;"></i>
                <h2>üîê ANTSO Tracking Pro</h2>
                <p>Acc√®s s√©curis√© - 970+ Cellules Madagascar</p>
            </div>
            
            <input type="password" id="auth-password" class="auth-input" placeholder="Mot de passe" autofocus>
            
            <button id="auth-button" class="auth-button">
                <i class="fas fa-unlock-alt"></i> D√©verrouiller
            </button>
            
            <div id="auth-error" class="auth-error">
                <i class="fas fa-exclamation-triangle"></i> Mot de passe incorrect
            </div>
        </div>
    </div>

    <!-- LOADING OVERLAY -->
    <div class="loading-overlay" id="loading-overlay">
        <div class="loading-spinner"></div>
        <p style="color: #66b3ff;">Chargement des 970+ cellules YAS...</p>
        <div class="progress-bar">
            <div class="progress-fill" id="progress-fill"></div>
        </div>
    </div>

    <!-- HEADER -->
    <div class="header">
        <div class="header-content">
            <div class="header-left">
                <h1>
                    <i class="fas fa-satellite-dish"></i>
                    ANTSO Tracking Pro
                    <span class="operator-badge">
                        <i class="fas fa-signal"></i> ANTSO
                    </span>
                    <span class="security-badge">
                        <i class="fas fa-lock"></i> S√âCURIS√â
                    </span>
                    <span class="cell-count-badge" id="header-cell-count">
                        <i class="fas fa-database"></i> 0 CELLULES
                    </span>
                </h1>
                <p>Donn√©es r√©elles - Heatmap - Rayons - Historique d'appels par num√©ro</p>
            </div>
            <div class="view-controls">
                <button class="view-btn active" data-view="satellite">
                    <i class="fas fa-satellite"></i> Satellite
                </button>
                <button class="view-btn" data-view="map">
                    <i class="fas fa-map"></i> Carte
                </button>
                <button class="view-btn" data-view="terrain">
                    <i class="fas fa-mountain"></i> Terrain
                </button>
            </div>
        </div>
    </div>

    <!-- RECHERCHE FLOTTANTE -->
    <div class="floating-search">
        <input type="text" id="quick-search" placeholder="Rechercher Cell ID, localisation, ville...">
        <button id="quick-search-btn"><i class="fas fa-search"></i></button>
        <button id="geolocate-btn" style="background: linear-gradient(135deg, #ff9800, #ff5722);"><i class="fas fa-location-arrow"></i></button>
    </div>

    <!-- CONTAINER PRINCIPAL -->
    <div class="main-container">
        <div id="map"></div>

        <!-- S√âLECTEUR DE VUE -->
        <div class="view-selector">
            <div class="view-selector-title">
                <i class="fas fa-layer-group"></i> Vue
            </div>
            <button class="view-selector-btn active" id="view-satellite">
                <i class="fas fa-satellite"></i> Google Satellite
            </button>
            <button class="view-selector-btn" id="view-map">
                <i class="fas fa-map"></i> OpenStreetMap
            </button>
            <button class="view-selector-btn" id="view-terrain">
                <i class="fas fa-mountain"></i> Relief
            </button>
        </div>

        <!-- TOGGLE SIDEBAR -->
        <button class="toggle-sidebar" id="toggle-sidebar">
            <i class="fas fa-chevron-left" id="sidebar-icon"></i>
        </button>

        <!-- SIDEBAR PRINCIPALE -->
        <div class="sidebar" id="sidebar">
            <!-- STATISTIQUES -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon"><i class="fas fa-satellite-dish"></i></div>
                    <div class="stat-value" id="total-cells">0</div>
                    <div class="stat-label">Cellules</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon"><i class="fas fa-city"></i></div>
                    <div class="stat-value" id="total-cities">0</div>
                    <div class="stat-label">Villes</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon"><i class="fas fa-map"></i></div>
                    <div class="stat-value" id="total-regions">0</div>
                    <div class="stat-label">R√©gions</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon"><i class="fas fa-phone"></i></div>
                    <div class="stat-value" id="active-calls">0</div>
                    <div class="stat-label">Appels actifs</div>
                </div>
            </div>

            <!-- LISTE DES FONCTIONNALIT√âS -->
            <div class="feature-list">
                <h3><i class="fas fa-tasks"></i> Donn√©es r√©elles - Fonctionnalit√©s</h3>
                <div class="feature-grid">
                    <div class="feature-item" id="feature-rural">
                        <i class="fas fa-tree"></i>
                        Rural (3km)
                    </div>
                    <div class="feature-item" id="feature-heatmap">
                        <i class="fas fa-fire"></i>
                        Heatmap
                    </div>
                    <div class="feature-item" id="feature-history">
                        <i class="fas fa-history"></i>
                        Historique appel
                    </div>
                    <div class="feature-item" id="feature-simulate">
                        <i class="fas fa-phone"></i>
                        Appel simul√©
                    </div>
                    <div class="feature-item" id="feature-coverage">
                        <i class="fas fa-signal"></i>
                        Couverture
                    </div>
                    <div class="feature-item" id="feature-replay">
                        <i class="fas fa-route"></i>
                        Trajet rejou√©
                    </div>
                </div>
            </div>

            <!-- FILTRES & RECHERCHE -->
            <div class="filters">
                <h3><i class="fas fa-filter"></i> Filtres & Recherche</h3>
                
                <div class="search-box">
                    <input type="text" id="cellid-search" class="search-input" placeholder="Rechercher Cell ID">
                    <button id="search-btn" class="btn"><i class="fas fa-search"></i></button>
                </div>
                
                <div class="search-box">
                    <input type="text" id="location-search" class="search-input" placeholder="Rechercher Localisation">
                    <button id="clear-search-btn" class="btn btn-secondary"><i class="fas fa-times"></i></button>
                </div>
                
                <div class="filter-group">
                    <label><i class="fas fa-map-marker-alt"></i> R√©gion</label>
                    <select id="region-filter" class="filter-select">
                        <option value="all">Toutes les r√©gions</option>
                    </select>
                </div>
                
                <div class="filter-group">
                    <label><i class="fas fa-signal"></i> Type de Densit√©</label>
                    <select id="density-filter" class="filter-select">
                        <option value="all">Tous les types</option>
                        <option value="urban">Urbain</option>
                        <option value="suburban">Semi-urbain</option>
                        <option value="rural">Rural</option>
                    </select>
                </div>
                
                <div class="btn-group">
                    <button id="import-btn" class="btn btn-import">
                        <i class="fas fa-file-import"></i> Importer cellules
                    </button>
                    <button id="export-btn" class="btn btn-export">
                        <i class="fas fa-download"></i> Exporter
                    </button>
                    <button id="diagnostic-btn" class="btn btn-secondary" style="background: #9c27b0;">
                        <i class="fas fa-stethoscope"></i> Diagnostic
                    </button>
                    <button id="reset-filters-btn" class="btn btn-danger">
                        <i class="fas fa-redo"></i> Reset
                    </button>
                </div>
            </div>

            <!-- SIMULATION TRACKING -->
            <div class="tracking-controls">
                <h4><i class="fas fa-route"></i> Simulation Tracking</h4>
                <div class="tracking-buttons">
                    <button id="start-tracking" class="btn btn-warning">
                        <i class="fas fa-play"></i> D√©marrer
                    </button>
                    <button id="stop-tracking" class="btn btn-secondary">
                        <i class="fas fa-stop"></i> Arr√™ter
                    </button>
                    <button id="clear-tracking" class="btn btn-danger">
                        <i class="fas fa-trash"></i> Effacer
                    </button>
                </div>
            </div>

            <!-- HISTORIQUE D'APPELS -->
            <div class="history-panel">
                <h4><i class="fas fa-history"></i> Historique d'appels</h4>
                
                <div class="search-box">
                    <input type="text" id="phone-number-input" class="search-input" placeholder="+261 34 12 345 67" value="0341062718">
                    <button id="search-history-btn" class="btn" style="background: #9c27b0;">
                        <i class="fas fa-search"></i>
                    </button>
                </div>
                
                <div style="display: flex; gap: 8px; margin-bottom: 15px;">
                    <input type="date" id="history-date-start" class="date-input" style="flex: 1;">
                    <input type="date" id="history-date-end" class="date-input" style="flex: 1;">
                </div>
                
                <div class="call-count">
                    <span class="number" id="found-calls">0</span>
                    <span class="label">appels trouv√©s</span>
                </div>
                
                <!-- Importer logs -->
                <div style="margin-bottom: 15px;">
                    <button id="import-logs-btn" class="btn btn-secondary" style="width: 100%; margin-bottom: 8px;">
                        <i class="fas fa-file-import"></i> Importer logs (format Afera)
                    </button>
                    <div style="display: flex; gap: 8px;">
                        <button id="replay-trajet-btn" class="replay-button" style="flex: 1;">
                            <i class="fas fa-play"></i> Rejouer trajet
                        </button>
                        <button id="clear-history-btn" class="clear-button" style="flex: 1;">
                            <i class="fas fa-trash"></i> Effacer
                        </button>
                    </div>
                </div>
                
                <!-- Exporters -->
                <div style="margin-bottom: 15px;">
                    <button id="export-history-btn" class="btn btn-export" style="width: 100%;">
                        <i class="fas fa-download"></i> Exporter historique
                    </button>
                </div>
                
                <!-- Liste des appels trouv√©s -->
                <div class="history-results">
                    <h4>Appels trouv√©s (<span id="history-count">0</span>)</h4>
                    <div id="history-list"></div>
                </div>
                
                <div id="live-call-info" style="margin-top:15px; padding:10px; background:rgba(156,39,176,0.1); border-radius:6px; display:none;"></div>
            </div>

            <!-- LISTE DES CELLULES -->
            <div class="cell-list">
                <h4><i class="fas fa-list"></i> Liste des cellules (<span id="cell-list-count">970</span>)</h4>
                <div id="cells-container"></div>
            </div>

            <!-- L√âGENDE -->
            <div class="legend">
                <h4><i class="fas fa-info-circle"></i> L√©gende</h4>
                <div class="legend-items">
                    <div class="legend-item">
                        <div class="legend-color" style="background: #0066cc;"></div>
                        <span>Urbain</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: #0099ff;"></div>
                        <span>Semi-urbain</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: #66b3ff;"></div>
                        <span>Rural</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: #ff9800;"></div>
                        <span>Appel actif</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: #9c27b0;"></div>
                        <span>Historique</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="border: 2px dashed #ff9800; background: transparent;"></div>
                        <span>Trajet rejou√©</span>
                    </div>
                </div>
            </div>

            <!-- PIED DE PAGE -->
            <div class="site-footer">
                <a href="#" target="_blank">ANTSO Tracking Pro - Madagascar</a>
            </div>
        </div>
    </div>

    <!-- MODAL D'IMPORTATION CELLULES -->
    <div id="import-modal" class="import-modal">
        <div class="import-modal-content">
            <h3><i class="fas fa-file-import"></i> Importer des cellules YAS</h3>
            
            <div class="import-modal-buttons">
                <button id="cancel-import" class="import-modal-btn cancel">
                    <i class="fas fa-times"></i> ANNULER
                </button>
                <button id="process-import" class="import-modal-btn import" disabled>
                    <i class="fas fa-upload"></i> IMPORTER
                </button>
            </div>

            <div id="file-drop-area" class="file-drop-area">
                <div class="file-drop-icon"><i class="fas fa-cloud-upload-alt"></i></div>
                <p style="color:#8bb4ff; margin-bottom:10px;">Glissez-d√©posez votre fichier CSV ici</p>
                <p style="color:#66b3ff; margin-bottom:15px;">ou</p>
                <input type="file" id="file-input" accept=".csv" style="display:none;">
                <label for="file-input" style="display:inline-block; background:linear-gradient(135deg,#9c27b0,#673ab7); color:white; padding:12px 25px; border-radius:6px; cursor:pointer; font-weight:600;">
                    <i class="fas fa-folder-open"></i> Choisir un fichier
                </label>
                <div id="file-info" class="file-info">
                    <i class="fas fa-file-csv"></i> <span id="file-name"></span>
                    <span id="file-size"></span>
                </div>
            </div>

            <div id="import-options" class="import-options">
                <h4>Options</h4>
                <label>
                    <input type="checkbox" id="replace-data" checked> Remplacer les donn√©es existantes
                </label>
                <label>
                    <input type="checkbox" id="skip-invalid" checked> Ignorer les lignes invalides
                </label>
            </div>

            <div id="preview-section" class="preview-section">
                <h4>Aper√ßu</h4>
                <div id="data-preview"></div>
            </div>

            <div id="import-progress" class="import-progress">
                <div style="display:flex; justify-content:space-between; margin-bottom:5px;">
                    <span style="color:#9c27b0;">Importation...</span>
                    <span id="import-percent" style="color:#9c27b0;">0%</span>
                </div>
                <div class="progress-bar-container">
                    <div id="import-progress-bar" class="progress-bar-fill"></div>
                </div>
                <div id="import-status" style="color:#8bb4ff; font-size:13px;"></div>
            </div>
            
            <div class="modal-footer">
                Format attendu: CELL_ID,LOCALISATION,LATITUDE,LONGITUDE,R√âGION,VILLE
            </div>
        </div>
    </div>

    <!-- MODAL IMPORT LOGS (Format Afera) -->
    <div id="import-logs-modal" class="logs-modal">
        <div class="logs-content">
            <h3><i class="fas fa-phone-alt"></i> Importer logs d'appels</h3>
            
            <div id="logs-drop-area" class="logs-drop-area">
                <i class="fas fa-file-csv" style="font-size: 48px; color: #28a745; margin-bottom: 15px;"></i>
                <p>Fichier CSV au format Afera</p>
                <div class="format-hint">
                    <i class="fas fa-info-circle"></i> Format: Flux_appel,Data_type,daytime,duree_en_sec,num_a,CellId
                </div>
                <div class="format-hint" style="margin-top: 5px; color: #8bb4ff;">
                    Exemple: Entrant,SMS,2024-09-05 11:59:53,0,0341062718,646-04-18080-13053
                </div>
                <input type="file" id="logs-file-input" accept=".csv" style="display:none;">
                <label for="logs-file-input" style="display:inline-block; background:#28a745; color:white; padding:12px 25px; border-radius:6px; cursor:pointer; margin-top:15px;">
                    <i class="fas fa-folder-open"></i> Choisir un fichier
                </label>
                <div id="logs-file-info" class="file-info" style="color:#28a745;"></div>
            </div>

            <div id="logs-preview" class="logs-preview"></div>

            <div style="display:flex; gap:15px;">
                <button id="cancel-logs-import" class="logs-btn cancel" style="flex:1;">Annuler</button>
                <button id="process-logs-import" class="logs-btn import" style="flex:1;" disabled>Importer</button>
            </div>
        </div>
    </div>

    <!-- SECTION PARTAGE - NOUVEAU -->
    <div class="share-section">
        <div class="share-info" id="share-button">
            <i class="fas fa-share-alt"></i> Partagez cette application
        </div>
        <div class="share-info" id="copy-link-button">
            <i class="fas fa-copy"></i> Copier le lien
        </div>
        <div class="qr-modal" id="qr-modal">
            <div id="qrcode"></div>
            <p>Scannez pour ouvrir sur mobile</p>
            <button id="close-qr">Fermer</button>
        </div>
    </div>

    <!-- VERSION BADGE -->
    <div class="version-badge">
        <i class="fas fa-code-branch"></i> v2.0 - 970+ cellules
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet.markercluster/1.5.3/leaflet.markercluster.js"></script>

    <script>
        // =============================================
        // SYST√àME DE S√âCURIT√â
        // =============================================
        const SecuritySystem = {
            authenticated: false,
            
            checkPassword(password) {
                const validPassword = "#05AaroN022026!";
                const isValid = password === validPassword;
                
                if (isValid) {
                    this.authenticated = true;
                    document.getElementById('auth-modal').style.display = 'none';
                    document.getElementById('loading-overlay').style.display = 'flex';
                    
                    // Simuler le chargement
                    let progress = 0;
                    const interval = setInterval(() => {
                        progress += 10;
                        document.getElementById('progress-fill').style.width = progress + '%';
                        
                        if (progress >= 100) {
                            clearInterval(interval);
                            setTimeout(() => {
                                document.getElementById('loading-overlay').style.display = 'none';
                                initApp();
                            }, 500);
                        }
                    }, 100);
                    
                    return true;
                } else {
                    document.getElementById('auth-error').style.display = 'block';
                    return false;
                }
            }
        };

        // =============================================
        // DONN√âES COMPL√àTES - 970+ CELLULES
        // =============================================
        const CELLS = [
            // === VOS 888 CELLULES ORIGINALES ===
            ["646-04-10000-50201","MHJ_TSARAMANDROSO",-15.708157,46.3195243,"Boeny","MHJ_TSARAMANDROSO","suburban"], 
            ["646-04-10000-50212","MHJ_TSARARANO",-15.701753,46.328901,"Boeny","MHJ_TSARARANO","suburban"],
            ["646-04-10000-50552","KATSEPY",-15.762286,46.237176,"Boeny","KATSEPY","rural"],
            ["646-04-10000-50902","MHJ_TSARARANO_AMBANY",-15.70998,46.327253,"Boeny","MHJ_TSARARANO_AMBANY","suburban"],
            ["646-04-10000-50903","MHJ_TSARARANO_AMBANY",-15.70998,46.327253,"Boeny","MHJ_TSARARANO_AMBANY","suburban"],
            ["646-04-10000-50912","MHJ_VILLAGE",-15.7037876,46.309271,"Boeny","MHJ-VILLAGE","suburban"],
            ["646-04-10000-50943","MHJ ANKOMY",-15.7181,46.3156,"Boeny","ANKOMY","suburban"],
            ["646-04-10010-63011","AMBILOBE_TVM",-13.1936,49.05,"SAVA","AMBILOBE_TVM","suburban"],
            ["646-04-10010-63022","DIEGO_TELMA",-12.32111,49.3047668,"DIANA","DIEGO_TELMA","urban"],
            ["646-04-10010-63033","DIEGO_ARASARA",-12.2764,49.2917,"DIANA","Di√©go-Suarez","urban"],
            ["646-04-10010-63123","DIEGOLAZARET",-12.330132,49.283523,"DIANA","DIEGOLAZARET","urban"],
            ["646-04-10010-63153","ANIVORANO",-12.72711,49.22503,"SAVA","ANIVORANO","rural"],
            ["646-04-10010-63193","RAMENA",-12.72979,48.936638,"DIANA","RAMENA","rural"],
            ["646-04-10010-63221","ANDRANOTSARA",-12.312858,49.19825,"DIANA","ANDRANOTSARA","rural"],
            ["646-04-10010-63223","ANDRANOTSARA",-12.312858,49.19825,"DIANA","ANDRANOTSARA","rural"],
            ["646-04-10010-63251","SADJOAVATO",-12.6312,49.35097,"DIANA","SADJOAVATO","suburban"],
            ["646-04-10010-63303","DIEGO_MORAFENO",-12.299396,49.29697,"DIANA","MORAFENO","urban"],
            ["646-04-10010-63311","ILEPA",-12.2547,49.2793,"DIANA","ILEPA","rural"],
            ["646-04-10010-63553","MAHAVANONA",-13.3154,49.8668,"DIANA","MAHAVONONA","rural"],
            ["646-04-10010-63863","MARIVORAHONA",-13.0865,49.10505,"DIANA","MARIVORAHONA","rural"],
            ["646-04-10010-64041","ANIVORANO2",-12.73983,49.22916,"SAVA","ANIVORANO2","rural"],
            ["646-04-10010-64042","ANIVORANO2",-12.73983,49.22916,"SAVA","ANIVORANO2","rural"],
            ["646-04-10010-64045","ANIVORANO2",-12.73983,49.22916,"SAVA","ANIVORANO2","rural"],
            ["646-04-10010-64112","AMBILOBE101",-13.176798,49.065728,"SAVA","AMBILOBE","suburban"],
            ["646-04-10010-64271","DIEGO_BAZARIKELY",-12.34193,49.016318,"DIANA","DIEGO_BAZARIKELY","urban"], 
            ["646-04-10010-64343","AMBOLOZOBE",-12.4478,49.5437,"DIANA","AMBOLOZOBE","rural"],
            ["646-04-10010-64363","DIEGO_LAZARETNORD",-12.2764,49.2917,"DIANA","DIEGO_LAZARETNORD","urban"],
            ["646-04-10010-64411","AMBILOBE_ANORONALA",-13.20253,49.051709,"SAVA","AMBILOBE","suburban"],
            ["646-04-10010-64412","AMBILOBE_ANORONALA",-13.18732,49.0521,"SAVA","AMBILOBE","suburban"],
            ["646-04-10020-63072","NOSYB_CHAPELLE",-13.3704,48.2627,"DIANA","NOSYB_CHAPELLE","suburban"],
            ["646-04-10020-63201","NOSYBELACRATERE",-13.3792,48.2006,"DIANA","NOSYBELACRATERE","suburban"],
            ["646-04-10040-55111","MANASAMODY",-15.0958,47.9194,"SOFIA","MANASAMODY","rural"],
            ["646-04-10060-50371","NAMAKIA",-15.84972,45.80421,"Boeny","NAMAKIA","rural"],
            ["646-04-10060-50372","NAMAKIA",-15.84972,45.80421,"Boeny","NAMAKIA","rural"],
            ["646-04-10060-50563","ANALATELO",-15.8863,46.1324,"Boeny","ANALATELO","rural"],
            ["646-04-10060-50573","MITSINJO",-16.0221,45.8119,"Boeny","MITSINJO","rural"],
            ["646-04-10070-50841","ANKAZOMBORONA",-16.1006,46.6816,"Boeny","ANKAZOMBORONA","rural"],
            ["646-04-10070-50842","ANKAZOMBORONA",-16.1006,46.6816,"Boeny","ANKAZOMBORONA","rural"],
            ["646-04-10080-53283","ANDRIBA",-17.584,46.79075,"Betsiboka","ANDRIBA","rural"],
            ["646-04-12020-30013","TOAMASINA_OCB",-18.15541,49.408217,"Atsinanana","TOAMASINA_OCB","urban"],
            ["646-04-12020-30051","TOAMAS_ANKIRIRY",-18.139356,49.399127,"Atsinanana","TOAMAS_ANKIRIRY","urban"],
            ["646-04-12020-30202","TOAMAS_ANJO",-18.159984,49.414321,"Atsinanana","TOAMAS_ANJO","urban"],
            ["646-04-12020-30232","BARIKADIMY",-18.117378,49.349578,"Atsinanana","BARIKADIMY","urban"],
            ["646-04-12020-30241","TANAMBAO",-18.215078,49.307006,"Atsinanana","TANAMBAO","urban"],
            ["646-04-12020-30242","TANAMBAO",-18.215078,49.307006,"Atsinanana","TANAMBAO","urban"],
            ["646-04-12020-30251","AMBOLODINIKA",-18.151271,49.39872,"Atsinanana","AMBOLODINIKA","urban"],
            ["646-04-12020-30652","AMBALAMANASA2",-18.105957,49.380134,"Atsinanana","AMBALAMANASA2","urban"],
            ["646-04-12020-30664","TOA_MANANGAREZA",-18.170185,49.39655,"Atsinanana","TOA_MANANGAREZA","urban"],
            ["646-04-12020-30821","TOA_MANGARANO",-18.143735,49.373905,"Atsinanana","TOA_MANGARANO","urban"],
            ["646-04-12020-31021","TOA_AMBOHIJAFY",-18.124556,49.403651,"Atsinanana","TOA_AMBOHIJAFY","urban"],
            ["646-04-12020-31192","ZEBU_KOBAMA",-18.14491,49.415001,"Atsinanana","ZEBU_KOBAMA","urban"],
            ["646-04-12020-31213","TANAMBOROZANO2",-18.161207,49.398227,"Atsinanana","TANAMBOROZANO2","urban"],
            ["646-04-12020-31221","TOAMASINA105",-18.171408,49.376296,"Atsinanana","TOAMASINA105","urban"],
            ["646-04-12020-31223","TOAMASINA105",-18.171408,49.376296,"Atsinanana","TOAMASINA105","urban"],
            ["646-04-12020-31252","TOA_TANAMBAO2",-18.151839,49.4256062,"Atsinanana","TOA_TANAMBAO2","urban"],
            ["646-04-12020-31353","TAMATAVE_BEACH",-18.1532701,49.41687,"Atsinanana","TAMATAVE_BEACH","suburban"],
            ["646-04-12020-31361","TOAMASINA STADE",-18.144414,49.374176,"Atsinanana","TOAMASINA STADE","urban"],
            ["646-04-12020-31371","TOA_TSARARIVOTRA",-18.167283,49.3658697,"Atsinanana","TOA_TSARARIVOTRA","urban"],
            ["646-04-12020-31372","TOA_TSARARIVOTRA",-18.167283,49.3658697,"Atsinanana","TOA_TSARARIVOTRA","urban"],
            ["646-04-12020-31373","TOA_TSARARIVOTRA",-18.167283,49.3658697,"Atsinanana","TOA_TSARARIVOTRA","urban"],
            ["646-04-12020-31551","TOA_VOHITSARA",-18.513829,49.13464,"Atsinanana","TOA_VOHITSARA","urban"],
            ["646-04-12020-31572","TOA_BARIKADIMY2",-18.148817,49.408225,"Atsinanana","TOA_BARIKADIMY2","urban"],
            ["646-04-12020-31622","TOA ANJO DENSIF",-18.159855,49.414332,"Atsinanana","TOA ANJO DENSIF","urban"],
            ["646-04-12030-30152","TONGOBATO",-18.9825,48.94183,"Atsinanana","TONGOBATO","rural"],
            ["646-04-12030-30281","ANTSAMPANANA",-18.97305,49.003044,"Alaotra Manogro","ANTSAMPANANA","rural"],
            ["646-04-12030-30702","AMBALARONDRA",-18.462706,48.987594,"Atsinanana","AMBALARONDRA","rural"],
            ["646-04-12030-30732","AMBINANINONY",-18.600076,49.11737,"Atsinanana","AMBINANINONY","rural"],
            ["646-04-12030-30733","AMBINANINONY",-18.600076,49.11737,"Atsinanana","AMBINANINONY","rural"],
            ["646-04-12030-30736","AMBINANINONY",-18.600076,49.11737,"Atsinanana","AMBINANINONY","rural"],
            ["646-04-12030-37273","BEFORONA",-18.9698351,48.579856,"Atsinanana","BEFORONA","rural"],
            ["646-04-12060-37803","AMBOAVORY",-17.301025,48.586006,"Alaotra Mangoro","AMBOAVORY","rural"],
            ["646-04-12080-37331","MANAK_ALAOTRA",-19.260878,48.072041,"AlaotraMangoro","MANAK_ALAOTRA","rural"],
            ["646-04-12080-37352","AMPARAMANINA",-17.677117,48.245275,"Alaotra Mangoro","AMPARAMANINA","rural"],
            ["646-04-12100-31683","MAHANORO AMBALAKINININA",-19.893804,48.807534,"Atsinanana","MAHANORO AMBALAKINININA","rural"],
            ["646-04-12110-37423","MORARANO",-19.431631,47.487795,"Alaotra Mangoro","MORARANO","rural"],
            ["646-04-12120-37013","AMBATOZAKA_TVM",-17.830432,48.429565,"Alaotra Mangoro","AMBATOZAKA_TVM","suburban"],
            ["646-04-12120-37191","AMBATON_TELMA",-17.833128,48.405104,"Alaotra Mangoro","AMBATON_TELMA","suburban"],
            ["646-04-12120-37771","AMBATONDRAZAKA3",-17.7965,48.4369,"Alaotra Mangoro","AMBATONDRAZAKA3","suburban"],
            ["646-04-12120-37773","AMBATONDRAZAKA3",-17.7965,48.4369,"Alaotra Mangoro","AMBATONDRAZAKA3","suburban"],
            ["646-04-13011-43261","AMBATOMARINA",-20.5716,47.0337,"Amoron'i Mania","AMBATOMARINA","rural"],
            ["646-04-13070-13182","FARATSIHO",-19.4057,46.9498,"Vakinankaratra","FARATSIHO","rural"],
            ["646-04-13080-13181","FARATSIHO",-19.4057,46.9498,"Vakinankaratra","FARATSIHO","rural"],
            ["646-04-13080-13461","ANTAKASINA",-19.49076,47.73879,"Vakinankaratra","ANTAKASINA","rural"],
            ["646-04-13080-13701","ANGODOGODONA",-19.0989,47.76845,"Analamanga","ANGODOGODONA","rural"],
            ["646-04-13080-13851","ALAROBIA_ANTANAMALAZA",-19.430816,47.629816,"Vakinankaratra","ALAROBIA_ANTANAMALAZA","urban"],
            ["646-04-13080-14041","AMBOHIBOAHANGY",-18.7866,47.5301,"Analamanga","AMBOHIBOAHANGY","urban"],
            ["646-04-13080-14123","AMBOLOLONDRANO",-19.0697,47.7735,"Analamanga","AMBOLOLONDRANO","rural"],
            ["646-04-13090-13162","BETAFO",-19.84,46.8575,"Vakinankaratra","BETAFO","suburban"],
            ["646-04-13090-13163","BETAFO",-19.84,46.8575,"Vakinankaratra","BETAFO","suburban"],
            ["646-04-13090-13261","MANDOTO_COLLINE",-19.58309,46.2924,"Vakinankaratra","MANDOTO_COLLINE","rural"],
            ["646-04-13090-13333","ANTANETIKELY",-19.074544,47.486883,"Analamanga","ANTANETIKELY","urban"],
            ["646-04-13090-13411","AMBOHIMANAMBOLA2",-19.8083,46.6177,"Vakinankaratra","AMBOHIMANAMBOLA2","rural"],
            ["646-04-13090-13423","ANJOMA_RAMARTINA",-19.6375,45.92968,"Vakinankaratra","ANJOMA_RAMARTINA","rural"],
            ["646-04-13090-13521","AMBATONIKOLAHY",-19.7248,46.9267,"Vakinankaratra","AMBATONIKOLAHY","rural"],
            ["646-04-13090-13522","AMBATONIKOLAHY",-19.7248,46.9267,"Vakinankaratra","AMBATONIKOLAHY","rural"],
            ["646-04-13090-13523","AMBATONIKOLAHY",-19.7248,46.9267,"Vakinankaratra","AMBATONIKOLAHY","rural"],
            ["646-04-13090-13532","AMBANO",-19.7967,47.0461,"Vakinankaratra","AMBANO","urban"],
            ["646-04-13090-13533","AMBANO",-19.7967,47.0461,"Vakinankaratra","AMBANO","urban"],
            ["646-04-13090-13651","ANJAZAFOTSY",-19.8246,46.8163,"Vakinankaratra","ANJAZAFOTSY","rural"],
            ["646-04-13090-13653","ANJAZAFOTSY",-19.8246,46.8163,"Vakinankaratra","ANJAZAFOTSY","rural"],
            ["646-04-13090-13721","MANDOA_CN",-19.8644,46.7859,"Vakinankaratra","MANDOA_CN","rural"],
            ["646-04-13090-13723","MANDOA_CN",-19.8644,46.7859,"Vakinankaratra","MANDOA_CN","rural"],
            ["646-04-13090-13811","AMBARY",-19.86804,46.07535,"Vakinankaratra","AMBARY","rural"],
            ["646-04-13090-13813","AMBARY",-19.86804,46.07535,"Vakinankaratra","AMBARY","rural"],
            ["646-04-13090-13842","MANDOTO_CENTRE",-19.58309,46.2924,"Vakinankaratra","MANDOTO_CENTRE","rural"],
            ["646-04-13090-13843","MANDOTO_CENTRE",-19.58309,46.2924,"Vakinankaratra","MANDOTO_CENTRE","rural"],
            ["646-04-13090-13911","MANOHISOA",-18.9515,47.672005,"Analamanga","ANJEVA","rural"],
            ["646-04-13090-13912","MANOHISOA",-18.9515,47.672005,"Analamanga","ANJEVA","rural"],
            ["646-04-13090-14022","TRITRIVA",-19.9296,46.92641,"Vakinankaratra","TRITRIVA","rural"],
            ["646-04-13090-14024","TRITRIVA",-19.9296,46.92641,"Vakinankaratra","TRITRIVA","rural"],
            ["646-04-13100-13011","ABE_IVOHITRA",-19.8794,47.00564,"Vakinankaratra","IVOHITRA","urban"],
            ["646-04-13100-13012","ABE_IVOHITRA",-19.8794,47.00564,"Vakinankaratra","IVOHITRA","urban"],
            ["646-04-13100-13013","ABE_IVOHITRA",-19.8794,47.00564,"Vakinankaratra","IVOHITRA","urban"],
            ["646-04-13100-13022","ABE_ANDRANON",-19.782761,47.11761,"Vakinankaratra","Andranomanelatra","urban"],
            ["646-04-13100-13023","ABE_ANDRANON",-19.782761,47.11761,"Vakinankaratra","Andranomanelatra","urban"],
            ["646-04-13100-13083","ANTSIRABE_TELMA",-19.8686,47.0331,"Vakinankaratra","Antsirabe","urban"],
            ["646-04-13100-13133","MANANDONA",-20.0618,47.06047,"Vakinankaratra","MANANDONA","suburban"],
            ["646-04-13100-13191","ANTSIRABE_FALY",-19.8686,47.0331,"Vakinankaratra","Mahafaly","urban"],
            ["646-04-13100-13201","ANTBE_ANTSAKELY",-19.8729,47.0296,"Vakinankaratra","Antsenakely","urban"],
            ["646-04-13100-13202","ANTBE_ANTSAKELY",-19.8729,47.0296,"Vakinankaratra","Antsenakely","urban"],
            ["646-04-13100-13213","ABE_AMBOHIMENA",-19.8867,47.0418,"Vakinankaratra","Ambohimena","urban"],
            ["646-04-13100-13242","ABE_MAHAZOARIVO",-19.84907,47.02928,"Vakinankaratra","Mahazoarivo","urban"],
            ["646-04-13100-13252","ABE_SABOTSY",-19.8694,47.02702,"Vakinankaratra","ABE_SABOTSY","urban"],
            ["646-04-13100-13253","ABE_SABOTSY",-19.8694,47.02702,"Vakinankaratra","ABE_SABOTSY","urban"],
            ["646-04-13100-13281","ABE_AMBALAVATO",-19.87874,47.04729,"Analamanga","Ambalavato","urban"],
            ["646-04-13100-13283","ABE_AMBALAVATO",-19.87874,47.04729,"Analamanga","Ambalavato","urban"],
            ["646-04-13100-13391","SOANINDRARINY",-19.9035,47.24418,"Vakinankaratra","SOANINDRARINY","suburban"],
            ["646-04-13100-13393","SOANINDRARINY",-19.9035,47.24418,"Vakinankaratra","SOANINDRARINY","suburban"],
            ["646-04-13100-13543","AMBOHINDRANANDRIANA",-19.8833,47.1458,"Vakinankaratra","AMBOHINDRANANDRIANA","suburban"],
            ["646-04-13100-13553","AMPATOTRAMALONA",-19.99612,47.20497,"Vakinankaratra","Tsarahonenana","suburban"],
            ["646-04-13100-13641","ANTSIRABE_VATOFOTSY",-19.8667,47.03,"Vakinankaratra","Vatofotsy","suburban"],
            ["646-04-13100-13642","ANTSIRABE_VATOFOTSY",-19.8667,47.03,"Vakinankaratra","Vatofotsy","suburban"],
            ["646-04-13100-13671","ANDREMBESOA",-20.1478,46.6566,"Vakinankaratra","ANDREMBESOA","rural"],
            ["646-04-13100-13782","ANTSIRABE_LYCEE",-19.8686,47.0331,"Vakinankaratra","ANTSIRABE_LYCEE","urban"],
            ["646-04-13100-13791","ALATSINAINY_IBITY",-20.0509,46.9972,"Vakinankaratra","ALATSINAINY_IBITY","suburban"],
            ["646-04-13100-13792","ALATSINAINY_IBITY",-20.0509,46.9972,"Vakinankaratra","ALATSINAINY_IBITY","suburban"],
            ["646-04-13100-13793","ALATSINAINY_IBITY",-20.0509,46.9972,"Vakinankaratra","ALATSINAINY_IBITY","suburban"],
            ["646-04-13100-13831","ANTSIRABE_TSIVATRINIKAMO",-19.8686,47.0331,"Vakinankaratra","ANTSIRABE_TSIVATRINIKAMO","urban"],
            ["646-04-13100-13832","ANTSIRABE_TSIVATRINIKAMO",-19.8686,47.0331,"Vakinankaratra","ANTSIRABE_TSIVATRINIKAMO","urban"],
            ["646-04-13100-13902","SAHANIVOTRY",-20.11262,47.07141,"Vakinankaratra","SAHANIVOTRY","suburban"],
            ["646-04-13100-13921","MANDANIRESAKA",-19.9084,47.04506,"Vakinankaratra","MANDANIRESAKA","urban"],
            ["646-04-13100-13922","MANDANIRESAKA",-19.9084,47.04506,"Vakinankaratra","MANDANIRESAKA","urban"],
            ["646-04-13100-13983","ABE_AVARATSENA",-19.86853,47.02836,"Vakinankaratra","Avaratsena","urban"],
            ["646-04-13100-14001","ABE_TOMBOARIVO",-19.8684,47.04238,"Vakinankaratra","Tomboarivo","urban"],
            ["646-04-13100-14011","ABE_MAHAZINA",-19.878903,47.037704,"Vakinankaratra","Mahazina","urban"],
            ["646-04-13100-14033","VINANINKARENA",-19.95636,47.03953,"Vakinankaratra","VINANINKARENA","suburban"],
            ["646-04-13100-14191","ANTSOATANY",-18.966922,47.536568,"Vakinankaratra","ANTSOATANY","urban"],
            ["646-04-13180-43512","ANKAFINA_TSARAFIDY",-21.205288,47.245465,"Haute Matsiatra","ANKAFINA_TSARAFIDY","rural"],
            ["646-04-13180-43513","ANKAFINA_TSARAFIDY",-21.205288,47.245465,"Haute Matsiatra","ANKAFINA_TSARAFIDY","rural"],
            ["646-04-13220-48202","MASIANAKA",-23.5807,47.5842,"Atsimo Atsinanana","MASIANAKA","rural"],
            ["646-04-13220-48203","MASIANAKA",-23.5807,47.5842,"Atsimo Atsinanana","MASIANAKA","rural"],
            ["646-04-13230-48023","MANAKARA",-22.1486,48.0106,"Fitovinany","MANAKARA","suburban"],
            ["646-04-13230-48051","VOHIPENO",-22.3539,47.841,"Fitovinany","VOHIPENO","rural"],
            ["646-04-13230-48401","MAROFARIHY",-22.14298,48.0067,"Fitovinany","MAROFARIHY","rural"],
            ["646-04-13230-48402","MAROFARIHY",-22.14298,48.0067,"Fitovinany","MAROFARIHY","rural"],
            ["646-04-13230-48802","MANAKARA_2",-22.1486,48.0106,"Fitovinany","MANAKARA","suburban"],
            ["646-04-13230-48803","MANAKARA_2",-22.1486,48.0106,"Fitovinany","MANAKARA","suburban"],
            ["646-04-13240-48041","RANOMAFANA",-21.2726,47.4883,"Vatovavy","RANOMAFANA","rural"],
            ["646-04-13240-48142","RANOMAFANA_DENSIF",-21.2726,47.4883,"Vatovavy","RANOMAFANA_DENSIF","suburban"],
            ["646-04-13240-49021","KELILALINA",-21.3052,47.5541,"Vatovavy","KELILALINA","rural"],
            ["646-04-13240-49023","KELILALINA",-21.3052,47.5541,"Vatovavy","KELILALINA","rural"],
            ["646-04-17011-43012","AMBOSITRA",-20.536237,47.245827,"Amoron'i Mania","Ambositra","urban"],
            ["646-04-17011-43051","AMBOSITRA_TAMPONIVINANY",-20.533986,47.240377,"Amoron'i Mania","AMBOSITRA_TAMPONIVINANY","urban"],
            ["646-04-17011-43052","AMBOSITRA_TAMPONIVINANY",-20.533986,47.240377,"Amoron'i Mania","AMBOSITRA_TAMPONIVINANY","urban"],
            ["646-04-17011-43081","TSARASAOTRA",-20.4397,47.19912,"Amoron'i Mania","TSARASAOTRA","suburban"],
            ["646-04-17011-43083","TSARASAOTRA",-20.4397,47.19912,"Amoron'i Mania","TSARASAOTRA","suburban"],
            ["646-04-17011-43091","IVATOAMBOSITRA",-20.634254,47.199768,"Amoron'i Mania","Ivato","urban"],
            ["646-04-17011-43302","AMBOHIPIANERANA",-20.5702,47.2302,"Amoron'i Mania","AMBOHIPIANERANA","suburban"],
            ["646-04-17011-43312","AMBOHIMAHATSARA",-20.34813,47.32613,"Amoron'i Mania","AMBOHIMAHATSARA","rural"],
            ["646-04-17011-43313","AMBOHIMAHATSARA",-20.34813,47.32613,"Amoron'i Mania","AMBOHIMAHATSARA","rural"],
            ["646-04-17011-43362","AMBOSITRA_TANAMAHALANA",-20.541406,47.255138,"Amoron'i Mania","AMBOSITRA_TANAMAHALANA","urban"],
            ["646-04-17011-43363","AMBOSITRA_TANAMAHALANA",-20.541406,47.255138,"Amoron'i Mania","AMBOSITRA_TANAMAHALANA","urban"],
            ["646-04-17011-43432","AMBOSITRA_AMBOHIBARY",-20.4332,47.150611,"Amoron'i Mania","AMBOSITRA_AMBOHIBARY","urban"],
            ["646-04-17011-43552","AMBOSITRA4",-20.536237,47.245827,"Amoron'i Mania","AMBOSITRA4","urban"],
            ["646-04-17011-43743","ANJOMA_NAKOANA",-20.590005,47.1122,"Amoron'i Mania","ANJOMA_NAKOANA","rural"],
            ["646-04-17100-17461","TSARATANANA_BON",-18.0654415,46.320185,"Bonolava","TSARATANANA_BON","urban"],
            ["646-04-17120-17473","ANTANETIBE",-18.6160148,47.1353,"Analamanga","ANTANETIBE","urban"],
            ["646-04-17170-21892","AMBOHIMIADANA",-19.243816,47.77539,"Analamanga","AMBOHIMIADANA","rural"],
            ["646-04-17170-21962","ALATSINA_BAKARO",-19.3813,47.706959,"Analamanga","ALATSINA_BAKARO","rural"],
            ["646-04-17170-23133","ANTANIMASAKA",-19.113937,47.815773,"Analamanga","ANTANIMASAKA","urban"],
            ["646-04-17170-24723","AMBOHIJANAKA_ANDRAMASINA",-19.3674,47.7744,"Analamanga","AMBOHIJANAKA_ANDRAMASINA","rural"],
            ["646-04-17170-24802","AMBOHIBEMANJAKA",-19.2314,47.6889,"Analamanga","AMBOHIBEMANJAKA","rural"],
            ["646-04-17170-25212","TRIMOLOHARANO",-19.1652,47.7869,"Analamanga","TRIMOLOHARANO","rural"],
            ["646-04-17170-25353","BAKARO",-19.3813,47.706959,"Analamanga","BAKARO","rural"],
            ["646-04-17180-20741","AMBATOLAONA",-18.9142,47.8927,"Analamanga","AMBATOLAONA","rural"],
            ["646-04-17180-20742","AMBATOLAONA",-18.9142,47.8927,"Analamanga","AMBATOLAONA","rural"],
            ["646-04-17180-26511","ANGAVOKELY_MOVE",-18.9267,47.74252,"Analamanga","ANGAVOKELY_MOVE","rural"],
            ["646-04-17180-37202","MAROZEVO",-18.9692,48.6235,"Alaotra Mangoro","MAROZEVO","rural"],
            ["646-04-17700-20092","AMBOHIDRAPETO",-18.91233,47.4905,"Analamanga","AMBOHIDRAPETO","urban"],
            ["646-04-17700-20222","AMBOHIMANARINA",-18.8713,47.49375,"Analamanga","AMBOHIMANARINA","urban"],
            ["646-04-17700-20291","ANKORONDRANO",-18.8924,47.51974,"Analamanga","ANKORONDRANO","urban"],
            ["646-04-17700-20501","BEMASOANDRO",-18.90502,47.4864,"Analamanga","BEMASOANDRO","urban"],
            ["646-04-17700-20872","ANDRANONAHOATRA",-18.91209,47.47333,"Analamanga","ANDRANONAHOATRA","urban"],
            ["646-04-17700-20921","AMBODIMITA",-18.8657,47.483973,"Analamanga","AMBODIMITA","urban"],
            ["646-04-17700-21161","ANOSIMASINA",-18.8984,47.49147,"Analamanga","ANOSIMASINA","urban"],
            ["646-04-17700-21163","ANOSIMASINA",-18.8984,47.49147,"Analamanga","ANOSIMASINA","urban"],
            ["646-04-17700-22602","ANKAZOMANGA",-18.8828,47.50774,"Analamanga","ANKAZOMANGA","urban"],
            ["646-04-17700-22603","ANKAZOMANGA",-18.8828,47.50774,"Analamanga","ANKAZOMANGA","urban"],
            ["646-04-17700-22932","TAN_ANDRAHARO",-18.8782292,47.50816,"Analamanga","ANDRAHARO","urban"],
            ["646-04-17700-22945","IVANDRY2",-18.8753,47.52405,"Analamanga","IVANDRY2","urban"],
            ["646-04-17700-22962","ANKORONDRANO_BNI",-18.8924,47.51974,"Analamanga","ANKORONDRANO_BNI","urban"],
            ["646-04-17700-23493","ITAOSY_CITE",-18.9094,47.47511,"Analamanga","ITAOSY_CITE","urban"],
            ["646-04-17700-23551","AMBOHIMANARINA_2",-18.91575,47.541,"Analamanga","AMBOHIMANARINA_2","urban"],
            ["646-04-17700-23643","TAN_IBIS",-18.8788419,47.522591,"Analamanga","IBIS","urban"],
            ["646-04-17700-23732","ALAROBIA_AMBONILOHA",-18.8711,47.52358,"Analamanga","ALAROBIA_AMBONILOHA","urban"],
            ["646-04-17700-23752","ANDRAHARO_2_OTC",-18.87812,47.5096,"Analamanga","ANDRAHARO_2_OTC","urban"],
            ["646-04-17700-23911","AMBOHITRIMANJAKA2",-18.8677,47.4416,"Analamanga","AMBOHITRIMANJAKA2","urban"],
            ["646-04-17700-23941","TAN_ANDOHATANJONA",-18.90811,47.447915,"Analamanga","ANDOHATANJONA","urban"], 
            ["646-04-17700-23942","TAN_ANDOHATANJONA",-18.90813241,47.447915,"Analamanga","ANDOHATANJONA","urban"],
            ["646-04-17700-23983","AQUAMAD",-18.8711,47.51051,"Analamanga","AQUAMAD","urban"],
            ["646-04-17700-24331","AMBOHIJAFY_ITAOSY",-18.90116,47.48793,"Analamanga","AMBOHIJAFY_ITAOSY","urban"],
            ["646-04-17700-24381","TAN_BERAVINA_ITAOSY",-18.909979,47.4772,"Analamanga","TAN_BERAVINA_ITAOSY","urban"],  
            ["646-04-17700-24443","FENOARIVO_ALAK",-18.9065,47.45491,"Analamanga","FENOARIVO_ALAK","urban"],
            ["646-04-17700-24561","AMBOHIMAMORY",-19.411646,46.4616,"Analamanga","AMBOHIMAMORY","rural"],
            ["646-04-17700-24782","TAN_NOVOTEL_RRU_DEPORTE",-18.872704,47.522178,"Analamanga","TAN_NOVOTEL_RRU_DEPORTE","urban"], 
            ["646-04-17700-25461","FENOARIVO",-18.9328,47.42984,"Analamanga","FENOARIVO","urban"],
            ["646-04-17700-26222","AMBOHIDRAPETO2",-18.903724,47.476431,"Analamanga","AMBOHIDRAPETO2","urban"], 
            ["646-04-17700-26631","TAN AMBANIALA",-18.92399,47.487219,"Analamanga","AMBANIALA","urban"],
            ["646-04-17700-26691","TAN AMPASIKA3",-18.90353,47.49835,"Analamanga","AMPASIKA3","urban"],
            ["646-04-17700-26692","TAN AMPASIKA3",-18.90353,47.49835,"Analamanga","AMPASIKA3","urban"],
            ["646-04-17700-26771","TAN MAROBIBY",-18.766733,46.869825,"Analamanga","MAROBIBY","urban"],
            ["646-04-17700-26773","NEW CELL",-18.966922,47.536568,"Analamanga","NEW CELL","urban"],
            ["646-04-17700-26811","TAN ALAROBIAMOVE",-18.8719573,47.5200571,"Analamanga","ALAROBIA","urban"],  
            ["646-04-17700-27493","AMBATOMIRAHAVAVY",-18.9337,47.396,"Analamanga","AMBATOMIRAHAVAVY","urban"],
            ["646-04-17706-20011","AMBOHIMAHITSY",-18.9723,47.46414,"Analamanga","AMBOHIMAHITSY","suburban"],
            ["646-04-17706-20013","AMBOHIMAHITSY",-18.9723,47.46414,"Analamanga","AMBOHIMAHITSY","suburban"],
            ["646-04-17706-20032","IVANDRY",-18.8753,47.52405,"Analamanga","IVANDRY","urban"],
            ["646-04-17706-20721","AMBOHITROMBY",-18.9718,47.5736,"Analamanga","AMBOHITROMBY","suburban"],
            ["646-04-17706-20733","AMBATOLAMPIKELY",-19.54417,47.42087,"Analamanga","AMBATOLAMPIKELY","rural"],
            ["646-04-17706-20861","BMOI_ANALAMAHINTSY",-18.85,47.4833,"Analamanga","BMOI_ANALAMAHINTSY","urban"],
            ["646-04-17706-20863","BMOI_ANALAMAHINTSY",-18.85,47.4833,"Analamanga","BMOI_ANALAMAHINTSY","urban"],
            ["646-04-17706-21313","TAN_AMBOHIMALAZA_CDMA",-18.889701,47.651512,"Analamanga","AMBOHIMALAZA_CDMA","urban"], 
            ["646-04-17706-22542","LAZAINA",-18.80733,47.5582,"Analamanga","LAZAINA","urban"],
            ["646-04-17706-22552","TAN_CITE_FRAISE",-18.855652,47.543615,"Analamanga","CITE_FRAISE","urban"], 
            ["646-04-17706-23182","ANJOMA_FIR.BETOHO",-18.815,47.7204,"Analamanga","ANJOMA_FIR.BETOHO","rural"],
            ["646-04-17706-23436","ANTSOFINONDRY",-18.8301,47.5582,"Analamanga","ANTSOFINONDRY","urban"],
            ["646-04-17706-23573","ANDRANOBEVAVA",-18.8797,47.5489,"Analamanga","ANDRANOBEVAVA","urban"],
            ["646-04-17706-23802","ANDROHIBE_ORTM",-18.86,47.5353,"Analamanga","ANDROHIBE_ORTM","urban"],
            ["646-04-17706-23891","AMBOHIJATOVO_IVANDRY",-18.87504,47.53826,"Analamanga","AMBOHIJATOVO_IVANDRY","urban"],
            ["646-04-17706-23892","AMBOHIJATOVO_IVANDRY",-18.87504,47.53826,"Analamanga","AMBOHIJATOVO_IVANDRY","urban"],
            ["646-04-17706-24352","TAN_AMBOHIMANGAKELY2",-18.76,47.56,"Analamanga","AMBOHIMANGAKELY2","urban"],
            ["646-04-17706-24541","ANOSIAVARATRA",-18.8002,47.53607,"Analamanga","ANOSIAVARATRA","urban"],
            ["646-04-17706-24703","ANTSAMPANDRANO_ILAFY",-19.5464,47.5888,"Analamanga","ANTSAMPANDRANO_ILAFY","rural"],
            ["646-04-17706-25041","AKAMASOA",-18.85813,47.65726,"Analamanga","AKAMASOA","rural"],
            ["646-04-17706-25072","TAN_CITE_FRAISE_2",-18.854637,47.54354,"Analamanga","TAN_CITE_FRAISE_2","urban"], 
            ["646-04-17706-25523","TAN_ANTSONJOBE",-18.86981,47.54282,"Analamanga","ANTSONJOBE","urban"],
            ["646-04-17706-26021","TAN_MAHATSARA",-18.913236,47.52962,"Analamanga","MAHATSARA","urban"],
            ["646-04-17706-26022","TAN_MAHATSARA",-18.913236,47.52962,"Analamanga","MAHATSARA","urban"],
            ["646-04-17706-26023","TAN_MAHATSARA",-18.913236,47.52962,"Analamanga","MAHATSARA","urban"],
            ["646-04-17706-26312","AMBOHIMANGA",-18.76,47.56,"Analamanga","AMBOHIMANGA","urban"],
            ["646-04-17706-26483","ANJEPY",-18.84013,47.70495,"Analamanga","ANJEPY","rural"],
            ["646-04-17706-26623","SABOTSY LIFE",-18.966922,47.536568,"Analamanga","SABOTSYLIFE","urban"],
            ["646-04-17707-20061","TANJOMBATO",-18.95818,47.53253,"Analamanga","TANJOMBATO","urban"],
            ["646-04-17707-20141","ALASORA",-18.9587,47.56803,"Analamanga","ALASORA","urban"],
            ["646-04-17707-20331","LOHALAMBO",-19.03581,47.5593,"Analamanga","LOHALAMBO","rural"],
            ["646-04-17707-20363","TANJ_FORELLO",-18.95672,47.518754,"Analamanga","TANJ_FORELLO","urban"],
            ["646-04-17707-20371","AMBOHIMANAMBOLA",-18.95029,47.61262,"Analamanga","AMBOHIMANAMBOLA","suburban"],
            ["646-04-17707-20373","AMBOHIMANAMBOLA",-18.95029,47.61262,"Analamanga","AMBOHIMANAMBOLA","suburban"],
            ["646-04-17707-20573","ANKARAOBATO",-18.96671,47.53572,"Analamanga","ANKARAOBATO","suburban"],
            ["646-04-17707-20881","IAVOLOHA",-19.003215,47.52235,"Analamanga","IAVOLOHA","suburban"],
            ["646-04-17707-20882","IAVOLOHA",-19.003215,47.52235,"Analamanga","IAVOLOHA","suburban"],
            ["646-04-17707-21041","ANDOHARANOFOTSY",-18.97902,47.53983,"Analamanga","ANDOHARANOFOTSY","urban"],
            ["646-04-17707-21051","ANKADY",-18.95937,47.52813,"Analamanga","ANKADY","urban"],
            ["646-04-17707-21833","MERIMANJAKA",-18.9836,47.5506,"Analamanga","MERIMANJAKA","suburban"],
            ["646-04-17707-22893","BONGATSARA",-19.03057,47.54095,"Analamanga","BONGATSARA","rural"],
            ["646-04-17707-23032","SOAVINA_ANM",-20.35216,47.1608,"Amoron'i Mania","SOAVINA","suburban"],
            ["646-04-17707-23162","TAN_AMBALAVAO",-19.09368,47.526758,"Analamanga","TAN_AMBALAVAO","urban"], 
            ["646-04-17707-23452","FORELLO2",-18.95784,47.51194,"Analamanga","TANJ_FORELLO2","urban"],
            ["646-04-17707-23621","BELAMBANANA",-18.97697,47.53974,"Analamanga","BELAMBANANA","urban"],
            ["646-04-17707-23622","BELAMBANANA",-18.97697,47.53974,"Analamanga","BELAMBANANA","urban"],
            ["646-04-17707-23862","AMBATONJARA",-18.94271,47.55781,"Analamanga","AMBATONJARA","urban"],
            ["646-04-17707-24322","TAN_AMBANY_ATSIMO",-18.966922,47.536568,"Analamanga","TAN_AMBANY_ATSIMO","urban"],
            ["646-04-17707-24581","AMBOHIJANAKA",-18.98169,47.55271,"Analamanga","AMBOHIJANAKA","urban"],
            ["646-04-17707-24583","AMBOHIJANAKA",-18.98169,47.55271,"Analamanga","AMBOHIJANAKA","urban"],
            ["646-04-17707-24711","TSIAFAHY",-19.07023,47.5565,"Analamanga","TSIAFAHY","rural"],
            ["646-04-17707-24951","ANDOHARANOFOTSY3",-18.97902,47.53983,"Analamanga","ANDOHARANOFOTSY3","urban"],
            ["646-04-17707-24952","ANDOHARANOFOTSY3",-18.97902,47.53983,"Analamanga","ANDOHARANOFOTSY3","urban"],
            ["646-04-17707-24953","ANDOHARANOFOTSY3",-18.97902,47.53983,"Analamanga","ANDOHARANOFOTSY3","urban"],
            ["646-04-17707-24992","MANDRIMENA",-18.98952,47.53262,"Analamanga","MANDRIMENA","urban"],
            ["646-04-17707-25051","TAN IFARIHY",-18.96246,47.54297,"Analamanga","TAN IFARIHY","urban"],
            ["646-04-17707-25052","TAN IFARIHY",-18.96246,47.54297,"Analamanga","TAN IFARIHY","urban"],
            ["646-04-17707-25303","MASINDRAY",-18.966922,47.536568,"Analamanga","MASINDRAY","urban"],
            ["646-04-17707-26213","VOLOTARA",-18.97859,47.52569,"Analamanga","VOLOTARA","urban"],
            ["646-04-17707-26321","ANKADY2",-18.95937,47.52813,"Analamanga","ANKADY","urban"],
            ["646-04-17707-26701","TAN ANDOHARANOFOTSY MORARANO",-18.983913,47.522708,"Analamanga","MORARANO","urban"],
            ["646-04-17709-20052","TALATAMATY",-18.8406,47.4502,"Analamanga","TALATAMATY","urban"],
            ["646-04-17709-20101","AMBOHIDRATRIMO",-18.815245,47.46153,"Analamanga","AMBOHIDRATRIMO","urban"],
            ["646-04-17709-20102","AMBOHIDRATRIMO",-18.815245,47.46153,"Analamanga","AMBOHIDRATRIMO","urban"],
            ["646-04-17709-20301","AMBOHIDROA",-18.85164,47.48596,"Analamanga","AMBOHIDROA","urban"],
            ["646-04-17709-20302","AMBOHIDROA",-18.85164,47.48596,"Analamanga","AMBOHIDROA","urban"],
            ["646-04-17709-20303","AMBOHIDROA",-18.85164,47.48596,"Analamanga","AMBOHIDROA","urban"],
            ["646-04-17709-20483","MANDROSOA",-18.822,47.4648,"Analamanga","MANDROSOA","urban"],
            ["646-04-17709-20753","ANTANETIBE",-18.6160148,47.1353,"Analamanga","ANTANETIBE","urban"], 
            ["646-04-17709-20821","AMBOHIBAO",-18.84738,47.47538,"Analamanga","AMBOHIBAO","urban"],
            ["646-04-17709-20823","AMBOHIBAO",-18.84738,47.47538,"Analamanga","AMBOHIBAO","urban"],
            ["646-04-17709-22561","ALAKAMISY_AMBOHIDRATRIMO",-18.8058,47.41922,"Analamanga","ALAKAMISY","suburban"],
            ["646-04-17709-23022","TAN_AMBOHIBAO2",-18.84714,47.475013,"Analamanga","TAN_AMBOHIBAO2","urban"],
            ["646-04-17709-23101","AMBOASARYANTAMBOLO",-18.84897,47.3172,"Analamanga","AMBOASARY","rural"],
            ["646-04-17709-23521","MAIBAHOAKA",-18.8292,47.46203,"Analamanga","MAIBAHOAKA","urban"],
            ["646-04-17709-23532","MAMORY_IVATO",-18.7969,47.4792,"Analamanga","MAMORY_IVATO","suburban"],
            ["646-04-17709-23533","MAMORY_IVATO",-18.7969,47.4792,"Analamanga","MAMORY_IVATO","suburban"],
            ["646-04-17709-23601","IVATO_TANANA",-18.7969,47.4792,"Analamanga","IVATO_TANANA","suburban"],
            ["646-04-17709-24021","IVATO_NE_900",-18.7969,47.4792,"Analamanga","IVATO_NE_900","suburban"],
            ["646-04-17709-24522","IMERINAFOVOANY",-18.84372,47.46649,"Analamanga","IMERINAFOVOANY","urban"],
            ["646-04-17709-24523","IMERINAFOVOANY",-18.84372,47.46649,"Analamanga","IMERINAFOVOANY","urban"],
            ["646-04-17709-24532","IVATO_NORD",-18.7969,47.4792,"Analamanga","IVATO_NORD","suburban"],
            ["646-04-17709-24791","AMBOHIDRATRIMO",-18.815245,47.46153,"Analamanga","AMBOHIDRATRIMO","urban"],
            ["646-04-17709-24942","FARALAZA",-18.8493,47.4529,"Analamanga","FARALAZA","urban"],
            ["646-04-17709-25021","AMBODIFASINA",-18.81066,47.51544,"Analamanga","AMBODIFASINA","urban"],
            ["646-04-17709-25082","FUTURA",-18.8487,47.4805,"Analamanga","FUTURA","urban"],
            ["646-04-17709-25391","IVATO_LIFE",-18.7969,47.4792,"Analamanga","IVATO_LIFE","suburban"],
            ["646-04-17709-25471","ALAKAMISY_SALAMA",-18.79288,47.42481,"Analamanga","ALAKAMISY","rural"],
            ["646-04-17709-26003","TAN_MORONDAVA",-20.292926,44.273274,"Analamanga","MORONDAVA","urban"],
            ["646-04-17709-26231","AMBOHIDRATRIMO ROVA",-18.81962,47.4496,"Analamanga","AMBOHIDRATRIMO","urban"],
            ["646-04-34072-5603","AN_ANTANIMENA",-18.8977,47.5227,"Analamanga","AN_ANTANIMENA","urban"],
            ["646-04-17709-26792","TANA AMBOATANY",-18.763107,47.537622,"Analamanga","TANA AMBOATANY","urban"],
            ["646-04-17709-26793","TANA AMBOATANY",-18.763107,47.537622,"Analamanga","TANA AMBOATANY","urban"],
            ["646-04-17709-65530","MANDROSOA CCI",-18.8213,47.4665,"Analamanga","MANDROSOA CCI","urban"],
            ["646-04-17710-13173","BEHENJY",-19.210778,47.48582,"Vakinankaratra","BEHENJY","rural"],
            ["646-04-17710-27013","IMERINTSIATOSIKA",-18.97867,47.32341,"Itasy","IMERINTSIATOSIKA","rural"],
            ["646-04-17710-27061","ARIVONIMAMO_COL",-19.00938,47.17453,"Itasy","ARIVONIMAMO","rural"],
            ["646-04-17710-27063","ARIVONIMAMO_COL",-19.00938,47.17453,"Itasy","ARIVONIMAMO","rural"],
            ["646-04-17710-27506","TAPANIATSIMO",-18.97867,47.32341,"Itasy","TAPANIATSIMO","rural"],
            ["646-04-17710-27602","IMERINTSIATOSIKA_2",-18.97867,47.32341,"Itasy","IMERINTSIATOSIKA","rural"],
            ["646-04-17710-27603","IMERINTSIATOSIKA_2",-18.97867,47.32341,"Itasy","IMERINTSIATOSIKA","rural"],
            ["646-04-18000-14071","ANTSAMPANIMAHAZOC2",-19.64492,47.16275,"Vakinankaratra","ANTSAMPANIMAHAZOC2","rural"],
            ["646-04-18010-43023","FANDRIANA",-20.238138,47.37437,"Amoron'i Mania","FANDRIANA","suburban"],
            ["646-04-18010-43203","MIARINAVARATRA",-20.1756,47.56745,"Amoron'i Mania","MIARINAVARATRA","rural"],
            ["646-04-18010-43441","AMBOHIMANJAKA_AMO",-20.20271,47.09596,"Amoron'i Mania","AMBOHIMANJAKA_AMO","suburban"],
            ["646-04-18010-43443","AMBOHIMANJAKA_AMO",-20.20271,47.09596,"Amoron'i Mania","AMBOHIMANJAKA_AMO","suburban"],
            ["646-04-18010-43481","FANDRIANA_DENSIF",-20.238138,47.37437,"Amoron'i Mania","FANDRIANA_DENSIF","suburban"],
            ["646-04-18010-43523","TANJONA",-18.966922,47.536568,"Analamanga","TANJONA","urban"],
            ["646-04-18020-43042","AMBALAMANAKANA",-20.74779,47.18399,"Amoron'i Mania","AMBALAMANAKANA","rural"],
            ["646-04-18020-43043","AMBALAMANAKANA",-20.74779,47.18399,"Amoron'i Mania","AMBALAMANAKANA","rural"],
            ["646-04-18020-43072","MANANDRIANA",-20.77218,47.0858,"Amoron'i Mania","MANANDRIANA","rural"],
            ["646-04-18020-43183","AMBATOMIFANONGO",-20.265216,46.92215,"Amoron'i Mania","AMBATOMIFANONGO","rural"],
            ["646-04-18020-43191","SOAVINA",-20.35216,47.1608,"Amoron'i Mania","SOAVINA","suburban"],
            ["646-04-18020-43192","SOAVINA",-20.35216,47.1608,"Amoron'i Mania","SOAVINA","suburban"],
            ["646-04-18020-43193","SOAVINA",-20.35216,47.1608,"Amoron'i Mania","SOAVINA","suburban"],
            ["646-04-18020-43451","ILAKA_CENTRE",-20.536029,47.246687,"Amoron'i Mania","ILAKA_CENTRE","suburban"],
            ["646-04-18020-43471","AMBATOFANGEHANA",-20.4977,47.0255,"Amoron'i Mania","AMBATOFANGEHANA","rural"],
            ["646-04-18020-43472","AMBATOFANGEHANA",-20.4977,47.0255,"Amoron'i Mania","AMBATOFANGEHANA","rural"],
            ["646-04-18050-10031","BELO_SIRIBIHINA",-19.710947,44.544908,"Menabe","BELO_SIRIBIHINA","rural"],
            ["646-04-18050-10032","BELO_SIRIBIHINA",-19.710947,44.544908,"Menabe","BELO_SIRIBIHINA","rural"],
            ["646-04-18050-10033","BELO_SIRIBIHINA",-19.710947,44.544908,"Menabe","BELO_SIRIBIHINA","rural"],
            ["646-04-18050-10042","MAHABO",-20.3854,44.6642,"Menabe","MAHABO","rural"],
            ["646-04-18050-10043","MAHABO",-20.3854,44.6642,"Menabe","MAHABO","rural"],
            ["646-04-38004-37794","MAHABO",-20.3854,44.6642,"Menabe","MAHABO","rural"],
            ["646-04-38004-38957","MAHABO AMPASIFASY",-20.353028,44.653787,"Menabe","MAHABO","rural"],
            ["646-04-38004-38960","MAHABO AMPASIFASY",-20.353028,44.653787,"Menabe","MAHABO","rural"],
            ["646-04-38004-38963","MAHABO AMPASIFASY",-20.353028,44.653787,"Menabe","MAHABO","rural"],
            ["646-04-38004-12","MAHABO AMPASIFASY",-20.353028,44.653787,"Menabe","MAHABO","rural"],
            ["646-04-18060-10051","MIANDRIVAZO",-19.537519,45.462402,"Menabe","MIANDRIVAZO","rural"],
            ["646-04-18050-10072","TSIMAHAVAOKELY",-20.295757,44.31496,"Menabe","TSIMAHAVAOKELY","rural"],
            ["646-04-18050-10202","ANKILIZATO",-20.409142,45.04169,"Menabe","ANKILIZATO","rural"],
            ["646-04-18050-10203","ANKILIZATO",-20.409142,45.04169,"Menabe","ANKILIZATO","rural"],
            ["646-04-18060-10191","AMBATOLAHY",-20.011591,45.527365,"Menabe","AMBATOLAHY","rural"],
            ["646-04-18060-10193","AMBATOLAHY",-20.409142,45.04169,"Menabe","AMBATOLAHY","rural"],
            ["646-04-18050-10481","MORONDAVA_SHOP",-20.292302,44.273913,"Menabe","MORONDAVA_SHOP","urban"],
            ["646-04-18050-10482","MORONDAVA_SHOP",-20.292302,44.273913,"Menabe","MORONDAVA_SHOP","urban"],
            ["646-04-418848-22","MORONDAVA_SHOP",-20.292302,44.273913,"Menabe","MORONDAVA_SHOP","urban"],
            ["646-04-418001-13","MORONDAVA",-20.292926,44.273274,"Menabe","MORONDAVA","urban"], 
            ["646-04-38004-37746","MORONDAVA",-20.292926,44.273274,"Menabe","MORONDAVA","urban"],    
            ["646-04-38004-37749","MORONDAVA",-20.292926,44.273274,"Menabe","MAROFOTOTRA","urban"],    
            ["646-04-38004-38738","MAROFOTOTRA",-20.281937,44.398029,"Menabe","MORONDAVA","urban"],             
            ["646-04-38004-38808","MORONDAVA_ANDABATOARA",-20.292926,44.273274,"Analamanga","MORONDAVA_ANDABATOARA","urban"],
            ["646-04-18050-10652","BEMANONGA",-20.28392,44.34827,"Menabe","BEMANONGA","rural"],
            ["646-04-38004-38702","BEMANONGA",-20.353028,44.653787,"Menabe","MAHABO","rural"],
            ["646-04-18050-10822","MAHABO",-20.3854,44.6642,"Menabe","MAHABO","rural"],
            ["646-04-38004-37912","ANALAIVA",-20.336352,44.498107,"Menabe","ANALAIVA","rural"],
            ["646-04-38004-37909","ANALAIVA",-20.336352,44.498107,"Menabe","ANALAIVA","rural"],
            ["646-04-38004-38844","BEZEZIKA",-20.354301,44.619154,"Menabe","BEZEZIKA","rural"],
            ["646-04-18050-10861","TSIMAHAVAOKELY_DENSIF",-20.2895,44.31582,"Menabe","TSIMAHAVAOKELY_DENSIF","suburban"],
            ["646-04-18060-10511","NAMOTSATANANA",-18.966922,47.536568,"Analamanga","NAMOTSATANANA","urban"],
            ["646-04-18070-21673","MAHITSY_CENTRE",-18.748498,47.34436,"Analamanga","MAHITSY_CENTRE","suburban"],
            ["646-04-18070-24592","MAHITSY_DENSIF",-18.748498,47.34436,"Analamanga","MAHITSY_DENSIF","suburban"],
            ["646-04-18080-13051","AMBOHIBARY",-19.621368,47.129952,"Vakinankaratra","AMBOHIBARY","urban"],
            ["646-04-18080-13052","AMBOHIBARY",-19.621368,47.129952,"Vakinankaratra","AMBOHIBARY","urban"],
            ["646-04-18080-13053","AMBOHIBARY",-19.621368,47.129952,"Vakinankaratra","AMBOHIBARY","urban"],
            ["646-04-18080-13054","AMBOHIBARY",-19.621368,47.129952,"Vakinankaratra","AMBOHIBARY","urban"],
            ["646-04-18080-13883","MORARANO_AMBATOLAMPY",-19.43265,47.48512,"Vakinankaratra","MORARANO","rural"],
            ["646-04-18080-14151","AMBATONDRADAMA",-19.5312,47.03248,"Vakinankaratra","AMBATONDRADAMA","rural"],
            ["646-04-18080-14215","MANANETIVOHITRA",-19.12854,47.3352,"Vakinankaratra","MANANETIVOHITRA","rural"],
            ["646-04-18100-13011","ABE_IVOHITRA",-19.8794,47.00564,"Vakinankaratra","IVOHITRA","urban"],
            ["646-04-18100-13012","ABE_IVOHITRA",-19.8794,47.00564,"Vakinankaratra","IVOHITRA","urban"],
            ["646-04-18100-13213","ABE_AMBOHIMENA",-19.8867,47.0418,"Vakinankaratra","Ambohimena","urban"],
            ["646-04-18100-13794","ALATSINAINY_IBITY",-20.05156,46.996,"Vakinankaratra","ALATSINAINY_IBITY","suburban"],
            ["646-04-18100-13876","ANTANAMBAO",-19.853075,47.197971,"Vakinankaratra","Antananarivo","urban"],
            ["646-04-18100-14192","ANTSOATANY",-19.7068232,47.158788,"Vakinankaratra","ANTSOATANY","urban"],
            ["646-04-18100-14193","ANTSOATANY",-19.7068232,47.158788,"Vakinankaratra","ANTSOATANY","urban"],
            ["646-04-18120-20211","MAHAMASINA",-18.919137,47.526414,"Analamanga","MAHAMASINA","urban"],
            ["646-04-18120-20251","ISOTRY",-18.90804,47.511786,"Analamanga","ISOTRY","urban"],
            ["646-04-18120-20253","ISOTRY",-18.90804,47.511786,"Analamanga","ISOTRY","urban"],
            ["646-04-18120-20311","AMPEFILOHA",-18.9128,47.516077,"Analamanga","AMPEFILOHA","urban"],
            ["646-04-18120-20313","AMPEFILOHA",-18.9128,47.516077,"Analamanga","AMPEFILOHA","urban"],
            ["646-04-18120-20691","ANKADILALANA",-18.9250004,47.528528,"Analamanga","ANKADILALANA","urban"],
            ["646-04-18120-20852","ANATIHAZO",-18.91302,47.509051,"Analamanga","ANATIHAZO","urban"],
            ["646-04-18120-20932","ANOSY",-18.915694,47.517984,"Analamanga","ANOSY","urban"],
            ["646-04-18120-20933","ANOSY",-18.915694,47.517984,"Analamanga","ANOSY","urban"],
            ["646-04-18120-21582","TAN_67HA_CDMA",-18.9051192,47.507173,"Analamanga","TAN_67HA_CDMA","urban"],
            ["646-04-18120-21771","ANOSY_2",-18.91562,47.52153,"Analamanga","ANOSY2","urban"],
            ["646-04-18120-21772","ANOSY_2",-18.91562,47.52153,"Analamanga","ANOSY2","urban"],
            ["646-04-18120-21793","67HA_EST",-18.904104,47.509641,"Analamanga","67HA_EST","urban"],
            ["646-04-18120-21813","ANDOHALO",-18.9122,47.53,"Analamanga","ANDOHALO","urban"],
            ["646-04-18120-22471","SOARANO",-18.90315,47.518782,"Analamanga","SOARANO","urban"],
            ["646-04-18120-22473","SOARANO",-18.90315,47.518782,"Analamanga","SOARANO","urban"],
            ["646-04-18120-22531","TAN_ANDAVAMAMBA",-18.91556,47.507614,"Analamanga","TAN_ANDAVAMAMBA","urban"],
            ["646-04-18120-22532","TAN_ANDAVAMAMBA",-18.91556,47.507614,"Analamanga","TAN_ANDAVAMAMBA","urban"],
            ["646-04-18120-22533","TAN_ANDAVAMAMBA",-18.91556,47.507614,"Analamanga","TAN_ANDAVAMAMBA","urban"],
            ["646-04-18120-22841","ANOSY_TVM",-18.9136,47.5272,"Analamanga","ANOSY_TVM","urban"],
            ["646-04-18120-22851","TAN_TSARALALANA_1800",-18.90652,47.521105,"Analamanga","TAN_TSARALALANA_1800","urban"],
            ["646-04-18120-22952","TAN_67_HA_SO",-18.909443,47.5064009,"Analamanga","TAN_67_HA_SO","urban"],
            ["646-04-18120-22953","TAN_67_HA_SO",-18.909443,47.5064009,"Analamanga","TAN_67_HA_SO","urban"],
            ["646-04-18120-23043","TAN 67HA NORDEST",-18.901789,47.511464,"Analamanga","TAN 67HA NORDEST","urban"],
            ["646-04-18120-23442","ANTOHODINIKA",-18.906032,47.513288,"Analamanga","ANTOHODINIKA","urban"],
            ["646-04-18120-23631","CENAM",-18.914299,47.5079847,"Analamanga","CENAM","urban"],
            ["646-04-18120-23633","CENAM",-18.914299,47.5079847,"Analamanga","CENAM","urban"],
            ["646-04-18120-23742","TAN_TSARALALANA_2",-18.905944,47.520034,"Analamanga","TAN_TSARALALANA_2","urban"],
            ["646-04-18120-23951","ANDOHATAPENAKA2",-18.903657,47.499759,"Analamanga","ANDOHATAPENAKA2","urban"],
            ["646-04-18120-23953","ANDOHATAPENAKA2",-18.903657,47.499759,"Analamanga","ANDOHATAPENAKA2","urban"],
            ["646-04-18120-24062","TAN_67HA_CENTRE",-18.906398,47.506979,"Analamanga","TAN_67HA_CENTRE","urban"],
            ["646-04-18120-24143","TAN_ISOTRY2",-18.908184,47.516268,"Analamanga","TAN_ISOTRY2","urban"],
            ["646-04-18120-24151","TAN_MAHAMASINA_1",-18.921749,47.527959,"Analamanga","TAN_MAHAMASINA_1","urban"],
            ["646-04-18120-24451","ANOSIBE",-18.9287,47.5119,"Analamanga","ANOSIBE","urban"],
            ["646-04-18120-24693","PETITE_VITESSE",-18.905538,47.518763,"Analamanga","PETITE_VITESSE","urban"],
            ["646-04-18120-24771","TAN_ANATIHAZO2",-18.9136927,47.51310,"Analamanga","TAN_ANATIHAZO2","urban"],
            ["646-04-18120-24773","TAN_ANATIHAZO2",-18.9136927,47.51310,"Analamanga","TAN_ANATIHAZO2","urban"],
            ["646-04-18120-24822","AMPASIKA",-18.91017,47.49931,"Analamanga","AMPASIKA","urban"],
            ["646-04-18120-24823","AMPASIKA",-18.91017,47.49931,"Analamanga","AMPASIKA","urban"],
            ["646-04-18120-25001","TAN_ANOSIBE_3",-18.92848,47.511857,"Analamanga","TAN_ANOSIBE_3","urban"],
            ["646-04-18120-25091","ANTSALOVANA",-18.6667,44.6167,"Analamanga","ANTSALOVANA","rural"],
            ["646-04-18120-26822","ANDOHALO TOUR",-18.9122,47.53,"Analamanga","ANDOHALO TOUR","urban"],
            ["646-04-18130-20071","TAN_TANA_FH",-18.966922,47.536568,"Analamanga","TAN_TANA_FH","urban"],
            ["646-04-18130-20072","TAN_TANA_FH",-18.966922,47.536568,"Analamanga","TAN_TANA_FH","urban"],
            ["646-04-18130-20182","SOANIERANA",-18.9399,47.52038,"Analamanga","SOANIERANA","urban"],
            ["646-04-18130-20201","ANKATSO",-18.911359,47.561472,"Analamanga","ANKATSO","urban"],
            ["646-04-18130-20202","ANKATSO",-18.911359,47.561472,"Analamanga","ANKATSO","urban"],
            ["646-04-18130-20203","ANKATSO",-18.911359,47.561472,"Analamanga","ANKATSO","urban"],
            ["646-04-18130-20562","MANDROSEZA",-18.935798,47.549026,"Analamanga","MANDROSEZA","urban"],
            ["646-04-18130-20563","MANDROSEZA",-18.935798,47.549026,"Analamanga","MANDROSEZA","urban"],
            ["646-04-18130-20581","ANOSIZATO",-18.94137,47.49527,"Analamanga","ANOSIZATO","urban"],
            ["646-04-18130-20682","ANOSIPATRANA",-18.92708,47.49709,"Analamanga","ANOSIPATRANA","urban"],
            ["646-04-18130-20692","ANKADILALANA",-18.9064,47.5283,"Analamanga","ANKADILALANA","urban"],
            ["646-04-18130-21113","ANKADIMBAHOAKA",-18.943106,47.527347,"Analamanga","ANKADIMBAHOAKA","urban"], 
            ["646-04-18130-21763","AMBOHIPO",-18.928833,47.558189,"Analamanga","AMBOHIPO","urban"],
            ["646-04-18130-22382","TAN_AMBOLOKANDRINA",-18.921825,47.56001,"Analamanga","AMBOLOKANDRINA","urban"], 
            ["646-04-18130-22521","TAN_NAMONTANA",-18.9367714,47.5148937,"Analamanga","TAN_NAMONTANA","urban"],
            ["646-04-18130-22921","TAN_ALHAMBRA",-18.9476325,47.530421,"Analamanga","TAN_ALHAMBRA","urban"],
            ["646-04-18130-23372","FASANKARANA",-18.91832,47.5219,"Analamanga","FASANKARANA","urban"],
            ["646-04-18130-23373","FASANKARANA",-18.91832,47.5219,"Analamanga","FASANKARANA","urban"],
            ["646-04-18130-23401","MANAKAMBAHINY",-18.93343,47.52963,"Analamanga","MANAKAMBAHINY","urban"],
            ["646-04-18130-23581","AMBATOROKA",-18.92578,47.54454,"Analamanga","AMBATOROKA","urban"],
            ["646-04-18130-23582","AMBATOROKA",-18.92578,47.54454,"Analamanga","AMBATOROKA","urban"],
            ["646-04-18130-23791","TAN_TSIMBAZAZA",-18.932968,47.527969,"Analamanga","TAN_TSIMBAZAZA","urban"], 
            ["646-04-18130-24003","BY_PASS_NORD",-18.95211,47.54734,"Analamanga","Antananarivo","urban"],
            ["646-04-18130-24013","FORT_VOYRON",-18.91831,47.52116,"Analamanga","FORT_VOYRON","urban"],
            ["646-04-18130-24272","TAN_AMBODIEMPONA",-18.91888,47.540766,"Analamanga","TAN_AMBODIEMPONA","urban"],
            ["646-04-18130-24473","TAN_ANDOHANIMANDROSEZA",-18.937606,47.550994,"Analamanga","Antananarivo","urban"], 
            ["646-04-18130-24512","TAN_ANTANIMENAKELY",-18.936066,47.484744,"Analamanga","TAN_ANTANIMENAKELY","urban"], 
            ["646-04-18130-25003","TAN_ANOSIBE_3",-18.922728,47.510798,"Analamanga","TAN_ANOSIBE_3","urban"], 
            ["646-04-18130-25572","TAN_TRIMETA",-18.953003,47.53518,"Analamanga","TAN_TRIMETA","urban"],
            ["646-04-18130-26733","TAN_BIBILAVA",-18.914475,47.564583,"Analamanga","TAN_BIBILAVA","urban"],
            ["646-04-18130-26753","TAN ILANIVATO3",-18.9235812,47.504575,"Analamanga","ILANIVATO3","urban"], 
            ["646-04-18140-20262","ANDRAVOANGY",-18.8956,47.53001,"Analamanga","ANDRAVOANGY","urban"],
            ["646-04-18140-20281","AMBODITSIRY",-18.8839,47.53864,"Analamanga","AMBODITSIRY","urban"],
            ["646-04-18140-20351","AMPASAPITO",-18.88999,47.549708,"Analamanga","AMPASAPITO","urban"],
            ["646-04-18140-20381","AMBONDRONA",-18.90377,47.52973,"Analamanga","AMBONDRONA","urban"],
            ["646-04-18140-20461","MAHAZO",-18.9115,47.5596,"Analamanga","MAHAZO","urban"],
            ["646-04-18140-20462","MAHAZO",-18.9115,47.5596,"Analamanga","MAHAZO","urban"],
            ["646-04-18140-20463","MAHAZO",-18.9115,47.5596,"Analamanga","MAHAZO","urban"],
            ["646-04-18140-20531","ANKADIFOTSY",-18.89669,47.52349,"Analamanga","ANKADIFOTSY","urban"],
            ["646-04-18140-21003","TAN_RADIOLA",-18.903325,47.523166,"Analamanga","TAN_RADIOLA","urban"],
            ["646-04-18140-21151","TAN_TSIAZOTAFO",-18.903191,47.524774,"Analamanga","TAN_TSIAZOTAFO","urban"], 
            ["646-04-18140-21153","TAN_TSIAZOTAFO",-18.903191,47.524774,"Analamanga","TAN_TSIAZOTAFO","urban"],
            ["646-04-18140-22451","TAN_ANALAKELY2",-18.905761,47.525565,"Analamanga","TAN_ANALAKELY2","urban"], 
            ["646-04-18140-22453","TAN_ANALAKELY2",-18.905761,47.525565,"Analamanga","TAN_ANALAKELY2","urban"],
            ["646-04-18140-23481","TAN_TSARAHONENANA",-18.900528,47.551372,"Analamanga","TAN_TSARAHONENANA","urban"], 
            ["646-04-18140-23563","TAN_AMPARIBE",-18.915218,47.524875,"Analamanga","Antananarivo","urban"],
            ["646-04-18140-24111","TAN_AMBOHIJATOVO_1",-18.913694,47.530646,"Analamanga","TAN_AMBOHIJATOVO_1","urban"],
            ["646-04-18140-24112","TAN_AMBOHIJATOVO_1",-18.913694,47.530646,"Analamanga","TAN_AMBOHIJATOVO_1","urban"],
            ["646-04-18140-24132","TAN_ANTANIMENA2",-18.89819,47.520026,"Analamanga","TAN_ANTANIMENA2","urban"],  
            ["646-04-18140-24161","TAN_NANISANA",-18.88622,47.54702267,"Analamanga","TAN_NANISANA","urban"],
            ["646-04-18140-24162","TAN_NANISANA",-18.88622,47.54702267,"Analamanga","TAN_NANISANA","urban"],
            ["646-04-18140-24303","AMBONDRONA2",-18.90435,47.52751,"Analamanga","AMBONDRONA2","urban"],
            ["646-04-18140-24461","TAN_ANTANIMENA3",-18.89608,47.52221,"Analamanga","TAN_ANTANIMENA3","urban"], 
            ["646-04-18140-24632","TAN_AMBATOMENA",-18.90782,47.522965,"Analamanga","TAN_AMBATOMENA","urban"], 
            ["646-04-18140-24861","MASAY",-18.88308,47.5266,"Analamanga","MASAY","urban"],
            ["646-04-18140-24862","MASAY",-18.88308,47.5266,"Analamanga","MASAY","urban"],
            ["646-04-18140-24923","TAN_ALOE",-18.899215,47.521367,"Analamanga","TAN_ALOE","urban"],
            ["646-04-18140-24981","TAN_SOAVIMBAHOAKA",-18.889223,47.542829,"Analamanga","TAN_SOAVIMBAHOAKA","urban"], 
            ["646-04-18140-26712","TAN ANKADITAPAKA",-18.92608,47.5303,"Analamanga","ANKADITAPAKA","urban"], 
            ["646-04-18140-26823","ANDOHALO TOUR",-18.917392,47.531932,"Analamanga","Antananarivo","urban"],
            ["646-04-19120-1311","TOLIARA_SANFILY2",-23.35,43.6667,"AtsimoAndrefana","TOLIARA_SANFILY2","urban"],
            ["646-04-19150-40132","FIANAR_MAHAMAN",-21.4536,47.0858,"HauteMatsiatra","FIANAR_MAHAMAN","urban"], 
            ["646-04-19150-40931","AMBALAKELY_2",-21.41586,47.171842,"HauteMatsiatra","AMBALAKELY","suburban"], 
            ["646-04-19150-40933","AMBALAKELY_2",-21.41586,47.171842,"HauteMatsiatra","AMBALAKELY","suburban"],
            ["646-04-19150-41073","ANDRAINJATO_DENSIF",-21.4536,47.0858,"HauteMatsiatra","ANDRAINJATO","urban"],
            ["646-04-19150-41283","FIANA BERAVINA",-21.440629,47.111441,"Haute Matsiatra","FIANABERAVINA","urban"], 
            ["646-04-19150-41475","IVOAMBA",-21.3938,47.10013,"Haute Matsiatra","IVOAMBA","suburban"],
            ["646-04-19160-45031","VANGAINDRANO",-23.350692,47.59013,"Atsimo Atsinanana","VANGAINDRANO","suburban"],
            ["646-04-19160-45032","VANGAINDRANO",-23.350692,47.59013,"Atsimo Atsinanana","VANGAINDRANO","suburban"],
            ["646-04-19160-45034","VANGAINDRANO",-23.350692,47.59013,"Atsimo Atsinanana","VANGAINDRANO","suburban"],
            ["646-04-19160-45035","VANGAINDRANO",-23.350692,47.59013,"Atsimo Atsinanana","VANGAINDRANO","suburban"],
            ["646-04-19160-45083","MATANGA",-23.524873,47.554825,"Atsimo Atsinanana","MATANGA","urban"],
            ["646-04-19160-45291","AMPASY_VANGAINDRANO",-23.351795,47.60069,"Atsimo Atsinanana","VANGAINDRANO","suburban"],
            ["646-04-19160-45351","AMPITAFA",-23.55051,47.3557,"Atsimo Atsinanana","AMPITAFA","rural"],
            ["646-04-19160-45372","VANGAINDRANO101",-23.353687,47.578546,"Atsimo Atsinanana","VANGAINDRANO","suburban"],
            ["646-04-19160-45381","MANAMBONDRO",-23.79645,47.54954,"Atsimo Atsinanana","MANAMBONDRO","rural"],
            ["646-04-19160-45382","MANAMBONDRO",-23.79645,47.54954,"Atsimo Atsinanana","MANAMBONDRO","rural"],
            ["646-04-19160-45383","MANAMBONDRO",-23.79645,47.54954,"Atsimo Atsinanana","MANAMBONDRO","rural"],
            ["646-04-19160-45401","RANOMENA",-23.422416,47.28946,"Atsimo Atsinanana","RANOMENA","rural"],
            ["646-04-19160-45402","RANOMENA",-23.422416,47.28946,"Atsimo Atsinanana","RANOMENA","rural"],
            ["646-04-19160-45501","NOSIOMBY",-23.35,47.6,"Atsimo Atsinanana","NOSIOMBY","rural"],
            ["646-04-19160-45583","VANGAINDRANO TSIATELY",-23.2865,47.65047,"Atsimo Atsinanana","VANGAINDRANO","suburban"],
            ["646-04-19180-40031","MANDALAHY",-21.25189,47.22852,"Haute Matsiatra","MANDALAHY","suburban"],
            ["646-04-19180-40033","MANDALAHY",-21.25189,47.22852,"Haute Matsiatra","MANDALAHY","suburban"],
            ["646-04-19180-40101","AMBOHIMAHASOA",-21.10687,47.21393,"Haute Matsiatra","AMBOHIMAHASOA","suburban"],
            ["646-04-19180-40102","AMBOHIMAHASOA",-21.10687,47.21393,"Haute Matsiatra","AMBOHIMAHASOA","suburban"],
            ["646-04-19180-40463","IALATSARA",-19.67515,47.45132,"Vakinankaratra","IALATSARA","suburban"],
            ["646-04-19180-40663","AMBALAKINDRESY",-21.16579,47.33684,"Haute Matsiatra","AMBALAKINDRESY","rural"],
            ["646-04-19180-40883","VOHIPOSA_TOM",-20.9882,47.16385,"Haute Matsiatra","VOHIPOSA","rural"],
            ["646-04-19180-41123","ALAKAMISY_AMBOHIMAHA",-21.319715,47.22457,"Haute Matsiatra","ALAKAMISY","rural"],
            ["646-04-19220-45011","FARAFANGANA",-22.8222,47.8261,"Analamanga","Antananarivo","urban"],
            ["646-04-19220-45012","FARAFANGANA",-22.8222,47.8261,"Analamanga","Antananarivo","urban"],
            ["646-04-19250-40421","MAHASOABE",-21.59331,47.2262,"Haute Matsiatra","MAHASOABE","rural"],
            ["646-04-19250-40733","TATAHO",-22.21487,47.96687,"Vatovavy","TATAHO","rural"],
            ["646-04-19260-40013","FIANARANTSOA_KIANJASOA",-21.4487298,47.077242,"Haute Matsiatra","FIANARANTSOA_KIANJASOA","urban"],
            ["646-04-19260-40062","FIANAR_TELMA",-21.455,47.0875,"Haute Matsiatra","FIANAR_TELMA","urban"],
            ["646-04-19260-40071","FIANAR_MICRONDE",-21.434883,47.06413,"Haute Matsiatra","FIANAR_MICRONDE","urban"],
            ["646-04-19260-40141","FIANAR_TANAMBAO",-21.4536,47.0858,"Haute Matsiatra","Tanambao","urban"],
            ["646-04-19260-40143","FIANAR_TANAMBAO",-21.4536,47.0858,"Haute Matsiatra","Tanambao","urban"],
            ["646-04-19260-40872","FIANAR_IVORY",-21.4536,47.0858,"Haute Matsiatra","Ivory","urban"],
            ["646-04-19260-41031","FIANARANTSOA_106",-21.4522,47.0864,"Haute Matsiatra","FIANARANTSOA_106","urban"],
            ["646-04-19260-41042","FIANARA101",-21.4536,47.0858,"Haute Matsiatra","FIANARA101","urban"],
            ["646-04-33008-46033","ANTANIFOTSY",-19.662271,47.328221,"Vakinankaratra","ANTANIFOTSY","urban"], 
            ["646-04-33008-46034","ANTANIFOTSY",-19.662271,47.328221,"Vakinankaratra","ANTANIFOTSY","urban"],
            ["646-04-33008-46036","ANTANIFOTSY",-19.662271,47.328221,"Vakinankaratra","ANTANIFOTSY","urban"],
            ["646-04-33008-46037","ANTANIFOTSY",-19.662271,47.328221,"Vakinankaratra","ANTANIFOTSY","urban"],
            ["646-04-33008-46046","AMBATOLAMPY",-19.38347,47.4367,"Vakinankaratra","AMBATOLAMPY","suburban"],
            ["646-04-33008-46052","AMBATOLAMPY",-19.38347,47.4367,"Vakinankaratra","AMBATOLAMPY","suburban"],
            ["646-04-33008-46063","AMBOHIBARY",-19.621368,47.129952,"Vakinankaratra","AMBOHIBARY","urban"],
            ["646-04-33008-46066","AMBOHIBARY",-19.621368,47.129952,"Vakinankaratra","AMBOHIBARY","urban"],
            ["646-04-33008-46067","AMBOHIBARY",-19.621368,47.129952,"Vakinankaratra","AMBOHIBARY","urban"],
            ["646-04-33008-46068","AMBOHIBARY",-19.621368,47.129952,"Vakinankaratra","AMBOHIBARY","urban"],
            ["646-04-33008-46069","AMBOHIBARY",-19.621368,47.129952,"Vakinankaratra","AMBOHIBARY","urban"],
            ["646-04-33008-46091","AMBATOLMP_CENTR",-19.38347,47.4367,"Vakinankaratra","AMBATOLMP_CENTR","suburban"],
            ["646-04-33008-46093","AMBATOLMP_CENTR",-19.38347,47.4367,"Vakinankaratra","AMBATOLMP_CENTR","suburban"],
            ["646-04-33008-46094","AMBATOLMP_CENTR",-19.38347,47.4367,"Vakinankaratra","AMBATOLMP_CENTR","suburban"],
            ["646-04-33008-46096","AMBATOLMP_CENTR",-19.38347,47.4367,"Vakinankaratra","AMBATOLMP_CENTR","suburban"],
            ["646-04-33008-46097","AMBATOLMP_CENTR",-19.38347,47.4367,"Vakinankaratra","AMBATOLMP_CENTR","suburban"],
            ["646-04-33008-46099","AMBATOLMP_CENTR",-19.38347,47.4367,"Vakinankaratra","AMBATOLMP_CENTR","suburban"],
            ["646-04-33008-46181","MANANDONA",-20.0618,47.06047,"Vakinankaratra","MANANDONA","suburban"],
            ["646-04-33008-46182","MANANDONA",-20.0618,47.06047,"Vakinankaratra","MANANDONA","suburban"],
            ["646-04-33008-46183","MANANDONA",-20.0618,47.06047,"Vakinankaratra","MANANDONA","suburban"],
            ["646-04-33008-46185","MANANDONA",-20.0618,47.06047,"Vakinankaratra","MANANDONA","suburban"],
            ["646-04-33008-46187","MANANDONA",-20.0618,47.06047,"Vakinankaratra","MANANDONA","suburban"],
            ["646-04-33008-46188","MANANDONA",-20.0618,47.06047,"Vakinankaratra","MANANDONA","suburban"],
            ["646-04-33008-46189","MANANDONA",-20.0618,47.06047,"Vakinankaratra","MANANDONA","suburban"],
            ["646-04-33008-46228","BETAFO",-19.84,46.8575,"Vakinankaratra","BETAFO","suburban"],
            ["646-04-33008-46231","BETAFO",-19.84,46.8575,"Vakinankaratra","BETAFO","suburban"],
            ["646-04-33008-46243","BEHENJY",-19.2106,47.48582,"Vakinankaratra","BEHENJY","rural"],
            ["646-04-33008-46247","BEHENJY",-19.2106,47.48582,"Vakinankaratra","BEHENJY","rural"],
            ["646-04-33008-46257","FARATSIHO",-19.4057,46.9498,"Vakinankaratra","FARATSIHO","rural"],
            ["646-04-33008-46263","FARATSIHO",-19.4057,46.9498,"Vakinankaratra","FARATSIHO","rural"],
            ["646-04-33008-46271","ANTSIRABE_FALY",-19.8686,47.0331,"Vakinankaratra","Mahafaly","urban"],
            ["646-04-33008-46273","ANTSIRABE_FALY",-19.8686,47.0331,"Vakinankaratra","Mahafaly","urban"],
            ["646-04-33008-46274","ANTSIRABE_FALY",-19.84196,47.038786,"Vakinankaratra","Mahafaly","urban"], 
            ["646-04-33008-46276","ANTSIRABE_FALY",-19.84196,47.038786,"Vakinankaratra","Mahafaly","urban"], 
            ["646-04-33008-46277","ANTSIRABE_FALY",-19.84196,47.038786,"Vakinankaratra","Mahafaly","urban"], 
            ["646-04-33008-46286","ANTBE_ANTSAKELY",-19.8729,47.0296,"Vakinankaratra","Antsenakely","urban"],
            ["646-04-33008-46292","ANTBE_ANTSAKELY",-19.8729,47.0296,"Vakinankaratra","Antsenakely","urban"],
            ["646-04-33008-46294","ANTBE_ANTSAKELY",-19.8729,47.0296,"Vakinankaratra","Antsenakely","urban"],
            ["646-04-33008-46302","ABE_AMBOHIMENA",-19.8867,47.0418,"Vakinankaratra","Ambohimena","urban"],
            ["646-04-33008-46305","ABE_AMBOHIMENA",-19.8867,47.0418,"Vakinankaratra","Ambohimena","urban"],
            ["646-04-33008-46318","AMBOHIMANDROSO",-19.5271,47.4295,"Vakinankaratra","AMBOHIMANDROSO","rural"],
            ["646-04-33008-46320","AMBOHIMANDROSO",-19.5271,47.4295,"Vakinankaratra","AMBOHIMANDROSO","rural"],
            ["646-04-33008-46321","AMBOHIMANDROSO",-19.5271,47.4295,"Vakinankaratra","AMBOHIMANDROSO","rural"],
            ["646-04-33008-46323","AMBOHIMANDROSO",-19.5271,47.4295,"Vakinankaratra","AMBOHIMANDROSO","rural"],
            ["646-04-33008-46362","ABE_SABOTSY",-19.8694,47.02702,"Vakinankaratra","ABE_SABOTSY","urban"],
            ["646-04-33008-46363","ABE_SABOTSY",-19.8694,47.02702,"Vakinankaratra","ABE_SABOTSY","urban"],
            ["646-04-33008-46367","ABE_SABOTSY",-19.8694,47.02702,"Vakinankaratra","ABE_SABOTSY","urban"],
            ["646-04-33008-46368","ABE_SABOTSY",-19.8694,47.02702,"Vakinankaratra","ABE_SABOTSY","urban"],
            ["646-04-33008-46369","ABE_SABOTSY",-19.8694,47.02702,"Vakinankaratra","ABE_SABOTSY","urban"],
            ["646-04-33008-46376","MANDOTO_COLLINE",-19.58309,46.2924,"Vakinankaratra","MANDOTO","rural"],
            ["646-04-33008-46377","MANDOTO_COLLINE",-19.58309,46.2924,"Vakinankaratra","MANDOTO","rural"],
            ["646-04-33008-46378","MANDOTO_COLLINE",-19.58309,46.2924,"Vakinankaratra","MANDOTO","rural"],
            ["646-04-33008-46380","MANDOTO_COLLINE",-19.58309,46.2924,"Vakinankaratra","MANDOTO","rural"],
            ["646-04-33008-46383","MANDOTO_COLLINE",-19.58309,46.2924,"Vakinankaratra","MANDOTO","rural"],
            ["646-04-33008-46384","MANDOTO_COLLINE",-19.58309,46.2924,"Vakinankaratra","MANDOTO","rural"],
            ["646-04-33008-46406","ABE_AMBALAVATO",-19.87874,47.04729,"Vakinankaratra","ABE_AMBALAVATO","urban"],
            ["646-04-33008-46408","ABE_AMBALAVATO",-19.87874,47.04729,"Vakinankaratra","ABE_AMBALAVATO","urban"],
            ["646-04-33008-46411","ABE_AMBALAVATO",-19.87874,47.04729,"Vakinankaratra","ABE_AMBALAVATO","urban"],
            ["646-04-33008-46414","ABE_AMBALAVATO",-19.87874,47.04729,"Vakinankaratra","ABE_AMBALAVATO","urban"],
            ["646-04-33008-46766","AMBATONIKOLAHY",-19.7248,46.9267,"Vakinankaratra","AMBATONIKOLAHY","rural"],
            ["646-04-33008-46772","AMBATONIKOLAHY",-19.7248,46.9267,"Vakinankaratra","AMBATONIKOLAHY","rural"],
            ["646-04-33008-46782","AMBANO",-19.7967,47.0461,"Vakinankaratra","AMBANO","urban"],
            ["646-04-33008-46783","AMBANO",-19.7967,47.0461,"Vakinankaratra","AMBANO","urban"],
            ["646-04-33008-46788","AMBANO",-19.7967,47.0461,"Vakinankaratra","AMBANO","urban"],
            ["646-04-33008-46789","AMBANO",-19.7967,47.0461,"Vakinankaratra","AMBANO","urban"],
            ["646-04-33008-46947","ANTSIRABE_VATOFOTSY",-19.840989,47.038188,"Vakinankaratra","ANTSIRABE_VATOFOTSY","suburban"], 
            ["646-04-33008-46948","ANTSIRABE_VATOFOTSY",-19.840989,47.038188,"Vakinankaratra","ANTSIRABE_VATOFOTSY","suburban"],
            ["646-04-33008-46950","ANTSIRABE_VATOFOTSY",-19.840989,47.038188,"Vakinankaratra","ANTSIRABE_VATOFOTSY","suburban"],
            ["646-04-33008-46961","ANJAZAFOTSY",-19.8246,46.8163,"Vakinankaratra","ANJAZAFOTSY","rural"],
            ["646-04-33008-46962","ANJAZAFOTSY",-19.8246,46.8163,"Vakinankaratra","ANJAZAFOTSY","rural"],
            ["646-04-33008-46964","ANJAZAFOTSY",-19.8246,46.8163,"Vakinankaratra","ANJAZAFOTSY","rural"],
            ["646-04-33008-46967","ANJAZAFOTSY",-19.8246,46.8163,"Vakinankaratra","ANJAZAFOTSY","rural"],
            ["646-04-33008-47025","MAHAIZA",-19.9061,46.80878,"Vakinankaratra","MAHAIZA","rural"],
            ["646-04-33008-47038","ANGODOGODONA",-19.09846,47.77033,"Analamanga","ANGODOGODONA","rural"],
            ["646-04-33008-47158","ANTSIRABE_LYCEE",-19.84849,47.030085,"Vakinankaratra","ANTSIRABE_LYCEE","urban"], 
            ["646-04-33008-47160","ANTSIRABE_LYCEE",-19.84849,47.030085,"Vakinankaratra","ANTSIRABE_LYCEE","urban"], 
            ["646-04-33008-47161","ANTSIRABE_LYCEE",-19.84849,47.030085,"Vakinankaratra","ANTSIRABE_LYCEE","urban"], 
            ["646-04-33008-47163","ANTSIRABE_LYCEE",-19.84849,47.030085,"Vakinankaratra","ANTSIRABE_LYCEE","urban"], 
            ["646-04-33008-47164","ANTSIRABE_LYCEE",-19.84849,47.030085,"Vakinankaratra","ANTSIRABE_LYCEE","urban"], 
            ["646-04-33008-47188","AMBATOMIADY",-19.68742,47.4277,"Vakinankaratra","AMBATOMIADY","rural"],
            ["646-04-33008-47233","ANTSIRABE_TSIVATRINIKAMO",-19.8686,47.0331,"Vakinankaratra","ANTSIRABE_TSIVATRINIKAMO","urban"],
            ["646-04-33008-47239","ANTSIRABE_TSIVATRINIKAMO",-19.8686,47.0331,"Vakinankaratra","ANTSIRABE_TSIVATRINIKAMO","urban"],
            ["646-04-33008-47246","MANDOTO_CENTRE",-19.58309,46.2924,"Vakinankaratra","MANDOTO","rural"],
            ["646-04-33008-47249","MANDOTO_CENTRE",-19.58309,46.2924,"Vakinankaratra","MANDOTO","rural"],
            ["646-04-33008-47250","MANDOTO_CENTRE",-19.58309,46.2924,"Vakinankaratra","MANDOTO","rural"],
            ["646-04-33008-47252","MANDOTO_CENTRE",-19.58309,46.2924,"Vakinankaratra","MANDOTO","rural"],
            ["646-04-33008-47253","MANDOTO_CENTRE",-19.58309,46.2924,"Vakinankaratra","MANDOTO","rural"],
            ["646-04-33008-47460","ABE_AVARATSENA",-19.86853,47.02836,"Vakinankaratra","Avaratsena","urban"],
            ["646-04-33008-47486","ABE_TOMBOARIVO",-19.8684,47.04238,"Vakinankaratra","Tomboarivo","urban"],
            ["646-04-33008-47488","ABE_TOMBOARIVO",-19.8684,47.04238,"Vakinankaratra","Tomboarivo","urban"],
            ["646-04-33008-47489","ABE_TOMBOARIVO",-19.8684,47.04238,"Vakinankaratra","Tomboarivo","urban"],
            ["646-04-33008-47492","ABE_TOMBOARIVO",-19.8684,47.04238,"Vakinankaratra","Tomboarivo","urban"],
            ["646-04-33008-47493","ABE_TOMBOARIVO",-19.8684,47.04238,"Vakinankaratra","Tomboarivo","urban"],
            ["646-04-33008-47501","ABE_MAHAZINA",-19.878903,47.037704,"Vakinankaratra","Mahazina","urban"],
            ["646-04-33008-47502","ABE_MAHAZINA",-19.878903,47.037704,"Vakinankaratra","Mahazina","urban"],
            ["646-04-33008-47504","ABE_MAHAZINA",-19.878903,47.037704,"Vakinankaratra","Mahazina","urban"],
            ["646-04-33008-47505","ABE_MAHAZINA",-19.878903,47.037704,"Vakinankaratra","Mahazina","urban"],
            ["646-04-33008-47507","ABE_MAHAZINA",-19.878903,47.037704,"Vakinankaratra","Mahazina","urban"],
            ["646-04-33008-47508","ABE_MAHAZINA",-19.878903,47.037704,"Vakinankaratra","Mahazina","urban"],
            ["646-04-33008-47582","BEAKANGA",-19.584,46.27345,"Vakinankaratra","BEAKANGA","rural"],
            ["646-04-33008-47732","AMBATOLAMPY STAR",-19.38347,47.4367,"Vakinankaratra","AMBATOLAMPY STAR","suburban"],
            ["646-04-33008-47734","AMBATOLAMPY STAR",-19.38347,47.4367,"Vakinankaratra","AMBATOLAMPY STAR","suburban"],
            ["646-04-33008-47774","ANTSOATANY",-19.7064192,47.158273,"Vakinankaratra","ANTSOATANY","urban"], 
            ["646-04-33008-47777","ANTSOATANY",-19.7064192,47.158273,"Vakinankaratra","ANTSOATANY","urban"],
            ["646-04-33008-47779","ANTSOATANY",-19.7064192,47.158273,"Vakinankaratra","ANTSOATANY","urban"],
            ["646-04-33008-47786","MANDROSOHASINA",-19.58482,47.17055,"Vakinankaratra","MANDROSOHASINA","rural"],
            ["646-04-33008-47787","MANDROSOHASINA",-19.58482,47.17055,"Vakinankaratra","MANDROSOHASINA","rural"],
            ["646-04-33008-47790","MANDROSOHASINA",-19.58482,47.17055,"Vakinankaratra","MANDROSOHASINA","rural"],
            ["646-04-33008-47792","MANDROSOHASINA",-19.58482,47.17055,"Vakinankaratra","MANDROSOHASINA","rural"],
            ["646-04-33008-47793","MANDROSOHASINA",-19.58482,47.17055,"Vakinankaratra","MANDROSOHASINA","rural"],
            ["646-04-33008-47803","MANANETIVOHITRA",-19.5451,47.33095,"Vakinankaratra","MANANETIVOHITRA","rural"],
            ["646-04-33008-47822","AMPITATAFIKA_VAK",-19.565651,47.35781,"Vakinankaratra","AMPITATAFIKA","rural"],
            ["646-04-33008-47823","AMPITATAFIKA_VAK",-19.565651,47.35781,"Vakinankaratra","AMPITATAFIKA","rural"],
            ["646-04-33010-203","KIRANOMENA",-18.2977,46.05217,"Bongolava","KIRANOMENA","rural"],
            ["646-04-33010-398","KIRANOMENA_KINOMBY",-18.2977,46.05217,"Bongolava","KIRANOMENA","rural"],
            ["646-04-33010-484","TSIROANOMANDIDY3",-18.7704,46.04859,"Bongolava","TSIROANOMANDIDY3","rural"],
            ["646-04-33010-486","TSIROANOMANDIDY3",-18.7704,46.04859,"Bongolava","TSIROANOMANDIDY3","rural"],
            ["646-04-33010-487","TSIROANOMANDIDY3",-18.7704,46.04859,"Bongolava","TSIROANOMANDIDY3","rural"],
            ["646-04-33010-667","AMPARIHITANY",-18.398939,46.06872,"Bongolava","AMPARIHITANY","urban"],
            ["646-04-33010-669","AMPARIHITANY",-18.398939,46.06872,"Bongolava","AMPARIHITANY","urban"],
            ["646-04-33010-682","TSARATANANA_BON",-18.0654415,46.320185,"Bongolava","TSARATANANA_BON","urban"],
            ["646-04-33011-16032","VANGAINDRANO",-23.350692,47.59013,"Atsimo Atsinanana","VANGAINDRANO","suburban"],
            ["646-04-33011-16035","VANGAINDRANO",-23.350692,47.59013,"Atsimo Atsinanana","VANGAINDRANO","suburban"],
            ["646-04-33011-16255","FARAFANGANA_AMBALAKINININA",-22.8222,47.8261,"Atsimo Atsinanana","AMBALAKINININA","suburban"],
            ["646-04-33011-16258","FARAFANGANA_AMBALAKINININA",-22.8222,47.8261,"Atsimo Atsinanana","AMBALAKINININA","suburban"],
            ["646-04-33011-16259","FARAFANGANA_AMBALAKINININA",-22.8222,47.8261,"Atsimo Atsinanana","AMBALAKINININA","suburban"],
            ["646-04-33011-16423","AMPASY_VANGAINDRANO",-23.351795,47.60069,"Atsimo Atsinanana","AMPASY","suburban"],
            ["646-04-33011-16425","AMPASY_VANGAINDRANO",-23.351795,47.60069,"Atsimo Atsinanana","AMPASY","suburban"],
            ["646-04-33011-16426","AMPASY_VANGAINDRANO",-23.351795,47.60069,"Atsimo Atsinanana","AMPASY","suburban"],
            ["646-04-33011-16529","FARAFANGANA101",-22.8222,47.8261,"Atsimo Atsinanana","FARAFANGANA101","suburban"],
            ["646-04-33011-16592","RANOMENA",-23.42524,47.29653,"Atsimo Atsinanana","RANOMENA","rural"],
            ["646-04-33011-61986","MASIANAKA",-23.5807,47.5842,"Atsimo Atsinanana","MASIANAKA","rural"],
            ["646-04-33012-61738","RANOMAFANA",-21.2726,47.4883,"Vatovavy","RANOMAFANA","rural"],
            ["646-04-33012-61741","RANOMAFANA",-21.2726,47.4883,"Vatovavy","RANOMAFANA","rural"],
            ["646-04-33012-61744","RANOMAFANA",-21.2726,47.4883,"Vatovavy","RANOMAFANA","rural"],
            ["646-04-33012-61889","RANOMAFANA_DENSIF",-21.2726,47.4883,"Vatovavy","RANOMAFANA_DENSIF","suburban"],
            ["646-04-33012-61890","RANOMAFANA_DENSIF",-21.2726,47.4883,"Vatovavy","RANOMAFANA_DENSIF","suburban"],
            ["646-04-33012-61891","RANOMAFANA_DENSIF",-21.2726,47.4883,"Vatovavy","RANOMAFANA_DENSIF","suburban"],
            ["646-04-33012-61892","RANOMAFANA_DENSIF",-21.2726,47.4883,"Vatovavy","RANOMAFANA_DENSIF","suburban"],
            ["646-04-33012-61893","RANOMAFANA_DENSIF",-21.2726,47.4883,"Vatovavy","RANOMAFANA_DENSIF","suburban"],
            ["646-04-33012-61896","RANOMAFANA_DENSIF",-21.2726,47.4883,"Vatovavy","RANOMAFANA_DENSIF","suburban"],
            ["646-04-33012-61924","IFANADIANA",-21.303248,47.638649,"Vatovavy","IFANADIANA","rural"],
            ["646-04-33012-61925","IFANADIANA",-21.303248,47.638649,"Vatovavy","IFANADIANA","rural"],
            ["646-04-33012-61926","IFANADIANA",-21.303248,47.638649,"Vatovavy","IFANADIANA","rural"],
            ["646-04-33012-63210","KELILALINA",-21.3052,47.5541,"Vatovavy","KELILALINA","rural"],
            ["646-04-33012-63211","KELILALINA",-21.3052,47.5541,"Vatovavy","KELILALINA","rural"],
            ["646-04-33012-63213","KELILALINA",-21.3052,47.5541,"Vatovavy","KELILALINA","rural"],
            ["646-04-33012-63216","KELILALINA",-21.3052,47.5541,"Vatovavy","KELILALINA","rural"],
            ["646-04-33012-63589","IFANADIANA TRANS",-21.30324,47.63864,"Vatovavy","IFANADIANA TRANS","suburban"],
            ["646-04-33014-1020","MHJ_TSARAMANDROSO",-15.707982,46.320903,"Boeny","MHJ_TSARAMANDROSO","suburban"], 
            ["646-04-33014-1084","ANKAZOMBORONA",-16.1001,46.6832,"Boeny","ANKAZOMBORONA","rural"],
            ["646-04-33014-1094","MHJ ANKOMY",-15.7181,46.3156,"Boeny","ANKOMY","suburban"],
            ["646-04-33014-1095","MHJ ANTANIMALANDY 2",-15.705297,46.355879,"Boeny","ANTANIMALANDY 2","urban"],
            ["646-04-33014-2096","NEW CELL",-18.9,46.8,"Boeny","NEW CELL","rural"],
            ["646-04-33014-3092","MHJ_ANDROVA",-15.7181,46.3156,"Boeny","MHJ_ANDROVA","suburban"],
            ["646-04-33014-4003","ANTANIMALANDY",-15.705297,46.355879,"Boeny","ANTANIMALANDY","urban"],
            ["646-04-33014-4005","MAROVOAY",-16.1071,46.64415,"Boeny","MAROVOAY","rural"],
            ["646-04-33014-5065","MJG_MAHAVOKY_ATSIMO",-15.70548,46.31446,"Boeny","MJG_MAHAVOKY_ATSIMO","suburban"], 
            ["646-04-33014-5066","MHJ_MAHATSINJO",-15.712693,46.33722,"Boeny","MHJ_MAHATSINJO","suburban"],
            ["646-04-33014-7014","MHJ_MAHABIBO",-15.7168628,46.318072,"Boeny","MHJ_MAHABIBO","suburban"],
            ["646-04-33014-7067","MAHAJANGA_AMBOVOALANANA",-15.719872,46.3194987,"Boeny","MAHAJANGA","suburban"],
            ["646-04-33014-8001","MHJ_LA_CORNICHE",-15.716288,46.300765,"Boeny","MHJ_LA_CORNICHE","suburban"],
            ["646-04-33014-8003","ANTANIMALANDY",-15.705297,46.355879,"Boeny","ANTANIMALANDY","urban"],
            ["646-04-33014-9075","MHJ_AMBONDRONA",-15.691765,46.340303,"Boeny","MHJ_AMBONDRONA","suburban"],
            ["646-04-33017-34035","NOSYB_CHAPELLE",-13.37607,48.22214,"DIANA","NOSYB_CHAPELLE","suburban"],
            ["646-04-33017-34038","NOSYB_CHAPELLE",-13.37607,48.22214,"DIANA","NOSYB_CHAPELLE","suburban"],
            ["646-04-33018-34052","JOFFREVILLE",-12.4935,49.20602,"DIANA","JOFFREVILLE","rural"],
            ["646-04-33018-34093","DIEGO_TANAMBAO1",-12.27834,49.28715,"DIANA","DIEGO_TANAMBAO1","urban"],
            ["646-04-33018-34152","ANIVORANO",-12.743999,49.23479,"SAVA","ANIVORANO","rural"],
            ["646-04-33018-34153","ANIVORANO",-12.743999,49.23479,"SAVA","ANIVORANO","rural"],
            ["646-04-33018-34156","ANIVORANO",-12.743999,49.23479,"SAVA","ANIVORANO","rural"],
            ["646-04-33018-34158","ANIVORANO",-12.743999,49.23479,"SAVA","ANIVORANO","rural"],
            ["646-04-33018-34159","ANIVORANO",-12.743999,49.23479,"SAVA","ANIVORANO","rural"],
            ["646-04-33018-35269","DIEG_LAZARETCUR",-12.280949,49.302342,"DIANA","DIEG_LAZARETCUR","urban"],
            ["646-04-33018-35282","DIEGO2",-12.2764,49.2917,"DIANA","DIEGO2","urban"],
            ["646-04-33018-35487","ANIVORANO2",-12.73983,49.22916,"SAVA","ANIVORANO2","rural"],
            ["646-04-34071-1208","FENONANA",-18.8667,47.4975,"Analamanga","FENONANA","urban"],
            ["646-04-34071-2481","ANKADITOHA",-18.93923,47.5309,"Analamanga","ANKADITOHA","urban"],
            ["646-04-34071-8379","TAN_TSIMBAZAZA",-18.932968,47.527969,"Analamanga","TSIMBAZAZA","urban"],
            ["646-04-34072-1065","BESARETY",-18.9007,47.5376,"Analamanga","BESARETY","urban"],
            ["646-04-34072-1416","TAN_NANISANA",-18.88622,47.54702267,"Analamanga","NANISANA","urban"],
            ["646-04-34072-1671","TAN ANKADITAPAKA",-18.92608,47.5303,"Analamanga","ANKADITAPAKA","urban"],
            ["646-04-34072-2027","FORT_DUCHESNE",-18.9089,47.5466,"Analamanga","FORT_DUCHESNE","urban"],
            ["646-04-34072-2081","ANJANAHARY",-18.89586,47.53543,"Analamanga","ANJANAHARY","urban"],
            ["646-04-34072-2429","TAN_BESARETY2",-18.900877,47.537766,"Analamanga","BESARETY2","urban"],
            ["646-04-34072-3166","AMBODIVONA",-18.8972,47.52806,"Analamanga","AMBODIVONA","urban"],
            ["646-04-34072-3551","TAN_ZITAL",-18.88509,47.52596,"Analamanga","ZITAL","urban"],
            ["646-04-34072-4028","AMBODITSIRY",-18.8886,47.5396,"Analamanga","AMBODITSIRY","urban"],
            ["646-04-34072-4035","AMPASAPITO",-18.8901,47.5502,"Analamanga","AMPASAPITO","urban"],
            ["646-04-34072-5498","TAN_SOAVIMBAHOAKA",-18.889223,47.542829,"Analamanga","SOAVIMBAHOAKA","urban"],
            ["646-04-34072-7115","TAN_TSIAZOTAFO",-18.903191,47.524774,"Analamanga","TSIAZOTAFO","urban"],
            ["646-04-34072-7460","TAN_BETONGOLO",-18.90722,47.53929,"Analamanga","BETONGOLO","urban"],
            ["646-04-34072-7486","MASAY",-18.88308,47.5266,"Analamanga","MASAY","urban"],
            ["646-04-34072-7689","TAN_NANISANA_IADIAMBOLA",-18.87671,47.562163,"Analamanga","TAN_NANISANA_IADIAMBOLA","urban"],
            ["646-04-34072-8020","ANKATSO",-18.912199,47.55825,"Analamanga","ANKATSO","urban"],
            ["646-04-34072-8429","TAN_BESARETY2",-18.900877,47.537766,"Analamanga","TAN_BESARETY2","urban"],
            ["646-04-34072-9026","ANDRAVOANGY",-18.8782,47.56302,"Analamanga","ANDRAVOANGY","urban"],
            ["646-04-34072-9035","AMPASAPITO",-18.8901,47.5502,"Analamanga","AMPASAPITO","urban"],
            ["646-04-34072-9652","TAN-ANJOHY_MOVE",-18.9178953,47.534443,"Analamanga","ANJOHY_MOVE","urban"],
            ["646-04-34073-1415","TAN_MAHAMASINA_1",-18.9186,47.5261,"Analamanga","TAN_MAHAMASINA_1","urban"],
            ["646-04-34073-2114","TAN_MAHAMASINA_CDMA",-18.9186,47.5261,"Analamanga","TAN_MAHAMASINA_CDMA","urban"],
            ["646-04-34073-3007","TAN_TANA_FH",-18.966922,47.536568,"Analamanga","TAN_TANA_FH","urban"],
            ["646-04-34073-5007","TAN_TANA_FH",-18.966922,47.536568,"Analamanga","TAN_TANA_FH","urban"],
            ["646-04-35090-21045","FOULPOINTE",-17.68154,49.51265,"Atsinanana","FOULPOINTE","suburban"],
            ["646-04-35090-21046","FOULPOINTE",-17.68154,49.51265,"Atsinanana","FOULPOINTE","suburban"],
            ["646-04-35090-21047","FOULPOINTE",-17.68154,49.51265,"Atsinanana","FOULPOINTE","suburban"],
            ["646-04-35090-21050","FOULPOINTE",-17.68154,49.51265,"Atsinanana","FOULPOINTE","suburban"],
            ["646-04-35090-22641","AMPASIMBE_ONIBE",-17.63448,49.38248,"Analanjorofo","AMPASIMBE_ONIBE","rural"],
            ["646-04-35090-22681","FOULPOINTE_2",-17.68154,49.51265,"Atsinanana","FOULPOINTE","suburban"],
            ["646-04-35090-22684","FOULPOINTE_2",-17.68154,49.51265,"Atsinanana","FOULPOINTE","suburban"],
            ["646-04-35090-22686","FOULPOINTE_2",-17.68154,49.51265,"Atsinanana","FOULPOINTE","suburban"],
            ["646-04-35093-18023","AMBALAHASINA",-16.32504,49.59211,"Analanjorofo","AMBALAHASINA","rural"],
            ["646-04-35094-16065","MANANARANORD",-16.17012,49.76386,"Analanjorofo","MANANARANORD","rural"],
            ["646-04-35094-16589","ANKOFA",-15.39436,49.64954,"Analanjorofo","ANKOFA","rural"],
            ["646-04-35094-16945","MANANARA NORD1",-16.17012,49.76386,"Analanjorofo","MANANARA NORD1","rural"],
            ["646-04-35094-16948","MANANARA NORD1",-16.17012,49.76386,"Analanjorofo","MANANARA NORD1","rural"],
            ["646-04-35094-16952","MANANARA NORD1",-16.17012,49.76386,"Analanjorofo","MANANARA NORD1","rural"],
            ["646-04-35094-16995","AMBALATELO_2",-16.17788,49.50288,"Analanjorofo","AMBALATELO_2","rural"],
            ["646-04-35094-17005","AMBODIVOANIO CA",-16.17854,49.6663,"Analanjorofo","AMBODIVOANIO CA","rural"],
            ["646-04-35094-17008","AMBODIVOANIO CA",-16.17854,49.6663,"Analanjorofo","AMBODIVOANIO CA","rural"],
            ["646-04-35094-17010","AMBODIVOANIO CA",-16.17854,49.6663,"Analanjorofo","AMBODIVOANIO CA","rural"],
            ["646-04-35094-17011","AMBODIVOANIO CA",-16.17854,49.6663,"Analanjorofo","AMBODIVOANIO CA","rural"],
            ["646-04-35094-17013","AMBODIVOANIO CA",-16.17854,49.6663,"Analanjorofo","AMBODIVOANIO CA","rural"],
            ["646-04-35094-17023","AMBALAHORAKA",-16.3296,49.57897,"Analanjorofo","AMBALAHORAKA","rural"],
            ["646-04-35094-17026","AMBALAHORAKA",-16.3296,49.57897,"Analanjorofo","AMBALAHORAKA","rural"],
            ["646-04-35094-17269","SAROMAONA",-16.14724,49.318152,"Analanjorofo","SAROMAONA","rural"],
            ["646-04-35094-17569","MANANARA4",-16.17012,49.76386,"Analanjorofo","MANANARA4","rural"],
            ["646-04-35094-17571","MANANARA4",-16.17012,49.76386,"Analanjorofo","MANANARA4","rural"],
            ["646-04-35094-18006","MANANARA NORD_5",-16.17012,49.76386,"Analanjorofo","MANANARA NORD_5","rural"],
            ["646-04-35094-18009","MANANARA NORD_5",-16.17012,49.76386,"Analanjorofo","MANANARA NORD_5","rural"],
            ["646-04-36001-1088","IAVOLOHA",-19.003215,47.52235,"Analamanga","IAVOLOHA","suburban"],
            ["646-04-36001-1505","TAN IFARIHY",-18.96246,47.54297,"Analamanga","TAN IFARIHY","urban"],
            ["646-04-36001-5316","TAN_AMBALAVAO",-19.094674,47.525563,"Analamanga","TAN_AMBALAVAO","urban"],  
            ["646-04-36002-2086","BMOI_ANALAMAHINTSY",-18.85,47.4833,"Analamanga","BMOI_ANALAMAHINTSY","urban"],
            ["646-04-36002-2417","TAN_SOAMANANDRARINY",-18.888655,47.562793,"Analamanga","TAN_SOAMANANDRARINY","urban"], 
            ["646-04-36002-3417","TAN_SOAMANANDRARINY",-18.888655,47.562793,"Analamanga","TAN_SOAMANANDRARINY","urban"], 
            ["646-04-36002-6049","ANALAMAHITSY",-18.876054,47.543496,"Analamanga","ANALAMAHITSY","urban"],
            ["646-04-36002-7086","BMOI_ANALAMAHINTSY",-18.85,47.4833,"Analamanga","BMOI_ANALAMAHINTSY","urban"],
            ["646-04-36002-7380","ANDROHIBE_ORTM",-18.86,47.5353,"Analamanga","ANDROHIBE_ORTM","urban"],
            ["646-04-36002-8008","AMBOHITRARAHABA",-18.86285,47.5483,"Analamanga","AMBOHITRARAHABA","urban"],
            ["646-04-36002-8380","ANDROHIBE_ORTM",-18.86,47.5353,"Analamanga","ANDROHIBE_ORTM","urban"],
            ["646-04-36002-9049","ANALAMAHITSY",-18.876054,47.543496,"Analamanga","ANALAMAHITSY","urban"],
            ["646-04-36003-2296","ANKORONDRANO_BNI",-18.8924,47.51974,"Analamanga","ANKORONDRANO_BNI","urban"],
            ["646-04-36003-2493","TAN_ANDRAHARO_2_OTC",-18.8789426,47.50809,"Analamanga","Antananarivo","urban"],
            ["646-04-36003-5389","AMBOHIJATOVO_IVANDRY",-18.8683,47.52891,"Analamanga","AMBOHIJATOVO_IVANDRY","urban"],
            ["646-04-36003-9375","ANDRAHARO_2_OTC",-18.8789426,47.50809,"Analamanga","ANDRAHARO_2_OTC","urban"],
            ["646-04-38001-1003","FIANARANTSOA_KIANJASOA",-21.4536,47.0858,"Haute Matsiatra","FIANARANTSOA_KIANJASOA","urban"],
            ["646-04-38001-1033","MANDALAHY",-21.21801,47.2454,"Haute Matsiatra","MANDALAHY","suburban"],
            ["646-04-38001-1036","MANDALAHY",-21.21801,47.2454,"Haute Matsiatra","MANDALAHY","suburban"],
            ["646-04-38001-1080","FIANAR_TELMA",-21.455,47.0875,"Haute Matsiatra","FIANAR_TELMA","urban"],
            ["646-04-38001-1137","AMBOHIMAHASOA",-21.10743,47.21544,"Haute Matsiatra","AMBOHIMAHASOA","suburban"],
            ["646-04-38001-1139","AMBOHIMAHASOA",-21.10743,47.21544,"Haute Matsiatra","AMBOHIMAHASOA","suburban"],
            ["646-04-38001-1140","AMBOHIMAHASOA",-21.10743,47.21544,"Haute Matsiatra","AMBOHIMAHASOA","suburban"],
            ["646-04-38001-1184","FIANAR_MAHAMAN",-21.4380096,47.0943733,"Haute Matsiatra","FIANAR_MAHAMAN","urban"],
            ["646-04-38001-1201","FIANAR_TANAMBAO",-21.454746,47.091468,"Haute Matsiatra","Tanambao","urban"],
            ["646-04-38001-1202","FIANAR_TANAMBAO",-21.454746,47.091468,"Haute Matsiatra","Tanambao","urban"],
            ["646-04-38001-1203","FIANAR_TANAMBAO",-21.454746,47.091468,"Haute Matsiatra","Tanambao","urban"],
            ["646-04-38001-1204","FIANAR_TANAMBAO",-21.454746,47.091468,"Haute Matsiatra","Tanambao","urban"],
            ["646-04-38001-1616","MAHASOABE",-21.5922,47.22414,"Haute Matsiatra","MAHASOABE","rural"],
            ["646-04-38001-1617","MAHASOABE",-21.5922,47.22414,"Haute Matsiatra","MAHASOABE","rural"],
            ["646-04-38001-1683","IALATSARA",-19.67515,47.45132,"Vakinankaratra","IALATSARA","suburban"],
            ["646-04-38001-1684","IALATSARA",-19.67515,47.45132,"Vakinankaratra","IALATSARA","suburban"],
            ["646-04-38001-1771","AMBODIRANO",-21.375444,47.14972,"Haute Matsiatra","AMBODIRANO","suburban"],
            ["646-04-38001-2089","TATAHO",-21.51139,47.162187,"Haute Matsiatra","TATAHO","rural"],
            ["646-04-38001-2115","FIANAR_MAHAMANINA2",-21.436911,47.092068,"Haute Matsiatra","FIANAR_MAHAMANINA2","urban"],
            ["646-04-38001-2127","FNR_AMPOPOKA",-21.42986,47.1195,"Haute Matsiatra","FNR_AMPOPOKA","urban"],
            ["646-04-38001-2238","FIANAR_TALATAMATY",-21.429495,47.116726,"Haute Matsiatra","FIANAR_TALATAMATY","urban"],
            ["646-04-38001-2250","FIANARANTSOA_ANDRAINJATO",-21.447656,47.112839,"Haute Matsiatra","ANDRAINJATO","urban"],
            ["646-04-38001-2252","FIANARANTSOA_ANDRAINJATO",-21.447656,47.112839,"Haute Matsiatra","ANDRAINJATO","urban"],
            ["646-04-38001-2253","FIANARANTSOA_ANDRAINJATO",-21.447656,47.112839,"Haute Matsiatra","ANDRAINJATO","urban"],
            ["646-04-38001-2295","FIANAR_IVORY",-21.44574622,47.091776,"Haute Matsiatra","Ivory","urban"],
            ["646-04-38001-2298","FIANAR_IVORY",-21.44574622,47.091776,"Haute Matsiatra","Ivory","urban"],
            ["646-04-38001-2308","VOHIPOSA_TOM",-20.9882,47.16385,"Haute Matsiatra","VOHIPOSA","rural"],
            ["646-04-38001-2310","VOHIPOSA_TOM",-20.9882,47.16385,"Haute Matsiatra","VOHIPOSA","rural"],
            ["646-04-38001-2313","VOHIPOSA_TOM",-20.9882,47.16385,"Haute Matsiatra","VOHIPOSA","rural"],
            ["646-04-38001-2314","VOHIPOSA_TOM",-20.9882,47.16385,"Haute Matsiatra","VOHIPOSA","rural"],
            ["646-04-38001-2384","AMBALAKELY_2",-21.41586,47.171842,"Haute Matsiatra","AMBALAKELY_2","suburban"],
            ["646-04-38001-2386","AMBALAKELY_2",-21.41586,47.171842,"Haute Matsiatra","AMBALAKELY_2","suburban"],
            ["646-04-38001-2534","FIANARANTSOA_106",-21.4522,47.0864,"Haute Matsiatra","FIANARANTSOA_106","urban"],
            ["646-04-38001-2537","FIANARANTSOA_106",-21.4522,47.0864,"Haute Matsiatra","FIANARANTSOA_106","urban"],
            ["646-04-38001-2579","AMBALAKELY3",-21.41586,47.171842,"Haute Matsiatra","AMBALAKELY3","suburban"],
            ["646-04-38001-2701","AMBOHIBARIHENA",-21.5581,47.2249,"Haute Matsiatra","AMBOHIBARIHENA","rural"],
            ["646-04-38001-3192","IVOAMBA",-21.3938,47.10013,"Haute Matsiatra","IVOAMBA","suburban"],
            ["646-04-38001-3195","IVOAMBA",-21.3938,47.10013,"Haute Matsiatra","IVOAMBA","suburban"],
            ["646-04-38002-25044","AMBOHIMANJAKA_AMO",-20.20271,47.09596,"Amoron'i Mania","AMBOHIMANJAKA_AMO","suburban"],
            ["646-04-38002-26001","AMBOSITRA",-20.535700,47.246040,"Amoron'i Mania","Ambositra","urban"],
            ["646-04-38002-28004","AMBALAMANAKANA",-20.74308,47.1808,"Amoron'i Mania","AMBALAMANAKANA","rural"],
            ["646-04-38002-28036","AMBOSITRA_TANAMAHALANA",-20.541406,47.255138,"Amoron'i Mania","Ambositra","urban"],
            ["646-04-38002-29008","TSARASAOTRA",-20.4397,47.19912,"Amoron'i Mania","TSARASAOTRA","suburban"],
            ["646-04-404001-12","AMBOSITRA",-20.535700,47.246040,"Amoron'i Mania","AMBOSITRA","urban"],
            ["646-04-404044-11","AMBOHIMANJAKA_AMO",-20.20271,47.09596,"Amoron'i Mania","AMBOHIMANJAKA_AMO","suburban"],
            ["646-04-406040-12","AMBALATELO",-16.1749,49.51489,"Analanjorofo","AMBALATELO","rural"],
            ["646-04-406040-13","AMBALATELO",-16.1749,49.51489,"Analanjorofo","AMBALATELO","rural"],
            ["646-04-406068-11","AMBODIVOANIO CA",-16.17863,49.6679,"Analanjorofo","AMBODIVOANIO CA","rural"],
            ["646-04-406086-11","SAROMAONA",-16.1481,49.32138,"Analanjorofo","SAROMAONA","rural"],
            ["646-04-406106-13","MANANARA4",-16.1698,49.76351,"Analanjorofo","MANANARA4","rural"],
            ["646-04-406135-41","MANANARA NORD_5",-16.1698,49.76351,"Analanjorofo","MANANARA NORD_5","rural"],
            ["646-04-407008-12","AMBOHITRARAHABA",-18.86285,47.5483,"Analamanga","AMBOHITRARAHABA","urban"],
            ["646-04-407016-42","AMBATOBE",-18.87534,47.55849,"Analamanga","AMBATOBE","urban"],
            ["646-04-407027-43","FORT_DUCHESNE",-18.9089,47.5466,"Analamanga","FORT_DUCHESNE","urban"],
            ["646-04-407028-12","AMBODITSIRY",-18.8886,47.5396,"Analamanga","AMBODITSIRY","urban"],
            ["646-04-407035-12","AMPASAPITO",-18.8901,47.5502,"Analamanga","AMPASAPITO","urban"],
            ["646-04-407035-41","AMPASAPITO",-18.8901,47.5502,"Analamanga","AMPASAPITO","urban"],
            ["646-04-407035-42","AMPASAPITO",-18.8901,47.5502,"Analamanga","AMPASAPITO","urban"],
            ["646-04-407049-12","ANALAMAHITSY",-18.876054,47.543496,"Analamanga","ANALAMAHITSY","urban"],
            ["646-04-407059-43","AMBOHIBE_ILAFY",-18.8761,47.57804,"Analamanga","AMBOHIBE_ILAFY","urban"],
            ["646-04-407071-13","TAN_AVENUE_18",-18.905343,47.523796,"Analamanga","TAN_AVENUE_18","urban"],
            ["646-04-407086-22","BMOI_ANALAMAHINTSY",-18.85,47.4833,"Analamanga","BMOI_ANALAMAHINTSY","urban"],
            ["646-04-407100-43","TAN_RADIOLA",-18.903325,47.523166,"Analamanga","Antananarivo","urban"],
            ["646-04-407178-13","TAN_ANKERANA",-18.887184,47.555253,"Analamanga","ANKERANA","urban"],
            ["646-04-407178-43","TAN_ANKERANA",-18.887184,47.555253,"Analamanga","ANKERANA","urban"],
            ["646-04-407180-11","AVARADOHA",-18.8993,47.54548,"Analamanga","AVARADOHA","urban"],
            ["646-04-407247-11","SOARANO",-18.9139,47.5244,"Analamanga","SOARANO","urban"],
            ["646-04-407287-33","AMBATOBE_3",-18.87536,47.5588,"Analamanga","AMBATOBE_3","urban"],
            ["646-04-407375-25","TAN_ANDRAHARO_2_OTC",-18.8789426,47.50809,"Analamanga","ANDRAHARO_2_OTC","urban"],
            ["646-04-407378-42","BEHORIRIKA1",-18.90012,47.52192,"Analamanga","BEHORIRIKA1","urban"],
            ["646-04-407380-41","ANDROHIBE_ORTM",-18.8602,47.5361,"Analamanga","ANDROHIBE_ORTM","urban"],
            ["646-04-407408-11","TAN_AMBATOBE_4",-18.87536,47.5588,"Analamanga","AMBATOBE_4","urban"],
            ["646-04-407415-21","TAN_MAHAMASINA_1",-18.9186,47.5261,"Analamanga","MAHAMASINA_1","urban"],
            ["646-04-407416-11","TAN_NANISANA",-18.88622,47.54702267,"Analamanga","TAN_NANISANA","urban"],
            ["646-04-407429-11","TAN_BESARETY2",-18.900877,47.537766,"Analamanga","TAN_BESARETY2","urban"],
            ["646-04-407429-12","TAN_BESARETY2",-18.900877,47.537766,"Analamanga","TAN_BESARETY2","urban"],
            ["646-04-407460-11","TAN_BETONGOLO",-18.90722,47.53929,"Analamanga","TAN_BETONGOLO","urban"],
            ["646-04-407486-11","MASAY",-18.8813,47.53839,"Analamanga","MASAY","urban"],
            ["646-04-407492-42","TAN_ALOE",-18.899215,47.521367,"Analamanga","TAN_ALOE","urban"],
            ["646-04-407498-12","TAN_SOAVIMBAHOAKA",-18.889223,47.542829,"Analamanga","TAN_SOAVIMBAHOAKA","urban"],
            ["646-04-407505-31","TAN IFARIHY",-18.96246,47.54297,"Analamanga","IFARIHY","urban"],
            ["646-04-407507-32","TAN_CITE_FRAISE_2",-18.854637,47.54354,"Analamanga","TAN_CITE_FRAISE_2","urban"],
            ["646-04-409004-22","FOULPOINTE",-17.68154,49.51265,"Atsinanana","FOULPOINTE","suburban"],
            ["646-04-409004-23","FOULPOINTE",-17.68154,49.51265,"Atsinanana","FOULPOINTE","suburban"],
            ["646-04-413002-22","DIEGO_TELMA",-12.32111,49.3047668,"DIANA","Di√©go-Suarez","urban"],
            ["646-04-413003-23","DIEGO_ARASARA",-12.2764,49.2917,"DIANA","Di√©go-Suarez","urban"],
            ["646-04-413011-22","DIEGO_TANAMBAO1",-12.27834,49.28715,"DIANA","DIEGO_TANAMBAO1","urban"],
            ["646-04-413015-13","ANIVORANO",-12.95,49.1,"SAVA","ANIVORANO","rural"],
            ["646-04-413030-12","DIEGO_MORAFENO",-12.28,49.29,"DIANA","MORAFENO","urban"],
            ["646-04-413030-23","DIEGO_MORAFENO",-12.28,49.29,"DIANA","MORAFENO","urban"],
            ["646-04-413090-23","DIEGO2",-12.2786,49.292128,"DIANA","DIEGO2","urban"],
            ["646-04-413124-21","DIEGO4",-12.2786,49.292128,"DIANA","DIEGO4","urban"],
            ["646-04-413127-13","DIEGO_BAZARIKELY",-12.34193,49.016318,"DIANA","DIEGO_BAZARIKELY","urban"],
            ["646-04-413137-12","DIEGO_CUR",-12.28086,49.30114,"DIANA","DIEGO_CUR","urban"],
            ["646-04-413137-32","DIEGO_CUR",-12.28086,49.30114,"DIANA","DIEGO_CUR","urban"],
            ["646-04-10010-64392","DIEGO_SCAMA2",-12.3147899,49.2982556,"DIANA","DIEGO_SCAMA2","urban"],
            ["646-04-416006-12","FIANAR_TELMA",-21.455,47.0875,"Haute Matsiatra","FIANAR_TELMA","urban"],
            ["646-04-416007-41","FIANAR_MICRONDE",-21.4536,47.0858,"Haute Matsiatra","FIANAR_MICRONDE","urban"],
            ["646-04-416010-11","AMBOHIMAHASOA",-21.10743,47.21544,"Haute Matsiatra","AMBOHIMAHASOA","suburban"],
            ["646-04-416014-13","FIANAR_TANAMBAO",-21.454746,47.091468,"Haute Matsiatra","Tanambao","urban"],
            ["646-04-416014-43","FIANAR_TANAMBAO",-21.454746,47.0914688,"Haute Matsiatra","Tanambao","urban"],
            ["646-04-416052-41","AMBODIRANO",-21.375444,47.14972,"Haute Matsiatra","AMBODIRANO","suburban"],
            ["646-04-416073-13","TATAHO",-21.51139,47.162187,"Haute Matsiatra","TATAHO","rural"],
            ["646-04-416079-12","ITOMBANA",-21.51139,47.162187,"Haute Matsiatra","ITOMBANA","rural"],
            ["646-04-416083-12","FIANAR_TALATAMATY",-21.429495,47.116726,"Haute Matsiatra","TALATAMATY","urban"],
            ["646-04-416087-12","FIANAR_IVORY",-21.44574622,47.091776,"Haute Matsiatra","Ivory","urban"],
            ["646-04-416093-11","AMBALAKELY_2",-21.41586,47.171842,"Haute Matsiatra","AMBALAKELY_2","suburban"],
            ["646-04-416103-11","FIANARANTSOA_106",-21.4522,47.0864,"Haute Matsiatra","FIANARANTSOA_106","urban"],
            ["646-04-416107-12","NEW CELL",-21.4451,47.0862,"Haute Matsiatra","New Cell","urban"],
            ["646-04-416107-42","NEW CELL",-21.4451,47.0862,"Haute Matsiatra","New Cell","urban"],
            ["646-04-416146-11","NEW CELL",-21.4451,47.0862,"Haute Matsiatra","New Cell","urban"],
            ["646-04-416147-12","IVOAMBA",-21.3938,47.10013,"Haute Matsiatra","IVOAMBA","suburban"],
            ["646-04-421005-12","AMBOHIBARY",-18.75,47.5,"Vakinankaratra","AMBOHIBARY","urban"],
            ["646-04-421005-42","AMBOHIBARY",-18.75,47.5,"Vakinankaratra","AMBOHIBARY","urban"],
            ["646-04-421119-11","ANTSOATANY",-19.7064192,47.158273,"Vakinankaratra","ANTSOATANY","urban"],
            ["646-04-407677-33","TAN MAROBIBY",-18.76673,46.86942,"Analamanga","TAN MAROBIBY","rural"],
            ["646-04-407655-11","ANKADIMANGA",-18.89224,47.45848,"Analamanga","ANKADIMANGA","urban"],
            ["646-04-407645-21","AN_ANDANONAHOATRA",-18.9137,47.46987,"Analamanga","AN_ANDANONAHOATRA","urban"],
            ["646-04-407182-13","TAN_AMPASIKA",-18.9034,47.49782,"Analamanga","TAN_AMPASIKA","urban"],
            ["646-04-407349-21","ITAOSY_CITE",-18.90829,47.4849,"Analamanga","ITAOSY_CITE","urban"],
            ["646-04-407009-22","AMBOHIDRAPETO",-18.90541,47.48287,"Analamanga","AMBOHIDRAPETO","urban"],
            ["646-04-407009-42","AMBOHIDRAPETO",-18.90541,47.48287,"Analamanga","AMBOHIDRAPETO","urban"],
            ["646-04-37071-1455","AMBODIAFONTSY_VILLAGE",-18.9427,47.461501,"Analamanga","AMBODIAFONTSY_VILLAGE","urban"],
            ["646-04-407455-31","AMBODIAFONTSY_VILLAGE",-18.9427,47.461501,"Analamanga","AMBODIAFONTSY_VILLAGE","urban"],
            
            // === NOUVELLES CELLULES DE VOTRE FICHIER LOG ===
            ["646-04-18080-13053","AMBOHIBARY",-19.621368,47.129952,"Vakinankaratra","AMBOHIBARY","urban"],
            ["646-04-18100-13242","ABE_MAHAZOARIVO",-19.84907,47.02928,"Vakinankaratra","Mahazoarivo","urban"],
            ["646-04-17707-24951","ANDOHARANOFOTSY3",-18.97902,47.53983,"Analamanga","ANDOHARANOFOTSY3","urban"],
            ["646-04-17707-24711","TSIAFAHY",-19.07023,47.5565,"Analamanga","TSIAFAHY","rural"],
            ["646-04-407362-31","ANTANANARIVO",-18.923516,47.532213,"Analamanga","Antananarivo","urban"],
            ["646-04-407006-12","ANTANANARIVO",-18.923516,47.532213,"Analamanga","Antananarivo","urban"],
            ["646-04-407006-22","ANTANANARIVO",-18.923516,47.532213,"Analamanga","Antananarivo","urban"],
            ["646-04-18130-24272","TAN_AMBODIEMPONA",-18.91888,47.540766,"Analamanga","TAN_AMBODIEMPONA","urban"],
            ["646-04-17707-23162","TAN_AMBALAVAO",-19.09368,47.526758,"Analamanga","TAN_AMBALAVAO","urban"],
            ["646-04-17710-13173","BEHENJY",-19.210778,47.48582,"Vakinankaratra","BEHENJY","rural"],
            ["646-04-17707-26701","TAN ANDOHARANOFOTSY MORARANO",-18.983913,47.522708,"Analamanga","MORARANO","urban"],
            ["646-04-13090-13521","AMBATONIKOLAHY",-19.7248,46.9267,"Vakinankaratra","AMBATONIKOLAHY","rural"],
            ["646-04-13090-13532","AMBANO",-19.7967,47.0461,"Vakinankaratra","AMBANO","urban"],
            ["646-04-13080-13222","ANTAKASINA",-19.49,47.73,"Vakinankaratra","ANTAKASINA","rural"],
            ["646-04-13080-13043","ANTAKASINA",-19.49,47.73,"Vakinankaratra","ANTAKASINA","rural"],
            ["646-04-13080-14161","AMBOHIBOAHANGY",-18.7866,47.5301,"Analamanga","AMBOHIBOAHANGY","urban"],
            ["646-04-17707-23622","BELAMBANANA",-18.97697,47.53974,"Analamanga","BELAMBANANA","urban"],
            ["646-04-17707-23621","BELAMBANANA",-18.97697,47.53974,"Analamanga","BELAMBANANA","urban"],
            ["646-04-17707-20061","TANJOMBATO",-18.95818,47.53253,"Analamanga","TANJOMBATO","urban"],
            ["646-04-17707-23452","FORELLO2",-18.95784,47.51194,"Analamanga","TANJ_FORELLO2","urban"],
            ["646-04-17707-21051","ANKADY",-18.95937,47.52813,"Analamanga","ANKADY","urban"],
            ["646-04-17707-22893","BONGATSARA",-19.03057,47.54095,"Analamanga","BONGATSARA","rural"],
            ["646-04-18070-21673","MAHITSY_CENTRE",-18.748498,47.34436,"Analamanga","MAHITSY_CENTRE","suburban"],
            ["646-04-18070-24592","MAHITSY_DENSIF",-18.748498,47.34436,"Analamanga","MAHITSY_DENSIF","suburban"],
            ["646-04-18070-21671","MAHITSY",-18.748,47.344,"Analamanga","MAHITSY","suburban"],
            ["646-04-17709-20101","AMBOHIDRATRIMO",-18.815245,47.46153,"Analamanga","AMBOHIDRATRIMO","urban"],
            ["646-04-17707-21041","ANDOHARANOFOTSY",-18.97902,47.53983,"Analamanga","ANDOHARANOFOTSY","urban"],
            ["646-04-17707-26321","ANKADY2",-18.95937,47.52813,"Analamanga","ANKADY","urban"],
            ["646-04-17709-22561","ALAKAMISY_AMBOHIDRATRIMO",-18.8058,47.41922,"Analamanga","ALAKAMISY","suburban"],
            ["646-04-17709-25471","ALAKAMISY_SALAMA",-18.79288,47.42481,"Analamanga","ALAKAMISY","rural"],
            ["646-04-17709-26562","AMBOHIDRATRIMO",-18.815,47.461,"Analamanga","AMBOHIDRATRIMO","urban"],
            ["646-04-13080-13033","FARATSIHO",-19.4057,46.9498,"Vakinankaratra","FARATSIHO","rural"],
            ["646-04-18100-13023","ABE_ANDRANON",-19.782761,47.11761,"Vakinankaratra","Andranomanelatra","urban"],
            ["646-04-18100-13192","ANTSOATANY",-19.7068232,47.158788,"Vakinankaratra","ANTSOATANY","urban"],
            ["646-04-18100-13191","ANTSIRABE_FALY",-19.8686,47.0331,"Vakinankaratra","Mahafaly","urban"],
            ["646-04-18100-13082","ANTSIRABE_TELMA",-19.8686,47.0331,"Vakinankaratra","Antsirabe","urban"],
            ["646-04-18100-13203","ANTBE_ANTSAKELY",-19.8729,47.0296,"Vakinankaratra","Antsenakely","urban"],
            ["646-04-18100-13241","ABE_MAHAZOARIVO",-19.84907,47.02928,"Vakinankaratra","Mahazoarivo","urban"],
            ["646-04-13090-14024","TRITRIVA",-19.9296,46.92641,"Vakinankaratra","TRITRIVA","rural"],
            ["646-04-18100-13243","ABE_MAHAZOARIVO",-19.84907,47.02928,"Vakinankaratra","Mahazoarivo","urban"],
            ["646-04-17709-20102","AMBOHIDRATRIMO",-18.815245,47.46153,"Analamanga","AMBOHIDRATRIMO","urban"],
            ["646-04-17707-24953","ANDOHARANOFOTSY3",-18.97902,47.53983,"Analamanga","ANDOHARANOFOTSY3","urban"],
            ["646-04-13080-13036","FARATSIHO",-19.4057,46.9498,"Vakinankaratra","FARATSIHO","rural"],
            ["646-04-18080-14201","MANANETIVOHITRA",-19.12854,47.3352,"Vakinankaratra","MANANETIVOHITRA","rural"],
            ["646-04-18100-13281","ABE_AMBALAVATO",-19.87874,47.04729,"Analamanga","Ambalavato","urban"],
            ["646-04-17707-24322","TAN_AMBANY_ATSIMO",-18.966922,47.536568,"Analamanga","TAN_AMBANY_ATSIMO","urban"],
            ["646-04-17707-26322","ANKADY",-18.96,47.528,"Analamanga","ANKADY","urban"],
            ["646-04-407637-32","ANTANANARIVO",-18.923516,47.532213,"Analamanga","Antananarivo","urban"],
            ["646-04-407637-21","ANTANANARIVO",-18.923516,47.532213,"Analamanga","Antananarivo","urban"],
            ["646-04-37072-7637","ANTANANARIVO",-18.923516,47.532213,"Analamanga","Antananarivo","urban"],
            ["646-04-407623-21","ANTANANARIVO",-18.923516,47.532213,"Analamanga","Antananarivo","urban"],
            ["646-04-407082-23","ANTANANARIVO",-18.923516,47.532213,"Analamanga","Antananarivo","urban"],
            ["646-04-36001-6362","ANTANANARIVO",-18.923516,47.532213,"Analamanga","Antananarivo","urban"],
            ["646-04-407105-22","ANTANANARIVO",-18.923516,47.532213,"Analamanga","Antananarivo","urban"],
            ["646-04-36001-8105","ANTANANARIVO",-18.923516,47.532213,"Analamanga","Antananarivo","urban"],
            ["646-04-415008-21","ANTANANARIVO",-18.923516,47.532213,"Analamanga","Antananarivo","urban"],
            ["646-04-38005-60568","ANTANANARIVO",-18.923516,47.532213,"Analamanga","Antananarivo","urban"],
            ["646-04-415006-22","ANTANANARIVO",-18.923516,47.532213,"Analamanga","Antananarivo","urban"],
            ["646-04-17710-27602","IMERINTSIATOSIKA_2",-18.97867,47.32341,"Itasy","IMERINTSIATOSIKA","rural"],
            ["646-04-17710-27603","IMERINTSIATOSIKA_2",-18.97867,47.32341,"Itasy","IMERINTSIATOSIKA","rural"],
            ["646-04-17710-27721","ANTSIRABE",-19.85,47.05,"Vakinankaratra","Antsirabe","urban"],
            ["646-04-17710-27061","ARIVONIMAMO_COL",-19.00938,47.17453,"Itasy","ARIVONIMAMO","rural"],
            ["646-04-17710-27063","ARIVONIMAMO_COL",-19.00938,47.17453,"Itasy","ARIVONIMAMO","rural"],
            ["646-04-415072-11","ANTANANARIVO",-18.923516,47.532213,"Analamanga","Antananarivo","urban"],
            ["646-04-38005-61551","ANTANANARIVO",-18.923516,47.532213,"Analamanga","Antananarivo","urban"],
            ["646-04-415072-13","ANTANANARIVO",-18.923516,47.532213,"Analamanga","Antananarivo","urban"]
        ];

        // =============================================
        // VARIABLES GLOBALES
        // =============================================
        let map, markers, currentTileLayer;
        let cellData = [], filteredData = [];
        let heatmapLayer = null;
        let trackingInterval = null, trackingPath = null, trackingPoints = [];
        let replayInterval = null, replayMarkers = [];
        let callHistory = [];
        let currentImportFile = null;
        let activeCircle = null;
        
        // =============================================
        // TUILES PROFESSIONNELLES
        // =============================================
        const tileLayers = {
            satellite: L.tileLayer('https://{s}.google.com/vt/lyrs=s&x={x}&y={y}&z={z}', {
                maxZoom: 20,
                subdomains: ['mt0','mt1','mt2','mt3'],
                attribution: 'Google Satellite'
            }),
            map: L.tileLayer('https://{s}.google.com/vt/lyrs=m&x={x}&y={y}&z={z}', {
                maxZoom: 20,
                subdomains: ['mt0','mt1','mt2','mt3'],
                attribution: 'Google Maps'
            }),
            terrain: L.tileLayer('https://{s}.google.com/vt/lyrs=p&x={x}&y={y}&z={z}', {
                maxZoom: 20,
                subdomains: ['mt0','mt1','mt2','mt3'],
                attribution: 'Google Terrain'
            })
        };

        // =============================================
        // FONCTION POUR AFFICHER LE CERCLE ORANGE
        // =============================================
        function showCircleOnMap(lat, lng, density) {
            if (activeCircle) {
                map.removeLayer(activeCircle);
            }
            
            let radius = 500;
            if (density === 'urban') radius = 800;
            else if (density === 'suburban') radius = 1500;
            else if (density === 'rural') radius = 3000;
            
            activeCircle = L.circle([lat, lng], {
                radius: radius,
                color: '#ff9800',
                weight: 3,
                opacity: 0.8,
                fillOpacity: 0.2,
                className: 'coverage-circle'
            }).addTo(map);
            
            // ‚úÖ Zoom automatique sur la cellule
            map.setView([lat, lng], 14);
            
            showNotification(`Zone de couverture affich√©e (rayon: ${radius}m)`, 'success');
        }

        // =============================================
        // FONCTION DE DIAGNOSTIC
        // =============================================
        function diagnosticCoordonnees() {
            console.group('üîç DIAGNOSTIC DES COORDONN√âES');
            console.log(`Total cellules: ${cellData.length}`);
            
            const regions = {};
            cellData.forEach(c => {
                regions[c.region] = (regions[c.region] || 0) + 1;
            });
            console.log('R√©partition par r√©gion:', regions);
            
            console.groupEnd();
            showNotification(`Diagnostic: ${cellData.length} cellules charg√©es`, 'info');
        }

        // =============================================
        // FONCTION D'INITIALISATION
        // =============================================
        function initApp() {
            cellData = CELLS.map(cell => ({
                id: cell[0],
                location: cell[1],
                lat: cell[2],
                lng: cell[3],
                region: cell[4],
                city: cell[5],
                density: cell[6] || 'rural',
                status: 'Actif'
            }));
            
            filteredData = [...cellData];
            
            const badge = document.querySelector('.cell-count-badge');
            if (badge) {
                badge.innerHTML = `<i class="fas fa-database"></i> ${cellData.length} CELLULES`;
            }
            
            map = L.map('map', { 
                center: [-18.9, 46.8], 
                zoom: 6,
                zoomControl: true,
                attributionControl: true
            });
            
            currentTileLayer = tileLayers.satellite;
            currentTileLayer.addTo(map);
            
            markers = L.markerClusterGroup({
                chunkedLoading: true,
                disableClusteringAtZoom: 15,
                maxClusterRadius: 60,
                iconCreateFunction: function(cluster) {
                    const count = cluster.getChildCount();
                    return L.divIcon({
                        html: `<div style="width:40px; height:40px; background:#0066cc; border:3px solid white; border-radius:50%; display:flex; align-items:center; justify-content:center; color:white; font-weight:bold; font-size:14px; box-shadow:0 0 10px rgba(0,0,0,0.5);">${count}</div>`,
                        className: 'marker-cluster',
                        iconSize: [40, 40]
                    });
                }
            });
            
            cellData.forEach(cell => {
                let color = cell.density === 'urban' ? '#0066cc' : cell.density === 'suburban' ? '#0099ff' : '#66b3ff';
                
                const marker = L.marker([cell.lat, cell.lng], {
                    icon: L.divIcon({
                        html: `<div style="width:16px; height:16px; background:${color}; border:3px solid white; border-radius:50%; box-shadow:0 0 10px rgba(0,0,0,0.5);"></div>`,
                        className: 'cell-marker',
                        iconSize: [22, 22],
                        iconAnchor: [11, 11]
                    })
                });
                
                marker.bindPopup(`
                    <div style="color:#0a1929; padding:10px; min-width:250px;">
                        <h4 style="color:#0066cc; margin:0 0 10px 0; border-bottom:1px solid #0066cc; padding-bottom:5px;">
                            <i class="fas fa-broadcast-tower"></i> ${cell.id}
                        </h4>
                        <p style="margin:5px 0;"><strong><i class="fas fa-map-marker-alt"></i> ${cell.location}</strong></p>
                        <p style="margin:5px 0;"><i class="fas fa-city"></i> ${cell.city} - ${cell.region}</p>
                        <p style="margin:5px 0;"><i class="fas fa-signal"></i> Type: ${cell.density}</p>
                        <p style="margin:5px 0;"><i class="fas fa-globe"></i> Lat: ${cell.lat.toFixed(6)}</p>
                        <p style="margin:5px 0;"><i class="fas fa-globe"></i> Lng: ${cell.lng.toFixed(6)}</p>
                        <button onclick="showCircleOnMap(${cell.lat}, ${cell.lng}, '${cell.density}')" class="circle-btn">
                            <i class="fas fa-circle"></i> Afficher zone de couverture
                        </button>
                    </div>
                `);
                
                marker.on('click', function() {
                    showCircleOnMap(cell.lat, cell.lng, cell.density);
                });
                
                markers.addLayer(marker);
            });
            
            map.addLayer(markers);
            
            const bounds = L.latLngBounds(cellData.map(c => [c.lat, c.lng]));
            map.fitBounds(bounds, { padding: [50, 50] });
            
            updateStats();
            updateCellList();
            
            callHistory = [];
            displayHistory();
            
            initEvents();
            initKeyboardShortcuts();
            
            // Initialiser le partage
            initShare();
            
            setTimeout(() => {
                showNotification(`‚úÖ ${cellData.length} cellules charg√©es - Partagez l'application avec vos coll√®gues !`, 'success');
            }, 2000);
        }

        // =============================================
        // FONCTIONS DE PARTAGE
        // =============================================
        function initShare() {
            const shareButton = document.getElementById('share-button');
            const copyButton = document.getElementById('copy-link-button');
            const qrModal = document.getElementById('qr-modal');
            const closeQr = document.getElementById('close-qr');
            
            // G√©n√©rer le QR code
            const qr = qrcode(0, 'M');
            qr.addData(window.location.href);
            qr.make();
            const qrCanvas = document.createElement('canvas');
            qrCanvas.width = 200;
            qrCanvas.height = 200;
            const ctx = qrCanvas.getContext('2d');
            const cells = qr.getModuleCount();
            const size = 200 / cells;
            
            for (let row = 0; row < cells; row++) {
                for (let col = 0; col < cells; col++) {
                    ctx.fillStyle = qr.isDark(row, col) ? '#000000' : '#ffffff';
                    ctx.fillRect(col * size, row * size, size, size);
                }
            }
            
            document.getElementById('qrcode').appendChild(qrCanvas);
            
            shareButton.addEventListener('click', () => {
                qrModal.classList.add('show');
            });
            
            copyButton.addEventListener('click', () => {
                navigator.clipboard.writeText(window.location.href);
                showNotification('Lien copi√© dans le presse-papier !', 'success');
            });
            
            closeQr.addEventListener('click', () => {
                qrModal.classList.remove('show');
            });
        }

        function updateStats() {
            document.getElementById('total-cells').textContent = cellData.length;
            
            const cities = new Set(cellData.map(c => c.city));
            document.getElementById('total-cities').textContent = cities.size;
            
            const regions = new Set(cellData.map(c => c.region));
            document.getElementById('total-regions').textContent = regions.size;
            
            document.getElementById('cell-list-count').textContent = cellData.length;
            
            setInterval(() => {
                const active = Math.floor(Math.random() * 100) + 50;
                document.getElementById('active-calls').textContent = active;
            }, 5000);
        }

        function updateCellList() {
            const container = document.getElementById('cells-container');
            if (!container) return;
            
            container.innerHTML = '';
            
            const displayCells = cellData.slice(0, 50);
            
            displayCells.forEach(cell => {
                const item = document.createElement('div');
                item.className = 'cell-item';
                item.innerHTML = `
                    <div class="cell-header">
                        <div class="cell-id">${cell.id}</div>
                        <div style="color:${cell.density === 'urban' ? '#0066cc' : cell.density === 'suburban' ? '#0099ff' : '#66b3ff'};">
                            <i class="fas fa-${cell.density === 'urban' ? 'building' : cell.density === 'suburban' ? 'home' : 'tree'}"></i>
                        </div>
                    </div>
                    <div class="cell-location">${cell.location}</div>
                    <div class="cell-tags">
                        <span class="cell-tag"><i class="fas fa-city"></i> ${cell.city}</span>
                        <span class="cell-tag"><i class="fas fa-map"></i> ${cell.region}</span>
                    </div>
                `;
                
                item.addEventListener('click', () => {
                    showCircleOnMap(cell.lat, cell.lng, cell.density);
                });
                
                container.appendChild(item);
            });
            
            if (cellData.length > 50) {
                const more = document.createElement('div');
                more.style.textAlign = 'center';
                more.style.padding = '10px';
                more.style.color = '#8bb4ff';
                more.style.fontSize = '11px';
                more.innerHTML = `... et ${cellData.length - 50} autres cellules`;
                container.appendChild(more);
            }
        }

        function initKeyboardShortcuts() {
            document.addEventListener('keydown', (e) => {
                const modal = document.getElementById('import-modal');
                
                if (modal.style.display === 'flex') {
                    if (e.key === 'Escape') {
                        e.preventDefault();
                        document.getElementById('cancel-import').click();
                    }
                    
                    if (e.key === 'Enter' && e.ctrlKey) {
                        e.preventDefault();
                        const importBtn = document.getElementById('process-import');
                        if (!importBtn.disabled) {
                            importBtn.click();
                        }
                    }
                }
                
                if (e.ctrlKey && e.key === 'i') {
                    e.preventDefault();
                    document.getElementById('import-btn').click();
                }
                
                if (e.ctrlKey && e.key === 'e') {
                    e.preventDefault();
                    document.getElementById('export-btn').click();
                }
            });
        }

        function showRural() {
            const ruralCells = cellData.filter(c => c.density === 'rural');
            if (ruralCells.length > 0) {
                const bounds = L.latLngBounds(ruralCells.map(c => [c.lat, c.lng]));
                map.fitBounds(bounds, { padding: [50, 50] });
                showNotification(`${ruralCells.length} cellules rurales affich√©es`, 'success');
            }
        }

        function toggleHeatmap() {
            if (heatmapLayer) {
                map.removeLayer(heatmapLayer);
                heatmapLayer = null;
                showNotification('Heatmap d√©sactiv√©e', 'info');
            } else {
                const heatData = cellData.map(cell => [cell.lat, cell.lng, 0.8]);
                heatmapLayer = L.heatLayer(heatData, { radius: 25, blur: 15, maxZoom: 12 }).addTo(map);
                showNotification('Heatmap activ√©e', 'success');
            }
        }

        function focusHistory() {
            document.getElementById('phone-number-input').focus();
        }

        function simulateCall() {
            if (cellData.length === 0) return;
            const cell = cellData[Math.floor(Math.random() * cellData.length)];
            
            const circle = L.circle([cell.lat, cell.lng], {
                radius: 500,
                color: '#ff5722',
                weight: 2,
                opacity: 0.8,
                fillOpacity: 0.2
            }).addTo(map);
            
            let radius = 500;
            const animate = () => {
                radius += 100;
                circle.setRadius(radius);
                if (radius < 1500) {
                    setTimeout(animate, 100);
                } else {
                    map.removeLayer(circle);
                }
            };
            animate();
            
            showNotification(`Appel simul√© sur ${cell.location}`, 'success');
        }

        function showCoverage() {
            if (cellData.length === 0) return;
            
            if (window.coverageCircles) {
                window.coverageCircles.forEach(c => map.removeLayer(c));
            }
            window.coverageCircles = [];
            
            cellData.slice(0, 50).forEach(cell => {
                const radius = cell.density === 'urban' ? 800 : cell.density === 'suburban' ? 1500 : 3000;
                const circle = L.circle([cell.lat, cell.lng], {
                    radius: radius,
                    color: '#ff9800',
                    weight: 1,
                    opacity: 0.3,
                    fillOpacity: 0.05
                }).addTo(map);
                window.coverageCircles.push(circle);
            });
            
            showNotification('Zones de couverture de 50 cellules affich√©es', 'success');
        }

        function showTrackMessage() {
            const existingMsg = document.getElementById('dynamic-track-message');
            if (existingMsg) existingMsg.remove();
            
            const messageDiv = document.createElement('div');
            messageDiv.className = 'track-message';
            messageDiv.id = 'dynamic-track-message';
            messageDiv.innerHTML = `
                <i class="fas fa-map-marked-alt"></i>
                <h3>Pas assez de points</h3>
                <p>Vous avez besoin d'au moins 2 points pour rejouer un trajet.<br>Importez d'abord des logs d'appels.</p>
                <button onclick="this.parentElement.remove()">
                    <i class="fas fa-check"></i> J'ai compris
                </button>
            `;
            document.body.appendChild(messageDiv);

            setTimeout(() => {
                const msg = document.getElementById('dynamic-track-message');
                if (msg) msg.remove();
            }, 5000);
        }

        function replayTrajet() {
            if (replayInterval) clearInterval(replayInterval);
            if (replayMarkers.length) {
                replayMarkers.forEach(m => map.removeLayer(m));
                replayMarkers = [];
            }
            
            if (callHistory.length === 0) {
                showTrackMessage();
                return;
            }
            
            const points = [];
            const callsWithCell = [];
            
            callHistory.forEach(call => {
                const cell = cellData.find(c => c.id === call.cellId);
                if (cell) {
                    points.push([cell.lat, cell.lng]);
                    callsWithCell.push(call);
                }
            });
            
            if (points.length < 2) {
                showTrackMessage();
                return;
            }
            
            const path = L.polyline(points, { color: '#9c27b0', weight: 4, opacity: 0.8 }).addTo(map);
            replayMarkers.push(path);
            
            points.forEach((point, index) => {
                const marker = L.marker(point, {
                    icon: L.divIcon({
                        html: `<div style="width:20px; height:20px; background:#9c27b0; border:2px solid white; border-radius:50%; display:flex; align-items:center; justify-content:center; color:white; font-size:10px; font-weight:bold;">${index + 1}</div>`,
                        iconSize: [24, 24]
                    })
                }).addTo(map);
                replayMarkers.push(marker);
            });
            
            let index = 0;
            const liveInfo = document.getElementById('live-call-info');
            liveInfo.style.display = 'block';
            
            const animateMarker = L.marker(points[0], {
                icon: L.divIcon({
                    html: `<div style="width:30px; height:30px; background:#ff9800; border:3px solid white; border-radius:50%; animation:pulse 1s infinite; display:flex; align-items:center; justify-content:center; color:white; font-size:12px;"><i class="fas fa-phone"></i></div>`,
                    iconSize: [36, 36]
                })
            }).addTo(map);
            replayMarkers.push(animateMarker);
            
            replayInterval = setInterval(() => {
                index++;
                if (index >= points.length) {
                    clearInterval(replayInterval);
                    liveInfo.style.display = 'none';
                    showNotification('Trajet rejou√© avec succ√®s!', 'success');
                    return;
                }
                animateMarker.setLatLng(points[index]);
                map.panTo(points[index]);
                
                const call = callsWithCell[index];
                liveInfo.innerHTML = `
                    <div style="display:flex; align-items:center; gap:10px;">
                        <i class="fas fa-phone" style="color:#ff9800;"></i>
                        <div>
                            <strong>Appel ${index + 1}/${points.length}</strong><br>
                            <span>${call.date} ${call.time} - ${call.number}</span>
                        </div>
                    </div>
                `;
            }, 2000);
        }

        function changeView(viewType) {
            if (currentTileLayer) map.removeLayer(currentTileLayer);
            currentTileLayer = tileLayers[viewType];
            currentTileLayer.addTo(map);
            
            document.querySelectorAll('.view-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.view-selector-btn').forEach(btn => btn.classList.remove('active'));
            
            document.querySelector(`.view-btn[data-view="${viewType}"]`).classList.add('active');
            document.getElementById(`view-${viewType}`).classList.add('active');
            
            const viewNames = {
                'satellite': 'Google Satellite',
                'map': 'Google Maps',
                'terrain': 'Google Terrain'
            };
            
            showNotification(`Vue ${viewNames[viewType]} activ√©e`, 'success');
        }

        function startTracking() {
            if (trackingInterval) {
                showNotification('Tracking d√©j√† en cours', 'warning');
                return;
            }
            
            trackingPath = L.polyline([], { color: '#ff9800', weight: 3, opacity: 0.7 }).addTo(map);
            trackingPoints = [];
            
            trackingInterval = setInterval(() => {
                if (cellData.length === 0) return;
                const cell = cellData[Math.floor(Math.random() * cellData.length)];
                trackingPoints.push([cell.lat, cell.lng]);
                if (trackingPoints.length > 50) trackingPoints.shift();
                trackingPath.setLatLngs(trackingPoints);
            }, 2000);
            
            showNotification('Tracking d√©marr√©', 'success');
        }

        function stopTracking() {
            if (trackingInterval) {
                clearInterval(trackingInterval);
                trackingInterval = null;
                showNotification('Tracking arr√™t√©', 'info');
            }
        }

        function clearTracking() {
            stopTracking();
            if (trackingPath) {
                map.removeLayer(trackingPath);
                trackingPath = null;
            }
            trackingPoints = [];
            showNotification('Tracking effac√©', 'info');
        }

        function displayHistory() {
            const list = document.getElementById('history-list');
            list.innerHTML = '';
            
            const displayCalls = callHistory.slice(0, 50);
            
            displayCalls.forEach((call, index) => {
                const cell = cellData.find(c => c.id === call.cellId) || { 
                    location: 'Cellule inconnue', 
                    city: '', 
                    region: '' 
                };
                
                const item = document.createElement('div');
                item.className = 'history-item';
                item.innerHTML = `
                    <div class="history-header">
                        <div class="history-id">#${index + 1}</div>
                        <div style="color:#9c27b0;">
                            <i class="fas fa-phone"></i> ${call.duration}s
                        </div>
                    </div>
                    <div class="history-location">
                        <i class="fas fa-map-marker-alt"></i> ${cell.location}
                    </div>
                    <div class="history-tags">
                        <span class="history-tag"><i class="fas fa-calendar"></i> ${call.date}</span>
                        <span class="history-tag"><i class="fas fa-clock"></i> ${call.time}</span>
                        <span class="history-tag"><i class="fas fa-phone"></i> ${call.number}</span>
                        <span class="history-tag"><i class="fas fa-microchip"></i> ${call.cellId}</span>
                        <span class="history-tag"><i class="fas fa-exchange-alt"></i> ${call.flux || 'inconnu'}</span>
                    </div>
                `;
                
                item.addEventListener('click', () => {
                    const cell = cellData.find(c => c.id === call.cellId);
                    if (cell) {
                        showCircleOnMap(cell.lat, cell.lng, cell.density);
                    } else {
                        showNotification('Cellule non trouv√©e dans la base', 'warning');
                    }
                });
                
                list.appendChild(item);
            });
            
            if (callHistory.length > 50) {
                const more = document.createElement('div');
                more.style.textAlign = 'center';
                more.style.padding = '10px';
                more.style.color = '#9c27b0';
                more.style.fontSize = '11px';
                more.innerHTML = `... et ${callHistory.length - 50} autres appels`;
                list.appendChild(more);
            }
            
            document.getElementById('history-count').textContent = callHistory.length;
            document.getElementById('found-calls').textContent = callHistory.length;
        }

        function searchHistory() {
            const number = document.getElementById('phone-number-input').value.trim();
            const startDate = document.getElementById('history-date-start').value;
            const endDate = document.getElementById('history-date-end').value;
            
            let filtered = callHistory;
            
            if (number) {
                filtered = filtered.filter(call => call.number.includes(number));
            }
            
            if (startDate) {
                filtered = filtered.filter(call => call.date >= startDate);
            }
            
            if (endDate) {
                filtered = filtered.filter(call => call.date <= endDate);
            }
            
            const list = document.getElementById('history-list');
            list.innerHTML = '';
            
            filtered.slice(0, 50).forEach((call, index) => {
                const cell = cellData.find(c => c.id === call.cellId) || { 
                    location: 'Cellule inconnue', 
                    city: '', 
                    region: '' 
                };
                
                const item = document.createElement('div');
                item.className = 'history-item';
                item.innerHTML = `
                    <div class="history-header">
                        <div class="history-id">#${index + 1}</div>
                        <div style="color:#9c27b0;">
                            <i class="fas fa-phone"></i> ${call.duration}s
                        </div>
                    </div>
                    <div class="history-location">
                        <i class="fas fa-map-marker-alt"></i> ${cell.location}
                    </div>
                    <div class="history-tags">
                        <span class="history-tag"><i class="fas fa-calendar"></i> ${call.date}</span>
                        <span class="history-tag"><i class="fas fa-clock"></i> ${call.time}</span>
                        <span class="history-tag"><i class="fas fa-phone"></i> ${call.number}</span>
                        <span class="history-tag"><i class="fas fa-microchip"></i> ${call.cellId}</span>
                        <span class="history-tag"><i class="fas fa-exchange-alt"></i> ${call.flux || 'inconnu'}</span>
                    </div>
                `;
                
                item.addEventListener('click', () => {
                    const cell = cellData.find(c => c.id === call.cellId);
                    if (cell) {
                        showCircleOnMap(cell.lat, cell.lng, cell.density);
                    }
                });
                
                list.appendChild(item);
            });
            
            if (filtered.length > 50) {
                const more = document.createElement('div');
                more.style.textAlign = 'center';
                more.style.padding = '10px';
                more.style.color = '#9c27b0';
                more.style.fontSize = '11px';
                more.innerHTML = `... et ${filtered.length - 50} autres appels`;
                list.appendChild(more);
            }
            
            document.getElementById('found-calls').textContent = filtered.length;
            
            showNotification(`${filtered.length} appels trouv√©s`, 'info');
        }

        function clearHistory() {
            if (replayInterval) clearInterval(replayInterval);
            if (replayMarkers.length) {
                replayMarkers.forEach(m => {
                    if (m) map.removeLayer(m);
                });
                replayMarkers = [];
            }
            document.getElementById('live-call-info').style.display = 'none';
            callHistory = [];
            displayHistory();
            showNotification('Historique effac√©', 'info');
        }

        function exportHistory() {
            if (callHistory.length === 0) {
                showNotification('Aucun historique √† exporter', 'warning');
                return;
            }
            
            const csvContent = [
                ['Flux_appel', 'Data_type', 'daytime', 'duree_en_sec', 'num_a', 'CellId'],
                ...callHistory.map(call => [
                    call.flux || 'Entrant', 
                    call.data_type || 'SMS', 
                    `${call.date} ${call.time}`, 
                    call.duration, 
                    call.number.replace('+261', ''), 
                    call.cellId
                ])
            ].map(row => row.join(',')).join('\n');
            
            const blob = new Blob([csvContent], { type: 'text/csv' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `logs_afera_${new Date().toISOString().split('T')[0]}.csv`;
            a.click();
            
            showNotification('Historique export√© au format Afera', 'success');
        }

        // =============================================
        // IMPORT LOGS - VERSION CORRIG√âE POUR TOUS FORMATS
        // =============================================
        function initLogsModal() {
            const modal = document.getElementById('import-logs-modal');
            const fileInput = document.getElementById('logs-file-input');
            const dropArea = document.getElementById('logs-drop-area');
            const cancelBtn = document.getElementById('cancel-logs-import');
            const processBtn = document.getElementById('process-logs-import');
            const importBtn = document.getElementById('import-logs-btn');
            
            importBtn.addEventListener('click', () => {
                modal.style.display = 'flex';
                document.getElementById('logs-file-info').style.display = 'none';
                document.getElementById('logs-preview').style.display = 'none';
                processBtn.disabled = true;
            });
            
            cancelBtn.addEventListener('click', () => modal.style.display = 'none');
            
            dropArea.addEventListener('click', () => fileInput.click());
            
            fileInput.addEventListener('change', (e) => {
                const file = e.target.files[0];
                if (file && file.name.endsWith('.csv')) {
                    document.getElementById('logs-file-info').innerHTML = `<i class="fas fa-file-csv"></i> ${file.name} (${(file.size / 1024).toFixed(2)} KB)`;
                    document.getElementById('logs-file-info').style.display = 'block';
                    
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        const lines = e.target.result.split('\n').slice(0, 5);
                        let html = '<table class="preview-table">';
                        lines.forEach((line, i) => {
                            if (line.trim()) {
                                html += '<tr>';
                                line.split(',').forEach(cell => {
                                    if (i === 0) {
                                        html += `<th>${cell}</th>`;
                                    } else {
                                        html += `<td>${cell}</td>`;
                                    }
                                });
                                html += '</tr>';
                            }
                        });
                        html += '</table>';
                        document.getElementById('logs-preview').innerHTML = html;
                        document.getElementById('logs-preview').style.display = 'block';
                    };
                    reader.readAsText(file);
                    
                    processBtn.disabled = false;
                }
            });
            
            processBtn.addEventListener('click', () => {
                const file = fileInput.files[0];
                if (!file) return;
                
                const reader = new FileReader();
                reader.onload = (e) => {
                    const lines = e.target.result.split('\n').filter(l => l.trim());
                    const newCalls = [];
                    
                    // Lire l'en-t√™te pour d√©tecter le format
                    const header = lines[0].toLowerCase();
                    
                    for (let i = 1; i < lines.length; i++) {
                        const vals = lines[i].split(',').map(v => v.trim().replace(/"/g, ''));
                        
                        if (vals.length >= 6) {
                            // Format Afera standard: Flux_appel,Data_type,daytime,duree_en_sec,num_a,CellId
                            const flux = vals[0];
                            const dataType = vals[1];
                            const datetime = vals[2];
                            const [date, time] = datetime.split(' ');
                            const duration = parseInt(vals[3]) || 0;
                            let number = vals[4];
                            let cellId = vals[5];
                            
                            // üî• NETTOYAGE DU CELL ID - Pour tous les cas
                            // Enlever +261, 261, etc. s'ils sont coll√©s devant
                            if (cellId) {
                                // Si le cellId commence par +261, l'enlever
                                if (cellId.startsWith('+261')) {
                                    cellId = cellId.substring(4);
                                }
                                // Si le cellId commence par 261, l'enlever
                                else if (cellId.startsWith('261')) {
                                    cellId = cellId.substring(3);
                                }
                                // Si le cellId commence par 0, l'enlever (cas rare)
                                else if (cellId.startsWith('0') && cellId.length > 1) {
                                    cellId = cellId.substring(1);
                                }
                            }
                            
                            // Formater le num√©ro de t√©l√©phone
                            if (number && !number.startsWith('+')) {
                                if (number.startsWith('0')) {
                                    number = '+261' + number.substring(1);
                                } else {
                                    number = '+261' + number;
                                }
                            }
                            
                            newCalls.push({
                                flux: flux,
                                data_type: dataType,
                                date: date,
                                time: time,
                                number: number,
                                cellId: cellId,
                                duration: duration,
                                type: flux
                            });
                        }
                    }
                    
                    if (newCalls.length > 0) {
                        callHistory = newCalls;
                        displayHistory();
                        
                        // Compter combien de cellules sont reconnues
                        const recognizedCount = newCalls.filter(c => 
                            cellData.some(cell => cell.id === c.cellId)
                        ).length;
                        
                        showNotification(
                            `${newCalls.length} logs import√©s - ${recognizedCount} cellules reconnues sur ${cellData.length} dans la base`, 
                            recognizedCount > 0 ? 'success' : 'warning'
                        );
                    } else {
                        showNotification('Aucun log valide trouv√© dans le fichier', 'error');
                    }
                    
                    modal.style.display = 'none';
                };
                reader.readAsText(file);
            });
        }

        function initImportModal() {
            const modal = document.getElementById('import-modal');
            const fileInput = document.getElementById('file-input');
            const fileDropArea = document.getElementById('file-drop-area');
            const cancelBtn = document.getElementById('cancel-import');
            const processBtn = document.getElementById('process-import');
            const importBtn = document.getElementById('import-btn');
            
            importBtn.addEventListener('click', () => {
                modal.style.display = 'flex';
                resetImportModal();
            });
            
            cancelBtn.addEventListener('click', () => {
                modal.style.display = 'none';
                currentImportFile = null;
            });
            
            ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(event => {
                fileDropArea.addEventListener(event, (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                });
            });
            
            ['dragenter', 'dragover'].forEach(event => {
                fileDropArea.addEventListener(event, () => fileDropArea.classList.add('drag-over'));
            });
            
            ['dragleave', 'drop'].forEach(event => {
                fileDropArea.addEventListener(event, () => fileDropArea.classList.remove('drag-over'));
            });
            
            fileDropArea.addEventListener('drop', (e) => {
                const file = e.dataTransfer.files[0];
                if (file && file.name.endsWith('.csv')) handleImportFile(file);
            });
            
            fileDropArea.addEventListener('click', () => fileInput.click());
            
            fileInput.addEventListener('change', (e) => {
                const file = e.target.files[0];
                if (file) handleImportFile(file);
            });
            
            processBtn.addEventListener('click', () => {
                if (currentImportFile) {
                    processImportFile(currentImportFile);
                }
            });
        }

        function resetImportModal() {
            document.getElementById('file-input').value = '';
            document.getElementById('file-info').style.display = 'none';
            document.getElementById('import-options').style.display = 'none';
            document.getElementById('preview-section').style.display = 'none';
            document.getElementById('import-progress').style.display = 'none';
            document.getElementById('process-import').disabled = true;
            currentImportFile = null;
        }

        function handleImportFile(file) {
            currentImportFile = file;
            document.getElementById('file-name').textContent = file.name;
            document.getElementById('file-size').textContent = `(${(file.size / 1024).toFixed(2)} KB)`;
            document.getElementById('file-info').style.display = 'block';
            document.getElementById('import-options').style.display = 'block';
            document.getElementById('process-import').disabled = false;
            
            const reader = new FileReader();
            reader.onload = (e) => {
                const lines = e.target.result.split('\n').slice(0, 6);
                let html = '<table class="preview-table">';
                lines.forEach((line, i) => {
                    html += '<tr>';
                    line.split(',').forEach(cell => {
                        if (i === 0) {
                            html += `<th>${cell}</th>`;
                        } else {
                            html += `<td>${cell}</td>`;
                        }
                    });
                    html += '</tr>';
                });
                html += '</table>';
                document.getElementById('data-preview').innerHTML = html;
                document.getElementById('preview-section').style.display = 'block';
            };
            reader.readAsText(file);
        }

        function processImportFile(file) {
            const progress = document.getElementById('import-progress');
            const progressBar = document.getElementById('import-progress-bar');
            const percent = document.getElementById('import-percent');
            const status = document.getElementById('import-status');
            const replaceData = document.getElementById('replace-data').checked;
            
            progress.style.display = 'block';
            progressBar.style.width = '30%';
            percent.textContent = '30%';
            status.textContent = 'Lecture...';
            
            const reader = new FileReader();
            reader.onload = (e) => {
                const lines = e.target.result.split('\n').filter(l => l.trim());
                const newCells = [];
                
                for (let i = 1; i < lines.length; i++) {
                    const vals = lines[i].split(',').map(v => v.trim());
                    if (vals.length < 6) continue;
                    
                    const lat = parseFloat(vals[2]);
                    const lng = parseFloat(vals[3]);
                    if (isNaN(lat) || isNaN(lng)) continue;
                    
                    newCells.push({
                        id: vals[0],
                        location: vals[1],
                        lat: lat,
                        lng: lng,
                        region: vals[4],
                        city: vals[5],
                        density: vals[6] || 'rural',
                        status: 'Actif'
                    });
                }
                
                progressBar.style.width = '70%';
                percent.textContent = '70%';
                status.textContent = `Ajout de ${newCells.length} cellules...`;
                
                if (replaceData) {
                    cellData = newCells;
                } else {
                    const existingIds = new Set(cellData.map(c => c.id));
                    const uniqueNewCells = newCells.filter(c => !existingIds.has(c.id));
                    cellData = cellData.concat(uniqueNewCells);
                }
                
                filteredData = [...cellData];
                
                map.removeLayer(markers);
                markers = L.markerClusterGroup();
                cellData.forEach(cell => {
                    let color = cell.density === 'urban' ? '#0066cc' : cell.density === 'suburban' ? '#0099ff' : '#66b3ff';
                    const marker = L.marker([cell.lat, cell.lng], {
                        icon: L.divIcon({
                            html: `<div style="width:16px; height:16px; background:${color}; border:3px solid white; border-radius:50%;"></div>`,
                            iconSize: [22, 22],
                            iconAnchor: [11, 11]
                        })
                    });
                    
                    marker.on('click', function() {
                        showCircleOnMap(cell.lat, cell.lng, cell.density);
                    });
                    
                    markers.addLayer(marker);
                });
                map.addLayer(markers);
                
                progressBar.style.width = '100%';
                percent.textContent = '100%';
                status.textContent = `‚úÖ ${newCells.length} cellules import√©es !`;
                
                updateStats();
                updateCellList();
                
                setTimeout(() => {
                    document.getElementById('import-modal').style.display = 'none';
                    showNotification(`${newCells.length} cellules import√©es`, 'success');
                }, 1500);
            };
            reader.readAsText(file);
        }

        function searchCellId() {
            const term = document.getElementById('cellid-search').value.trim().toLowerCase();
            if (!term) {
                showNotification('Entrez un Cell ID', 'warning');
                return;
            }
            
            const found = cellData.filter(c => c.id.toLowerCase().includes(term));
            
            if (found.length === 1) {
                showCircleOnMap(found[0].lat, found[0].lng, found[0].density);
                showNotification(`Cellule trouv√©e: ${found[0].id}`, 'success');
            } else if (found.length > 1) {
                const bounds = L.latLngBounds(found.map(c => [c.lat, c.lng]));
                map.fitBounds(bounds);
                showNotification(`${found.length} cellules trouv√©es`, 'info');
            } else {
                showNotification('Aucune cellule trouv√©e', 'error');
            }
        }

        function quickSearch() {
            const term = document.getElementById('quick-search').value.toLowerCase().trim();
            if (!term) return;
            
            const found = cellData.filter(c => 
                c.id.toLowerCase().includes(term) || 
                c.location.toLowerCase().includes(term) ||
                c.city.toLowerCase().includes(term)
            );
            
            if (found.length === 1) {
                showCircleOnMap(found[0].lat, found[0].lng, found[0].density);
                showNotification(`Cellule trouv√©e: ${found[0].location}`, 'success');
            } else if (found.length > 1) {
                const bounds = L.latLngBounds(found.map(c => [c.lat, c.lng]));
                map.fitBounds(bounds);
                showNotification(`${found.length} cellules trouv√©es`, 'info');
            } else {
                showNotification('Aucune cellule trouv√©e', 'error');
            }
        }

        function resetFilters() {
            document.getElementById('cellid-search').value = '';
            document.getElementById('location-search').value = '';
            document.getElementById('quick-search').value = '';
            
            const bounds = L.latLngBounds(cellData.map(c => [c.lat, c.lng]));
            map.fitBounds(bounds);
            
            showNotification('Filtres r√©initialis√©s', 'info');
        }

        function exportData() {
            if (cellData.length === 0) {
                showNotification('Aucune donn√©e √† exporter', 'warning');
                return;
            }
            
            const csvContent = [
                ['CELL_ID', 'LOCALISATION', 'LATITUDE', 'LONGITUDE', 'R√âGION', 'VILLE', 'DENSIT√â'],
                ...cellData.map(c => [c.id, c.location, c.lat, c.lng, c.region, c.city, c.density])
            ].map(row => row.join(',')).join('\n');
            
            const blob = new Blob([csvContent], { type: 'text/csv' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `yas_cellules_${new Date().toISOString().split('T')[0]}.csv`;
            a.click();
            
            showNotification(`${cellData.length} cellules export√©es`, 'success');
        }

        function geolocate() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    (pos) => {
                        map.setView([pos.coords.latitude, pos.coords.longitude], 15);
                        
                        L.marker([pos.coords.latitude, pos.coords.longitude], {
                            icon: L.divIcon({
                                html: `<div style="width:20px; height:20px; background:#ff9800; border:3px solid white; border-radius:50%; animation:pulse 1s infinite;"></div>`,
                                iconSize: [26, 26]
                            })
                        }).addTo(map).bindPopup('Votre position').openPopup();
                        
                        showNotification('Position g√©olocalis√©e', 'success');
                    },
                    (error) => {
                        showNotification('Erreur de g√©olocalisation', 'error');
                    }
                );
            } else {
                showNotification('G√©olocalisation non support√©e', 'error');
            }
        }

        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.innerHTML = `
                <i class="fas ${type === 'success' ? 'fa-check-circle' : type === 'error' ? 'fa-exclamation-circle' : 'fa-info-circle'}"></i>
                <span>${message}</span>
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            }, 3000);
        }

        function initEvents() {
            document.querySelectorAll('.view-btn').forEach(btn => {
                btn.addEventListener('click', () => changeView(btn.dataset.view));
            });
            
            document.getElementById('view-satellite').addEventListener('click', () => changeView('satellite'));
            document.getElementById('view-map').addEventListener('click', () => changeView('map'));
            document.getElementById('view-terrain').addEventListener('click', () => changeView('terrain'));
            
            document.getElementById('toggle-sidebar').addEventListener('click', function() {
                const sidebar = document.getElementById('sidebar');
                const icon = document.getElementById('sidebar-icon');
                sidebar.classList.toggle('collapsed');
                icon.className = sidebar.classList.contains('collapsed') ? 'fas fa-chevron-right' : 'fas fa-chevron-left';
            });
            
            document.getElementById('feature-rural').addEventListener('click', showRural);
            document.getElementById('feature-heatmap').addEventListener('click', toggleHeatmap);
            document.getElementById('feature-history').addEventListener('click', focusHistory);
            document.getElementById('feature-simulate').addEventListener('click', simulateCall);
            document.getElementById('feature-coverage').addEventListener('click', showCoverage);
            document.getElementById('feature-replay').addEventListener('click', replayTrajet);
            
            document.getElementById('start-tracking').addEventListener('click', startTracking);
            document.getElementById('stop-tracking').addEventListener('click', stopTracking);
            document.getElementById('clear-tracking').addEventListener('click', clearTracking);
            
            document.getElementById('search-history-btn').addEventListener('click', searchHistory);
            document.getElementById('replay-trajet-btn').addEventListener('click', replayTrajet);
            document.getElementById('clear-history-btn').addEventListener('click', clearHistory);
            document.getElementById('export-history-btn').addEventListener('click', exportHistory);
            
            document.getElementById('quick-search-btn').addEventListener('click', quickSearch);
            document.getElementById('quick-search').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') quickSearch();
            });
            
            document.getElementById('search-btn').addEventListener('click', searchCellId);
            document.getElementById('cellid-search').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') searchCellId();
            });
            
            document.getElementById('geolocate-btn').addEventListener('click', geolocate);
            
            document.getElementById('reset-filters-btn').addEventListener('click', resetFilters);
            document.getElementById('export-btn').addEventListener('click', exportData);
            document.getElementById('diagnostic-btn').addEventListener('click', diagnosticCoordonnees);
            
            document.getElementById('clear-search-btn').addEventListener('click', () => {
                document.getElementById('location-search').value = '';
            });
            
            initImportModal();
            initLogsModal();
        }

        document.getElementById('auth-button').addEventListener('click', function() {
            const password = document.getElementById('auth-password').value;
            SecuritySystem.checkPassword(password);
        });

        document.getElementById('auth-password').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                document.getElementById('auth-button').click();
            }
        });

        window.showCircleOnMap = showCircleOnMap;

        const style = document.createElement('style');
        style.textContent = `
            .notification {
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 15px 20px;
                border-radius: 8px;
                color: white;
                z-index: 10001;
                animation: slideIn 0.3s ease;
                max-width: 300px;
                display: flex;
                align-items: center;
                gap: 10px;
                box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            }
            .notification.success { background: linear-gradient(135deg, #28a745, #20c997); }
            .notification.error { background: linear-gradient(135deg, #dc3545, #e83e8c); }
            .notification.warning { background: linear-gradient(135deg, #ff9800, #ff5722); }
            .notification.info { background: linear-gradient(135deg, #0066cc, #0099ff); }
            @keyframes slideIn {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            @keyframes slideOut {
                from { transform: translateX(100%); opacity: 1; }
                to { transform: translateX(0); opacity: 0; }
            }
            .cell-marker {
                transition: transform 0.2s;
            }
            .cell-marker:hover {
                transform: scale(1.5);
                z-index: 1000;
            }
            .coverage-circle {
                animation: pulse 2s infinite;
            }
            @keyframes pulse {
                0% { opacity: 0.6; }
                50% { opacity: 0.3; }
                100% { opacity: 0.6; }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>
